"use strict";(self["webpackChunkheligonkova_akademia"]=self["webpackChunkheligonkova_akademia"]||[]).push([[7323],{7323:function(e,a,t){t.r(a),t.d(a,{default:function(){return U}});var s=t(3396),i=t(9242),o=t(7139),r=t(4970);const l=["id"],n={class:"column"},d={class:"row-form stav"},u={for:"stav"},p={class:"row-form m-t"},v={key:0,class:"roles-label",for:"roles"},c={key:2,class:"roles-label",for:"roles"},m={key:0,class:"row-form m-t"},h={key:1,class:"row-form"},_=["for"],z=["value","onUpdate:modelValue","id"],y={class:"column"},b={class:"row-form"},k={class:"row-form"},g={class:"row-form"},f={class:"row-form"},D={class:"row-form"},w={class:"row-form"},$={class:"row-form"},P={class:"column"},S={class:"row-form"},x=["value"],B={class:"row-form"},j=["value"];function q(e,a,t,q,N,A){return(0,s.wg)(),(0,s.iD)("section",{id:e.$route.name},[(0,s._)("form",{class:"scroll",onSubmit:a[15]||(a[15]=(0,i.iM)(((...e)=>A.upraveniePouzivatela&&A.upraveniePouzivatela(...e)),["prevent"]))},[(0,s._)("div",n,[(0,s._)("div",d,[(0,s._)("label",u,[(0,s.Uk)("PouÅ¾Ã­vateÄ¾ "+(0,o.zw)(N.pouzivatelData.name)+" ",1),(0,s._)("strong",null,(0,o.zw)(0==N.pouzivatelData.is_admin?"je BEÅ½NÃ pouÅ¾Ã­vateÄ¾":"je administrÃ¡tor"),1)])]),(0,s._)("div",{class:(0,o.C_)(["delete-user zrusit click",{"not-have-permission":!this.$store.state.userRoles?.roles?.includes("user_master")}]),onClick:a[0]||(a[0]=e=>A.vymazPouzivatela())},a[16]||(a[16]=[(0,s._)("p",null,"VymaÅ¾ pouÅ¾Ã­vateÄ¾a",-1),(0,s._)("img",{src:r,alt:"VymazaÅ¥ pouzivatela"},null,-1)]),2),(0,s._)("div",p,[0==N.pouzivatelData.is_admin?((0,s.wg)(),(0,s.iD)("label",v,"VytvoriÅ¥ administrÃ¡tora")):(0,s.kq)("",!0),0==N.pouzivatelData.is_admin?((0,s.wg)(),(0,s.iD)("a",{key:1,onClick:a[1]||(a[1]=e=>A.spravaAdministrator("vytvorenie")),class:"button gift-button"},a[17]||(a[17]=[(0,s._)("p",null,"Vytvor",-1)]))):(0,s.kq)("",!0),1==N.pouzivatelData.is_admin?((0,s.wg)(),(0,s.iD)("label",c,"ZruÅ¡iÅ¥ administrÃ¡tora")):(0,s.kq)("",!0),1==N.pouzivatelData.is_admin?((0,s.wg)(),(0,s.iD)("a",{key:3,onClick:a[2]||(a[2]=e=>A.spravaAdministrator("zmazanie")),class:"button gift-button"},a[18]||(a[18]=[(0,s._)("p",null,"OdstrÃ¡Åˆ",-1)]))):(0,s.kq)("",!0)]),N.pouzivatelData.is_admin?((0,s.wg)(),(0,s.iD)("div",m,a[19]||(a[19]=[(0,s._)("label",{class:"roles-label",for:"roles"},"Vybratie rÃ³l pre admina:",-1)]))):(0,s.kq)("",!0),N.pouzivatelData.is_admin?((0,s.wg)(),(0,s.iD)("div",h,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(N.availableRoles,((e,a)=>((0,s.wg)(),(0,s.iD)("div",{class:"row-roles",key:e},[(0,s._)("label",{for:e},(0,o.zw)(N.roleNames[e]),9,_),(0,s.wy)((0,s._)("input",{type:"checkbox",value:e,"onUpdate:modelValue":e=>N.roleStates[a]=e,id:e},null,8,z),[[i.e8,N.roleStates[a]]])])))),128))])):(0,s.kq)("",!0),(0,s._)("a",{onClick:a[3]||(a[3]=e=>A.saveRoles()),class:"button gift-button roles-button"},a[20]||(a[20]=[(0,s._)("p",null,"Aktualizuj roly",-1)]))]),a[35]||(a[35]=(0,s._)("div",{class:"line"},null,-1)),(0,s._)("div",y,[(0,s._)("div",b,[a[21]||(a[21]=(0,s._)("label",{for:"meno"},"Meno:",-1)),(0,s.wy)((0,s._)("input",{ref:"meno",type:"text",name:"meno",placeholder:"Meno heligonkÃ¡ra","onUpdate:modelValue":a[4]||(a[4]=e=>N.pouzivatelData.name=e)},null,512),[[i.nr,N.pouzivatelData.name]])]),(0,s._)("div",k,[a[22]||(a[22]=(0,s._)("label",{for:"priezvisko"},"Priezvizko:",-1)),(0,s.wy)((0,s._)("input",{ref:"priezvisko",type:"text",name:"priezvisko",placeholder:"Priezvisko heligonkÃ¡ra","onUpdate:modelValue":a[5]||(a[5]=e=>N.pouzivatelData.surname=e)},null,512),[[i.nr,N.pouzivatelData.surname]])]),(0,s._)("div",g,[a[23]||(a[23]=(0,s._)("label",{for:"datum"},"DÃ¡tum narodenia:",-1)),(0,s.wy)((0,s._)("input",{ref:"datum",type:"date",name:"datum",placeholder:"dÃ¡tum narodenia","onUpdate:modelValue":a[6]||(a[6]=e=>N.pouzivatelData.dateOfBirth=e)},null,512),[[i.nr,N.pouzivatelData.dateOfBirth]])]),(0,s._)("div",f,[a[24]||(a[24]=(0,s._)("label",{for:"mesto"},"Mesto:",-1)),(0,s.wy)((0,s._)("input",{ref:"mesto",type:"text",name:"mesto",placeholder:"Mesto/dedina","onUpdate:modelValue":a[7]||(a[7]=e=>N.pouzivatelData.billingAddressCity=e)},null,512),[[i.nr,N.pouzivatelData.billingAddressCity]])]),(0,s._)("div",D,[a[25]||(a[25]=(0,s._)("label",{for:"ulica"},"Ulica:",-1)),(0,s.wy)((0,s._)("input",{ref:"ulica",type:"text",name:"ulica",placeholder:"Ulica  ","onUpdate:modelValue":a[8]||(a[8]=e=>N.pouzivatelData.billingAddressStreet=e)},null,512),[[i.nr,N.pouzivatelData.billingAddressStreet]])]),(0,s._)("div",w,[a[26]||(a[26]=(0,s._)("label",{for:"cislo"},"CÃ­slo domu:",-1)),(0,s.wy)((0,s._)("input",{ref:"cislo",type:"text",name:"cislo",placeholder:"ÄÃ­slo domu","onUpdate:modelValue":a[9]||(a[9]=e=>N.pouzivatelData.billingAddressHouseNumber=e)},null,512),[[i.nr,N.pouzivatelData.billingAddressHouseNumber]])]),(0,s._)("div",$,[a[27]||(a[27]=(0,s._)("label",{for:"mesto"},"PSÄŒ:",-1)),(0,s.wy)((0,s._)("input",{ref:"mesto",type:"text",name:"mesto",placeholder:"poÅ¡tovÃ© smerovacie ÄÃ­slo","onUpdate:modelValue":a[10]||(a[10]=e=>N.pouzivatelData.billingAddressPostcode=e)},null,512),[[i.nr,N.pouzivatelData.billingAddressPostcode]])]),(0,s._)("button",{class:(0,o.C_)([{"not-have-permission":!this.$store.state.userRoles?.roles?.includes("user_master")},"button"]),type:"submit"},a[28]||(a[28]=[(0,s._)("p",null,"Upravenie pouÅ¾Ã­vateÄ¾a",-1)]),2),(0,s._)("div",{onClick:a[11]||(a[11]=a=>e.$router.go(-1)),class:"zrusit click"},a[29]||(a[29]=[(0,s._)("p",null,[(0,s._)("strong",null,"â†"),(0,s.Uk)(" VrÃ¡tiÅ¥ sa spaÅ¥")],-1)]))]),a[36]||(a[36]=(0,s._)("div",{class:"line"},null,-1)),(0,s._)("div",P,[a[33]||(a[33]=(0,s._)("div",{class:"row-form m-t"},[(0,s._)("label",{for:"nevlastnene-zapisy"},"Pridaj ÄÃ­selnÃ½ zÃ¡pis")],-1)),(0,s._)("div",S,[(0,s.wy)((0,s._)("select",{"onUpdate:modelValue":a[12]||(a[12]=e=>N.vybraniZapisDarovanieId=e),name:"nevlastnene-zapisy",id:"nevlastnene-zapisy"},[a[30]||(a[30]=(0,s._)("option",{value:"",disabled:"",selected:""},"DarovateÄ¾nÃ© zÃ¡pisy",-1)),((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(N.pouzivatelNevlastenene,(e=>((0,s.wg)(),(0,s.iD)("option",{key:e.id,value:e.id},(0,o.zw)(e.name)+" Â  ("+(0,o.zw)(e.id)+") ",9,x)))),128))],512),[[i.bM,N.vybraniZapisDarovanieId]])]),a[34]||(a[34]=(0,s._)("div",{class:"row-form m-t"},[(0,s._)("label",{for:"darovanie-predplatne"},"Daruj predplatnÃ© na:")],-1)),(0,s._)("div",B,[(0,s.wy)((0,s._)("select",{"onUpdate:modelValue":a[13]||(a[13]=e=>N.vypranePredplatneDarovanie=e),name:"darovanie-predplatne",id:"darovanie-predplatne"},[a[31]||(a[31]=(0,s._)("option",{value:"",disabled:"",selected:""},"Doby predplatnÃ½ch",-1)),((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(N.predplatne,(e=>((0,s.wg)(),(0,s.iD)("option",{key:e,value:e},(0,o.zw)(A.dobaPredplatneho(e)),9,j)))),128))],512),[[i.bM,N.vypranePredplatneDarovanie]])]),(0,s._)("a",{onClick:a[14]||(a[14]=e=>A.darovat()),class:"button gift-button"},a[32]||(a[32]=[(0,s._)("p",null,"Daruj ðŸ˜Š",-1)]))])],32)],8,l)}var N={mounted(){window.scrollTo(0,0),"undefined"!==typeof this.$route.query.id?(this.nacitajPouzivatelskeUdaje(),this.nacitajNevlastneneZapisy()):(this.$store.state.SnackBarText="Nepodarilo sa nÃ¡jsÅ¥ pouÅ¾Ã­vateÄºa",this.$router.go(-1))},data(){return{pouzivatelData:{},pouzivatelNevlastenene:[],vybraniZapisDarovanieId:0,predplatne:["mesiac","pol rok","rok"],vypranePredplatneDarovanie:"",availableRoles:["subscription_edit","video_create","video_edit","video_delete","numericRecord_create","numericRecord_edit","numericRecord_delete","merch_create","merch_edit","merch_delete","record_create","record_edit","record_delete","mail_master","coupon_master","invoice_master","product_pass","user_master","admin_master","helishop_manager","edupageRegistrationsManager"],roleNames:{subscription_edit:"Ãšprava predplatnÃ©ho",video_create:"VytvÃ¡ranie videÃ­",video_edit:"Ãšprava videÃ­",video_delete:"Mazanie videÃ­",numericRecord_create:"Tvorba ÄÃ­selnÃ½ch zÃ¡pisov",numericRecord_edit:"Ãšprava ÄÃ­selnÃ½ch zÃ¡pisov",numericRecord_delete:"Mazanie ÄÃ­selnÃ½ch zÃ¡pisov",merch_create:"Tvorba tovaru",merch_edit:"Ãšprava tovaru",merch_delete:"Mazanie tovaru",record_create:"Tvorba zÃ¡pisov editor",record_edit:"Ãšprava zÃ¡pisov editor",record_delete:"Mazanie zÃ¡pisov editor",mail_master:"Odosielanie e-mailov",coupon_master:"SprÃ¡va kupÃ³nov",invoice_master:"Zobrazenie faktÃºr",product_pass:"PrÃ­stup k vÅ¡etkym produktom",user_master:"SprÃ¡va pouÅ¾Ã­vateÄ¾ov",admin_master:"SprÃ¡va administrÃ¡torov",helishop_manager:"SprÃ¡vca helishopu",edupageRegistrationsManager:"SprÃ¡va prihlÃ¡Å¡ok"},roleStates:[]}},methods:{async spravaAdministrator(e){var a;a="vytvorenie"==e;const s=t(7218);let i={method:"get",maxBodyLength:1/0,url:this.$store.state.api+`/user/info/setAdminStatus.php?email=${this.pouzivatelData.email}&is_admin=${a}`,headers:{}};try{const e=await s.request(i);"Request succesfull"==e.data.status?(this.$store.state.SnackBarText=1==a?this.pouzivatelData.name+" "+this.pouzivatelData.surname+" sa stal administrÃ¡torom, Äo ale niÄ neznamenÃ¡ bez rolÃ½. DovoÄ¾ mu nieÄo robiÅ¥.":this.pouzivatelData.name+" "+this.pouzivatelData.surname+" uÅ¾ nieje naÄalej administrÃ¡torom, eÅ¡te Å¾e si ho odstrÃ¡nil nedopadlo by to dobre.",this.nacitajPouzivatelskeUdaje()):(this.$store.state.SnackBarText=this.pouzivatelData.name+" "+this.pouzivatelData.surname+" sa nestal administrÃ¡torom, skÃºs nabudÃºce.",this.nacitajPouzivatelskeUdaje())}catch(o){this.$store.state.SnackBarText=this.pouzivatelData.name+" "+this.pouzivatelData.surname+" sa nestal administrÃ¡torom, skÃºs nabudÃºce.",this.nacitajPouzivatelskeUdaje()}},async saveRoles(){const e=this.availableRoles.filter(((e,a)=>this.roleStates[a])),a=JSON.stringify(e),s=t(7218),i=t(6237);let o=new i;o.append("email",this.pouzivatelData.email),o.append("roles",a);let r={method:"post",maxBodyLength:1/0,url:this.$store.state.api+"/user/info/setAdminRoles.php",data:o};try{const e=await s.request(r);"Request succesfull"==e.data.status?(this.$store.state.SnackBarText="Roly pre pouÅ¾Ã­vateÄ¾a boli ÃºspeÅ¡ne uloÅ¾enÃ©",this.nacitajPouzivatelskeUdaje()):this.$store.state.SnackBarText="Nepodarilo sa priradiÅ¥ roly k tomuto pouÅ¾Ã­vateÄ¾ovi"}catch(l){this.$store.state.SnackBarText="Nepodarilo sa priradiÅ¥ roly k tomuto pouÅ¾Ã­vateÄ¾ovi"}},dobaPredplatneho(e){return"mesiac"==e?"Mesiac":"pol rok"==e?"Pol rok":"rok"==e?"Rok":""},async darovat(){const e=this.$route.query.id,a=this.vybraniZapisDarovanieId,t=this.vypranePredplatneDarovanie;a&&await this.pridatZapis(e,a),t&&await this.pridatPredplatne(e,t)},async pridatPredplatne(e,a){const s=t(7218);let i={method:"get",maxBodyLength:1/0,url:this.$store.state.api+`/subscription/subcriptionFree.php?user_id=${e}&duration=${a}`,headers:{}};try{const e=await s.request(i);"Request succesfull"==e.data.status?(this.$store.state.SnackBarText="PredplatnÃ© na "+this.dobaPredplatneho(a)+" bolo pridanÃ©.",this.vypranePredplatneDarovanie=""):this.$store.state.SnackBarText="NÃ¡Å¡ heligonkÃ¡r si poradÃ­ aj bez predplatnÃ©ho, skÃºs eÅ¡te raz neskÃ´r. "}catch(o){this.$store.state.SnackBarText="Chyba pri pridÃ¡vanÃ­ predplatnÃ©ho: "}},async pridatZapis(e,a){const s=t(7218);let i={method:"get",maxBodyLength:1/0,url:this.$store.state.api+`/product/addToOwnedFree.php?user_id=${e}&product_id=${a}`,headers:{}};try{const e=await s.request(i);"Request succesfull"==e.data.status?(this.$store.state.SnackBarText="ZÃ¡pis bol ÃºspeÅ¡ne darovanÃ½.",this.nacitajNevlastneneZapisy()):this.$store.state.SnackBarText="NÃ¡Å¡ heligonkÃ¡r neprijal zÃ¡pis, skÃºs eÅ¡te raz neskÃ´r."}catch(o){this.$store.state.SnackBarText="Chyba pri pridÃ¡vanÃ­ zÃ¡pisu: "}},async nacitajNevlastneneZapisy(){this.pouzivatelNevlastenene=[];const e=t(7218),a=t(6237);let s=new a,i={method:"get",maxBodyLength:1/0,url:this.$store.state.api+"/user/stats/getZapisNotOwned.php?user_id="+this.$route.query.id,data:s};try{const a=await e.request(i),t=a.data.data;this.pouzivatelNevlastenene=t.map((e=>({id:parseInt(e),name:""}))),await Promise.all(this.pouzivatelNevlastenene.map((async e=>{e.name=await this.nacitajNazovProduktu(e.id)})))}catch(o){}},async nacitajNazovProduktu(e){const a=t(7218);let s={method:"get",maxBodyLength:1/0,url:this.$store.state.api+"/product/loadLimited.php/?id="+e,headers:{}};try{const e=await a.request(s);return e.data.data.name}catch(i){return""}},nacitajPouzivatelskeUdaje(){const e=t(7218),a=t(6237);let s=new a,i={method:"get",maxBodyLength:1/0,url:this.$store.state.api+"/user/info/getAllInformationAboutUser.php/?id="+this.$route.query.id,data:s};e.request(i).then((e=>{if("Request succesfull"==e.data.status){this.pouzivatelData=e.data.data;const t=e.data.data.roles;var a;a=null!=t?t.replace(/'/g,'"'):t;const s=JSON.parse(a);this.roleStates=this.availableRoles.map((e=>s.includes(e)))}else this.$store.state.SnackBarText="PouÅ¾Ã­vateÄ¾ sa nenaÅ¡iel",this.$router.go(-1)})).catch((e=>{}))},upraveniePouzivatela(){const e=t(7218),a=t(6237);let s=new a;s.append("id",this.$route.query.id),s.append("name",this.pouzivatelData.name),s.append("surname",this.pouzivatelData.surname),s.append("dateOfBirth",this.pouzivatelData.dateOfBirth),s.append("billingAddressStreet",this.pouzivatelData.billingAddressStreet),s.append("billingAddressHouseNumber",this.pouzivatelData.billingAddressHouseNumber),s.append("billingAddressCity",this.pouzivatelData.billingAddressCity),s.append("billingAddressPostcode",this.pouzivatelData.billingAddressPostcode);let i={method:"post",maxBodyLength:1/0,url:this.$store.state.api+"/user/info/updateAllInformationAboutUser.php/",data:s};e.request(i).then((e=>{"Request succesfull"==e.data.status?(this.$store.state.SnackBarText="PouÅ¾Ã­vateÄ¾ bol ÃºspeÅ¡ne upravenÃ½",this.$router.go(-1)):this.$store.state.SnackBarText="PouÅ¾Ã­vateÄ¾ sa neupravil"})).catch((e=>{}))},vymazPouzivatela(){if(confirm("Naozaj chcete vymazaÅ¥ pouÅ¾Ã­vateÄ¾a, po vymazanÃ­ sa navÅ¾dy stratÃ­")){const e=t(7218);let a={method:"get",maxBodyLength:1/0,url:this.$store.state.api+"/user/delete.php/?email="+this.pouzivatelData.email,headers:{}};e.request(a).then((e=>{"Request fullfiled"==e.data.status?(this.$store.state.SnackBarText="PouÅ¾Ã­vateÄ¾ bol ÃºspeÅ¡ne vymazanÃ½",this.$router.go(-1)):this.$store.state.SnackBarText="Nepodarilo sa vymazaÅ¥ pouÅ¾Ã­vateÄ¾a"})).catch((e=>{}))}}}},A=t(89);const R=(0,A.Z)(N,[["render",q],["__scopeId","data-v-b83d18b0"]]);var U=R},4970:function(e,a,t){e.exports=t.p+"img/zrusit.31ce29f1.svg"}}]);