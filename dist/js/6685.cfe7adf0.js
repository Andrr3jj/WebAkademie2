"use strict";(self["webpackChunkheligonkova_akademia"]=self["webpackChunkheligonkova_akademia"]||[]).push([[6685],{6685:function(t,e,a){a.r(e),a.d(e,{default:function(){return M}});var n=a(3396),i=a(9242),s=a(7139);const o=["id"],l={class:"scroll"},h={class:"nadpis"},d=["onClick"],c={class:"smaller-h5"},r={key:0},u={key:0},k={key:0},y={class:"highlight"},p={key:1},m=["onClick"],g=["onClick"];function w(t,e,a,w,_,v){return(0,n.wg)(),(0,n.iD)("section",{id:t.$route.name},[(0,n._)("div",l,[e[10]||(e[10]=(0,n._)("h1",null,"Administratívny systém",-1)),(0,n._)("div",h,[(0,n._)("h5",null,[e[4]||(e[4]=(0,n.Uk)(" Zoznam Faktúr - Rok ")),(0,n.wy)((0,n._)("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=t=>_.year=t),onKeyup:e[1]||(e[1]=(...t)=>v.handleKeyPress&&v.handleKeyPress(...t)),onClick:e[2]||(e[2]=(...t)=>v.handleClick&&v.handleClick(...t)),onInput:e[3]||(e[3]=t=>v.nacitajVsetkyMesiace())},null,544),[[i.nr,_.year]])])]),e[11]||(e[11]=(0,n._)("div",{class:"line horizontal w-80"},null,-1)),((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(_.data,((t,a)=>((0,n.wg)(),(0,n.iD)("div",{key:a,class:"month-section"},[(0,n._)("div",{class:"month-header",onClick:t=>v.toggleMonth(a)},[(0,n._)("h3",null,(0,s.zw)(v.getMonthName(a)),1),(0,n._)("h5",c,[e[5]||(e[5]=(0,n.Uk)(" Počet faktúr: ")),(0,n._)("strong",null,(0,s.zw)(t.length),1)])],8,d),_.expandedMonths.includes(a)?((0,n.wg)(),(0,n.iD)("table",r,[e[8]||(e[8]=(0,n._)("thead",null,[(0,n._)("tr",null,[(0,n._)("th",{style:{width:"70%"}}),(0,n._)("th",{style:{width:"30%"}})])],-1)),(0,n._)("tbody",null,[0===t.length?((0,n.wg)(),(0,n.iD)("tr",u,e[6]||(e[6]=[(0,n._)("td",{style:{"justify-content":"center"}},[(0,n._)("p",null,"Žiadne faktúry za tento mesiac")],-1),(0,n._)("td",null,null,-1)]))):(0,n.kq)("",!0),((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(t,((a,i)=>((0,n.wg)(),(0,n.iD)("tr",{key:i},[t.length>0?((0,n.wg)(),(0,n.iD)("td",k,[(0,n._)("p",y,[(0,n._)("strong",null,(0,s.zw)(i+1)+".",1),(0,n.Uk)(" "+(0,s.zw)(a.replace("https://heligonkovaakademia.sk/data/uploads/invoices/","")),1)])])):(0,n.kq)("",!0),t.length>0?((0,n.wg)(),(0,n.iD)("td",p,[(0,n._)("div",{onClick:t=>v.otvorFakturu(a),class:"button"},e[7]||(e[7]=[(0,n._)("a",null,"Zobraziť",-1)]),8,m)])):(0,n.kq)("",!0)])))),128))])])):(0,n.kq)("",!0),_.expandedMonths.includes(a)&&t.length>0?((0,n.wg)(),(0,n.iD)("div",{key:1,onClick:t=>v.stiahniVsetky(a),class:"button download-month"},e[9]||(e[9]=[(0,n._)("a",null,"Stiahnuť",-1)]),8,g)):(0,n.kq)("",!0)])))),128))])],8,o)}a(560);var _={mounted(){window.scrollTo(0,0),this.actualYear=(new Date).getFullYear(),this.year=this.actualYear,this.$store.state.userRoles?.roles?.includes("invoice_master")?this.nacitajVsetkyMesiace():this.$router.go(-1)},data(){return{data:{},year:2024,mont:1,actualYear:null,expandedMonths:[1],clickCount:0}},methods:{getMonthName(t){const e=["Január","Február","Marec","Apríl","Máj","Jún","Júl","August","September","Október","November","December"];return e[t-1]},toggleMonth(t){this.expandedMonths.includes(t)?this.expandedMonths=this.expandedMonths.filter((e=>e!==t)):this.expandedMonths.push(t)},handleKeyPress(t){"ArrowUp"===t.key||"ArrowRight"===t.key?this.year++:"ArrowDown"!==t.key&&"ArrowLeft"!==t.key||this.year--,this.nacitajVsetkyMesiace()},handleClick(){this.clickCount++,setTimeout((()=>{2===this.clickCount?(this.year--,this.nacitajVsetkyMesiace()):3===this.clickCount&&(this.year++,this.nacitajVsetkyMesiace()),this.clickCount=0}),250)},async nacitajVsetkyMesiace(){this.data={};for(let t=1;t<=12;t++)this.month=t,await this.nacitajUcty()},async nacitajUcty(){const t=a(7218);let e={method:"get",maxBodyLength:1/0,url:`${this.$store.state.api}/invoice/download.php?year=${this.year}&month=${this.month}`};try{const a=await t.request(e);"Request sucesfull"===a.data.status&&(this.data[this.month]||(this.data[this.month]=[]),this.data[this.month]=[...this.data[this.month],...a.data.data])}catch(n){}},oneskoreneVyhladavanie(){clearTimeout(this.timer),this.timer=setTimeout((()=>{this.nacitajUcty()}),500)},otvorFakturu(t){const e=t.replace("https://heligonkovaakademia.sk/data/uploads/invoices/",this.$store.state.api+"/invoice/load_pdf.php?id=");window.open(e,"_blank")},stiahniVsetky(t){let e=0;const a=this.data[t]||[],n=()=>{if(e<a.length){const t=a[e],i=t.split("/").pop()+".pdf",s=t.replace("https://heligonkovaakademia.sk/data/uploads/invoices/",this.$store.state.api+"/invoice/load_pdf.php?id="),o=document.createElement("a");o.href=s,o.download=i,document.body.appendChild(o),o.click(),document.body.removeChild(o),e++,setTimeout(n,1e3)}};n()}}},v=a(89);const C=(0,v.Z)(_,[["render",w],["__scopeId","data-v-1cb0e5b6"]]);var M=C}}]);