"use strict";(self["webpackChunkheligonkova_akademia"]=self["webpackChunkheligonkova_akademia"]||[]).push([[344],{344:function(e,a,t){t.r(a),t.d(a,{default:function(){return p}});var s=t(3396),i=t(7139);const o=["id"],n={class:"scroll"},l={class:"odosielanie-progress-box"},r={key:0},d=["value","max"],c={key:2,class:"success"};function h(e,a,t,h,u,k){return(0,s.wg)(),(0,s.iD)("section",{id:e.$route.name},[(0,s._)("div",n,[a[0]||(a[0]=(0,s._)("h1",null,"Administratívny systém",-1)),a[1]||(a[1]=(0,s._)("h5",null,"Odosielanie e-mailov",-1)),(0,s._)("div",l,[u.odosielaniePrebieha?((0,s.wg)(),(0,s.iD)("p",r," Odosielajú sa e-maily: "+(0,i.zw)(u.odoslaneCount)+" / "+(0,i.zw)(u.celkovyPocet),1)):(0,s.kq)("",!0),u.odosielaniePrebieha?((0,s.wg)(),(0,s.iD)("progress",{key:1,value:u.odoslaneCount,max:u.celkovyPocet},null,8,d)):(0,s.kq)("",!0),!u.odosielaniePrebieha&&u.celkovyPocet>0?((0,s.wg)(),(0,s.iD)("p",c," ✅ E-maily boli úspešne odoslané! ")):(0,s.kq)("",!0)])])],8,o)}t(560);var u={name:"OdosielanieMailovView",data(){return{odosielaniePrebieha:!0,odoslaneCount:0,celkovyPocet:0}},mounted(){const e=localStorage.getItem("mail_subject"),a=localStorage.getItem("mail_image");if(!e||!a)return this.$store.state.SnackBarText="Chýbajú dáta na odoslanie.",void this.$router.push("/admin");this.spustiOdosielanie(e,a)},methods:{async spustiOdosielanie(e,a){const s=t(7218),i=t(6237),o=new i;o.append("subject",e),o.append("image",a);try{const e=await s.post(this.$store.state.api+"/mail/adsSendEmail.php",o);if("Request succesfull"===e.data.status&&Array.isArray(e.data.data)){const a=e.data.data;if(this.celkovyPocet=a.length,0===a.length)return this.$store.state.SnackBarText="Neboli nájdené žiadne emaily.",void(this.odosielaniePrebieha=!1);for(let e=0;e<a.length;e++)await new Promise((e=>setTimeout(e,300))),this.odoslaneCount=e+1;this.odosielaniePrebieha=!1,this.$store.state.SnackBarText=`Úspešne odoslané: ${this.odoslaneCount}/${this.celkovyPocet}`}else this.$store.state.SnackBarText="Chyba pri získaní emailov.",this.odosielaniePrebieha=!1}catch(n){this.odosielaniePrebieha=!1,this.$store.state.SnackBarText="Spojenie zlyhalo."}}}},k=t(89);const m=(0,k.Z)(u,[["render",h],["__scopeId","data-v-3d523ed1"]]);var p=m}}]);