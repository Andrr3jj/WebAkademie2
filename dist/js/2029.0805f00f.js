"use strict";(self["webpackChunkheligonkova_akademia"]=self["webpackChunkheligonkova_akademia"]||[]).push([[2029],{2029:function(t,e,a){a.r(e),a.d(e,{default:function(){return x}});var s=a(3396),n=a(7139),i=a(9242),l=a(3139);const d=["id"],u={class:"scroll"},r={class:"nadpis"},h={class:"button number"},o={key:0},m=["onClick"],c={key:1},p={key:4},y=["onClick"],v={key:1},g=["onClick"],w={class:"search"};function k(t,e,a,k,_,z){return(0,s.wg)(),(0,s.iD)("section",{id:t.$route.name},[(0,s._)("div",u,[e[9]||(e[9]=(0,s._)("h1",null,"Administratívny systém",-1)),(0,s._)("div",r,[e[2]||(e[2]=(0,s._)("h5",null,"Zoznam uživateľov",-1)),(0,s._)("div",h,[(0,s._)("p",null,(0,n.zw)(0===Object.keys(_.data).length?"999+":_.data.user_count),1)])]),e[10]||(e[10]=(0,s._)("div",{class:"line horizontal w-80"},null,-1)),(0,s._)("table",null,[e[7]||(e[7]=(0,s._)("thead",null,[(0,s._)("tr",null,[(0,s._)("th",{style:{width:"30%"}},"Účet:"),(0,s._)("th",{style:{width:"30%"}},"Email:"),(0,s._)("th",{style:{width:"20%"}},"Registrácia:"),(0,s._)("th",{style:{width:"20%"}})])],-1)),0===Object.keys(_.dataVyhladavanie).length?((0,s.wg)(),(0,s.iD)("tbody",o,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(z.usersWithSummaries,((t,a)=>((0,s.wg)(),(0,s.iD)("tr",{key:a,class:(0,n.C_)({"mesiac-spocitanie":t.isSummary})},[t.isSummary?((0,s.wg)(),(0,s.iD)("td",{key:0,colspan:"4",onClick:e=>z.toggleMonth(t.month)},[e[3]||(e[3]=(0,s.Uk)(" 📅 ")),(0,s._)("strong",null,"("+(0,n.zw)(z.getMonthName(t.month))+") "+(0,n.zw)(t.month),1),e[4]||(e[4]=(0,s.Uk)(" – ")),(0,s._)("span",null,"Počet účtov: "+(0,n.zw)(t.count),1)],8,m)):(0,s.kq)("",!0),t.isSummary?(0,s.kq)("",!0):(0,s.wy)(((0,s.wg)(),(0,s.iD)("td",c,[(0,s._)("strong",null,(0,n.zw)(z.getUserIndex(a))+". ",1),(0,s.Uk)(" "+(0,n.zw)(t.name)+" "+(0,n.zw)(t.surname),1)],512)),[[i.F8,_.expandedMonths[t.month]]]),t.isSummary?(0,s.kq)("",!0):(0,s.wy)(((0,s.wg)(),(0,s.iD)("td",{key:2},(0,n.zw)(t.email),513)),[[i.F8,_.expandedMonths[t.month]]]),t.isSummary?(0,s.kq)("",!0):(0,s.wy)(((0,s.wg)(),(0,s.iD)("td",{key:3},(0,n.zw)(t.timestamp.split(" ")[0].replace(/-/g,".")),513)),[[i.F8,_.expandedMonths[t.month]]]),t.isSummary?(0,s.kq)("",!0):(0,s.wy)(((0,s.wg)(),(0,s.iD)("td",p,[(0,s._)("div",{onClick:e=>z.upraveniePouzivatela(t.id),class:"button"},e[5]||(e[5]=[(0,s._)("a",null,"Upraviť",-1)]),8,y)],512)),[[i.F8,_.expandedMonths[t.month]]])],2)))),128))])):((0,s.wg)(),(0,s.iD)("tbody",v,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(_.dataVyhladavanie,((t,a)=>((0,s.wg)(),(0,s.iD)("tr",{key:a},[(0,s._)("td",null,[(0,s._)("strong",null,(0,n.zw)(a+1)+". ",1),(0,s.Uk)(" "+(0,n.zw)((_.dataVyhladavanie[a].name,_.dataVyhladavanie[a].surname)),1)]),(0,s._)("td",null,(0,n.zw)(_.dataVyhladavanie[a].email),1),(0,s._)("td",null,(0,n.zw)(_.dataVyhladavanie[a].timestamp.split(" ")[0].replace(/-/g,".")),1),(0,s._)("td",null,[(0,s._)("div",{onClick:t=>z.upraveniePouzivatela(_.dataVyhladavanie[a].id),class:"button"},e[6]||(e[6]=[(0,s._)("a",null,"Upraviť",-1)]),8,g)])])))),128))]))]),(0,s._)("div",w,[e[8]||(e[8]=(0,s._)("img",{src:l,alt:"Vyhladanie"},null,-1)),(0,s.wy)((0,s._)("input",{onInput:e[0]||(e[0]=t=>z.oneskoreneVyhladavanie()),"onUpdate:modelValue":e[1]||(e[1]=t=>_.search=t),type:"text",placeholder:"Vyhľadať podľa emailu"},null,544),[[i.nr,_.search]])])])],8,d)}a(560);var _={mounted(){window.scrollTo(0,0),this.$store.state.userRoles?.roles?.includes("user_master")?this.nacitajUcty():this.$router.go(-1)},data(){return{data:{},dataVyhladavanie:[],search:"",expandedMonths:{}}},computed:{usersWithSummaries(){if(!this.data.users||0===this.data.users.length)return[];let t=this.data.users.slice().reverse(),e=[],a="",s=0,n=[];return t.forEach((t=>{let[i,l]=t.timestamp.split(" ")[0].split("-"),d=`${l}.${i}`;d!==a&&""!==a&&(e.push({isSummary:!0,month:a,count:s,expanded:!1}),e.push(...n),n=[],s=0),n.push({...t,isSummary:!1,month:d}),s++,a=d})),""!==a&&(e.push({isSummary:!0,month:a,count:s,expanded:!1}),e.push(...n)),e}},methods:{toggleMonth(t){void 0===this.expandedMonths[t]&&(this.expandedMonths[t]=!1),this.expandedMonths[t]=!this.expandedMonths[t]},getUserIndex(t){this.usersWithSummaries.filter((t=>!t.isSummary)).length;return this.usersWithSummaries.slice(t).filter((t=>!t.isSummary)).length},getMonthName(t){const e={"01":"Január","02":"Február","03":"Marec","04":"Apríl","05":"Máj","06":"Jún","07":"Júl","08":"August","09":"September",10:"Október",11:"November",12:"December"};let[a]=t.split(".");return e[a]||"Neznámy mesiac"},nacitajUcty(){const t=a(7218),e=a(6237);let s=new e,n={method:"get",maxBodyLength:1/0,url:this.$store.state.api+"user/stats/getUsers.php",data:s};t.request(n).then((t=>{"Request succesfull"==t.data.status&&(this.data=t.data.data)})).catch((t=>{}))},upraveniePouzivatela(t){this.$router.push({path:"/admin/upravenie-pouzivatela",query:{id:t}})},vyhladavaniePouzivatela(){const t=a(7218);let e={method:"get",maxBodyLength:1/0,url:this.$store.state.api+"/user/search.php?email="+this.search};t.request(e).then((t=>{"Request succesfull"==t.data.status?this.dataVyhladavanie=t.data.data:this.dataVyhladavanie=[]})).catch((t=>{this.dataVyhladavanie=[]}))},oneskoreneVyhladavanie(){clearTimeout(this.timer),this.timer=setTimeout((()=>{this.vyhladavaniePouzivatela()}),500)}}},z=a(89);const b=(0,z.Z)(_,[["render",k],["__scopeId","data-v-2161e394"]]);var x=b},3139:function(t,e,a){t.exports=a.p+"img/hladanie.697b6243.svg"}}]);