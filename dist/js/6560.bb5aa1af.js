"use strict";(self["webpackChunkheligonkova_akademia"]=self["webpackChunkheligonkova_akademia"]||[]).push([[6560],{6560:function(e,t,a){a.r(t),a.d(t,{default:function(){return lt}});var s=a(3396);const i=["id"],n={class:"scroll"},o={key:1},d=["id"],r={class:"scroll"},l={key:1};function u(e,t,a,u,c,h){const p=(0,s.up)("HeadlineSection"),m=(0,s.up)("ObjednavkyPrihlaskyMesiac");return c.isMobile?((0,s.wg)(),(0,s.iD)("div",{key:1,class:"mobile",id:e.$route.name},[(0,s._)("section",null,[(0,s._)("div",r,[(0,s.Wm)(p,{title:"Online prihlášky",teachers:c.teachers,stats:c.stats},null,8,["teachers","stats"]),(0,s.Wm)(m,{orders:c.orders,users:c.users,userMap:c.userMap,onUpdateOrder:e.updateOrder,onDeleted:h.onDeletedOrder},null,8,["orders","users","userMap","onUpdateOrder","onDeleted"]),c.hasMore&&!c.loading?((0,s.wg)(),(0,s.iD)("button",{key:0,class:"button",onClick:t[1]||(t[1]=async()=>{await h.loadNextMonthsChunk(),h.applyData()})}," Načítať ďalšie mesiace ")):c.loading?((0,s.wg)(),(0,s.iD)("div",l,"Načítavam…")):(0,s.kq)("",!0)])])],8,d)):((0,s.wg)(),(0,s.iD)("section",{key:0,class:"computer",id:e.$route.name},[(0,s._)("div",n,[(0,s.Wm)(p,{title:"Online prihlášky",teachers:c.teachers,stats:c.stats},null,8,["teachers","stats"]),(0,s.Wm)(m,{orders:c.orders,users:c.users,userMap:c.userMap,onUpdateOrder:e.updateOrder,onDeleted:h.onDeletedOrder},null,8,["orders","users","userMap","onUpdateOrder","onDeleted"]),c.hasMore&&!c.loading?((0,s.wg)(),(0,s.iD)("button",{key:0,class:"button",onClick:t[0]||(t[0]=async()=>{await h.loadNextMonthsChunk(),h.applyData()})}," Načítať ďalšie mesiace ")):c.loading?((0,s.wg)(),(0,s.iD)("div",o,"Načítavam…")):(0,s.kq)("",!0)])],8,i))}a(8858),a(1318),a(3228),a(560);var c=a(1076),h=a(7139);const p={class:"headline-admin"},m={class:"row"},g={class:"title"},w={key:0,class:"stats-panel"},y={class:"stat"},D={class:"badge"},k={class:"stat"},A={class:"badge"},f={class:"stat"},_={class:"badge"},v={key:0,class:"teachers"},b={class:"name"},S={class:"count"},M={class:"duo-solo"};function I(e,t,a,i,n,o){return(0,s.wg)(),(0,s.iD)("div",p,[(0,s._)("div",m,[(0,s._)("h1",g,(0,h.zw)(a.title),1),a.stats?((0,s.wg)(),(0,s.iD)("aside",w,[t[3]||(t[3]=(0,s._)("h6",null,"Počet žiakov:",-1)),(0,s._)("div",y,[t[0]||(t[0]=(0,s._)("p",null,"Celkový počet:",-1)),(0,s._)("span",D,(0,h.zw)(a.stats.total),1)]),(0,s._)("div",k,[t[1]||(t[1]=(0,s._)("p",null,"Aktívni žiaci:",-1)),(0,s._)("span",A,(0,h.zw)(a.stats.active),1)]),(0,s._)("div",f,[t[2]||(t[2]=(0,s._)("p",null,"Odhlásení žiaci:",-1)),(0,s._)("span",_,(0,h.zw)(a.stats.resigned),1)])])):(0,s.kq)("",!0)]),a.teachers&&a.teachers.length?((0,s.wg)(),(0,s.iD)("div",v,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(a.teachers,(e=>((0,s.wg)(),(0,s.iD)("div",{class:"teacher",key:e.name},[(0,s._)("strong",b,(0,h.zw)(e.name)+":",1),(0,s._)("span",S,(0,h.zw)(e.count),1),(0,s._)("small",M,"(Duo: "+(0,h.zw)(e.duo)+" / Sólo: "+(0,h.zw)(e.solo)+")",1)])))),128))])):(0,s.kq)("",!0),t[4]||(t[4]=(0,s._)("div",{class:"line horizontal w-90"},null,-1))])}var C={name:"HeadlineSection",props:{title:{type:String,required:!0},teachers:{type:Array,default:()=>[]},stats:{type:Object,default:null}}},O=a(89);const U=(0,O.Z)(C,[["render",I],["__scopeId","data-v-62055926"]]);var z=U;const H=["onClick"],P={class:"month-name"},j={class:"kpi"},Q={class:"pill"},Y={class:"kpi"},B={class:"pill"},N={key:1,class:"objednavky"};function x(e,t,a,i,n,o){const d=(0,s.up)("JednaObjednanaPrihlaska");return(0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(o.rozdeleneObjednavky,((i,n)=>((0,s.wg)(),(0,s.iD)("div",{key:n,class:"objednavka-mesiac"},[i.data.length>0?((0,s.wg)(),(0,s.iD)("div",{key:0,class:"month-header",onClick:e=>o.toggleMonth(i)},[(0,s._)("h3",P,(0,h.zw)(o.getMonthName(i.month)),1),(0,s._)("div",j,[t[1]||(t[1]=(0,s._)("span",{class:"label"},"Počet prihlášok:",-1)),(0,s._)("span",Q,(0,h.zw)(i.data.length||0),1)]),(0,s._)("div",Y,[t[2]||(t[2]=(0,s._)("span",{class:"label"},"Vybavené prihlášky:",-1)),(0,s._)("span",B,(0,h.zw)(o.confirmedCount[i.year]?.[i.month]||0),1)])],8,H)):(0,s.kq)("",!0),i.isToggled?((0,s.wg)(),(0,s.iD)("div",N,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(i.data,((i,n)=>((0,s.wg)(),(0,s.j4)(d,{key:n,item:i,users:a.users,userMap:a.userMap,onUpdateOrder:t[0]||(t[0]=t=>e.$emit("updateOrder",t)),onDeleted:o.onDeletedOrder},null,8,["item","users","userMap","onDeleted"])))),128)),t[3]||(t[3]=(0,s._)("div",{class:"line horizontal w-90",style:{height:"0.35rem"}},null,-1))])):(0,s.kq)("",!0)])))),128)}var F=a(9242),V=a(2786),E=a(3073),T=a(5575),J=a(2218);const L={class:"jedna-objednavka"},R={class:"jedna"},W={class:"info"},Z={key:0,class:"badge badge-yellow"},K={class:"info info-email"},q={class:"info"},G={class:"info status-wrap"},X={key:0,class:"status-icon",src:V,alt:"Čaká sa"},$={key:1,class:"status-icon",src:E,alt:"Zaradený"},ee={key:2,class:"status-icon",src:T,alt:"Odhlásený"},te={class:"status-text"},ae={class:"info"},se={key:0,class:"more-info card"},ie={class:"cols"},ne={class:"col"},oe={class:"row"},de={key:0},re={class:"row"},le={key:0},ue={class:"row"},ce={key:0},he={class:"row mt"},pe={key:0},me={class:"col student-data"},ge={class:"two-columns"},we={class:"left-col"},ye={class:"row"},De={key:0},ke={class:"row"},Ae={key:0},fe={class:"row"},_e={key:0},ve={class:"row"},be={key:0},Se={class:"right-col"},Me={class:"row"},Ie={key:0},Ce={class:"row"},Oe={key:0},Ue={class:"row"},ze={key:0},He={class:"row"},Pe={key:0},je={key:1,class:"date-action",style:{"align-items":"end"}},Qe={class:"date-label"},Ye={class:"col slim"},Be={class:"field"},Ne={key:0},xe=["value"],Fe={class:"field autocomplete"},Ve={key:0},Ee={key:0,class:"suggestions"},Te=["onMousedown"],Je={key:0,class:"field autocomplete"},Le={key:0},Re={key:0,class:"suggestions"},We=["onMousedown"],Ze={class:"date-action"},Ke={class:"date-label"},qe={class:"modal-content"},Ge={class:"modal-buttons"};function Xe(e,t,a,i,n,o){return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s._)("div",L,[(0,s._)("div",R,[(0,s._)("p",W,[t[29]||(t[29]=(0,s._)("b",null,"ID:",-1)),t[30]||(t[30]=(0,s.Uk)()),(0,s._)("span",null,(0,h.zw)(o.formattedId),1)]),o.isEditable?((0,s.wg)(),(0,s.iD)("span",{key:1,class:"badge badge-yellow",style:{cursor:"pointer"},onClick:t[0]||(t[0]=(...e)=>o.toggleFormOfStudy&&o.toggleFormOfStudy(...e))},(0,h.zw)(o.typeLabel),1)):((0,s.wg)(),(0,s.iD)("span",Z,(0,h.zw)(o.typeLabel),1)),(0,s._)("p",K,[t[31]||(t[31]=(0,s._)("b",null,"Od:",-1)),t[32]||(t[32]=(0,s.Uk)()),(0,s._)("span",null,(0,h.zw)(n.itemData.email),1)]),(0,s._)("p",q,[t[33]||(t[33]=(0,s._)("b",null,"Dňa:",-1)),t[34]||(t[34]=(0,s.Uk)()),(0,s._)("span",null,(0,h.zw)(o.dateStr),1)]),(0,s._)("p",G,[t[35]||(t[35]=(0,s._)("b",null,"Stav:",-1)),o.isCreated?((0,s.wg)(),(0,s.iD)("img",X)):o.isConfirmed?((0,s.wg)(),(0,s.iD)("img",$)):o.isCancelled?((0,s.wg)(),(0,s.iD)("img",ee)):(0,s.kq)("",!0),(0,s._)("strong",te,(0,h.zw)(o.statusLabel),1)]),(0,s._)("p",ae,[t[36]||(t[36]=(0,s._)("b",null,"Učiteľ:",-1)),t[37]||(t[37]=(0,s.Uk)()),(0,s._)("span",null,(0,h.zw)(o.teacherName),1)]),(0,s._)("div",{onClick:t[1]||(t[1]=(...e)=>o.showInfoToggle&&o.showInfoToggle(...e)),class:"button pill yellow"},[(0,s._)("p",null,(0,h.zw)(n.showInfo?"Skryť":"Zobraziť"),1)]),(0,s._)("span",{onClick:t[2]||(t[2]=(...e)=>o.openDeleteModal&&o.openDeleteModal(...e)),class:"delete-btn",title:"Vymazať objednávku"},t[38]||(t[38]=[(0,s._)("img",{src:J,alt:"Vymazať"},null,-1)]))]),n.showInfo?((0,s.wg)(),(0,s.iD)("div",se,[(0,s._)("div",ie,[(0,s._)("div",ne,[t[44]||(t[44]=(0,s._)("h4",{class:"sect-title"},"Údaje o zákonnom zástupcovi:",-1)),(0,s._)("p",oe,[t[40]||(t[40]=(0,s._)("b",null,"Registroval:",-1)),n.editing?(0,s.wy)(((0,s.wg)(),(0,s.iD)("select",{key:1,"onUpdate:modelValue":t[3]||(t[3]=e=>n.itemData.registerer=e)},t[39]||(t[39]=[(0,s._)("option",{disabled:"",value:""},"— vyber —",-1),(0,s._)("option",{value:"parent"},"Rodič",-1),(0,s._)("option",{value:"self"},"Dospelý",-1)]),512)),[[F.bM,n.itemData.registerer]]):((0,s.wg)(),(0,s.iD)("span",de,(0,h.zw)(o.slovenskyRegisterer[n.itemData.registerer]||"—"),1))]),(0,s._)("p",re,[t[41]||(t[41]=(0,s._)("b",null,"Email:",-1)),n.editing?(0,s.wy)(((0,s.wg)(),(0,s.iD)("input",{key:1,"onUpdate:modelValue":t[4]||(t[4]=e=>n.itemData.email=e)},null,512)),[[F.nr,n.itemData.email]]):((0,s.wg)(),(0,s.iD)("span",le,(0,h.zw)(n.itemData.email||"—"),1))]),(0,s._)("p",ue,[t[42]||(t[42]=(0,s._)("b",null,"Tel. kontakt:",-1)),n.editing?(0,s.wy)(((0,s.wg)(),(0,s.iD)("input",{key:1,"onUpdate:modelValue":t[5]||(t[5]=e=>n.itemData.phone=e)},null,512)),[[F.nr,n.itemData.phone]]):((0,s.wg)(),(0,s.iD)("span",ce,(0,h.zw)(n.itemData.phone||"—"),1))]),(0,s._)("p",he,[t[43]||(t[43]=(0,s._)("b",null,"Poznámka:",-1)),n.editing?(0,s.wy)(((0,s.wg)(),(0,s.iD)("textarea",{key:1,"onUpdate:modelValue":t[6]||(t[6]=e=>n.itemData.note=e)},null,512)),[[F.nr,n.itemData.note]]):((0,s.wg)(),(0,s.iD)("span",pe,(0,h.zw)(n.itemData.note||"—"),1))])]),(0,s._)("div",me,[t[56]||(t[56]=(0,s._)("h4",{class:"sect-title"},"Údaje o žiakovi:",-1)),(0,s._)("div",ge,[(0,s._)("div",we,[(0,s._)("p",ye,[t[45]||(t[45]=(0,s._)("b",null,"Meno:",-1)),n.editing?(0,s.wy)(((0,s.wg)(),(0,s.iD)("input",{key:1,"onUpdate:modelValue":t[7]||(t[7]=e=>n.itemData.name=e)},null,512)),[[F.nr,n.itemData.name]]):((0,s.wg)(),(0,s.iD)("span",De,(0,h.zw)(n.itemData.name),1))]),(0,s._)("p",ke,[t[46]||(t[46]=(0,s._)("b",null,"Priezvisko:",-1)),n.editing?(0,s.wy)(((0,s.wg)(),(0,s.iD)("input",{key:1,"onUpdate:modelValue":t[8]||(t[8]=e=>n.itemData.surname=e)},null,512)),[[F.nr,n.itemData.surname]]):((0,s.wg)(),(0,s.iD)("span",Ae,(0,h.zw)(n.itemData.surname),1))]),(0,s._)("p",fe,[t[47]||(t[47]=(0,s._)("b",null,"Dátum narodenia:",-1)),n.editing?(0,s.wy)(((0,s.wg)(),(0,s.iD)("input",{key:1,"onUpdate:modelValue":t[9]||(t[9]=e=>n.itemData.dateOfBirth=e),placeholder:"dd-mm-yyyy"},null,512)),[[F.nr,n.itemData.dateOfBirth]]):((0,s.wg)(),(0,s.iD)("span",_e,(0,h.zw)(n.itemData.dateOfBirth),1))]),(0,s._)("p",ve,[t[48]||(t[48]=(0,s._)("b",null,"Mesto bydliska:",-1)),n.editing?(0,s.wy)(((0,s.wg)(),(0,s.iD)("input",{key:1,"onUpdate:modelValue":t[10]||(t[10]=e=>n.itemData.address=e)},null,512)),[[F.nr,n.itemData.address]]):((0,s.wg)(),(0,s.iD)("span",be,(0,h.zw)(n.itemData.address),1))])]),(0,s._)("div",Se,[(0,s._)("p",Me,[t[50]||(t[50]=(0,s._)("b",null,"Úroveň skúseností:",-1)),n.editing?(0,s.wy)(((0,s.wg)(),(0,s.iD)("select",{key:1,"onUpdate:modelValue":t[11]||(t[11]=e=>n.itemData.experience=e)},t[49]||(t[49]=[(0,s._)("option",{value:"beginner"},"Začiatočník",-1),(0,s._)("option",{value:"intermediate"},"Stredne pokročilý",-1),(0,s._)("option",{value:"advanced"},"Pokročilý",-1)]),512)),[[F.bM,n.itemData.experience]]):((0,s.wg)(),(0,s.iD)("span",Ie,(0,h.zw)(o.slovenskyExperience[n.itemData.experience]||"—"),1))]),(0,s._)("p",Ce,[t[51]||(t[51]=(0,s._)("b",null,"Miesto narodenia:",-1)),n.editing?(0,s.wy)(((0,s.wg)(),(0,s.iD)("input",{key:1,"onUpdate:modelValue":t[12]||(t[12]=e=>n.itemData.placeOfBirth=e)},null,512)),[[F.nr,n.itemData.placeOfBirth]]):((0,s.wg)(),(0,s.iD)("span",Oe,(0,h.zw)(n.itemData.placeOfBirth),1))]),(0,s._)("p",Ue,[t[52]||(t[52]=(0,s._)("b",null,"Miesto štúdia:",-1)),n.editing?(0,s.wy)(((0,s.wg)(),(0,s.iD)("input",{key:1,"onUpdate:modelValue":t[13]||(t[13]=e=>n.itemData.placeOfStudy=e)},null,512)),[[F.nr,n.itemData.placeOfStudy]]):((0,s.wg)(),(0,s.iD)("span",ze,(0,h.zw)(n.itemData.placeOfStudy),1))]),(0,s._)("p",He,[t[53]||(t[53]=(0,s._)("b",null,"Preferovaný čas:",-1)),n.editing?(0,s.wy)(((0,s.wg)(),(0,s.iD)("input",{key:1,"onUpdate:modelValue":t[14]||(t[14]=e=>n.itemData.approximateTimeOfStudy=e)},null,512)),[[F.nr,n.itemData.approximateTimeOfStudy]]):((0,s.wg)(),(0,s.iD)("span",Pe,(0,h.zw)(n.itemData.approximateTimeOfStudy),1))])])]),o.isCancelled?((0,s.wg)(),(0,s.iD)("div",je,[t[55]||(t[55]=(0,s._)("button",{class:"red-btn",disabled:""},"Odhlásený",-1)),(0,s._)("div",Qe,[t[54]||(t[54]=(0,s._)("b",null,"Dňa:",-1)),(0,s._)("p",null,(0,h.zw)(o.cancelledDate),1)])])):((0,s.wg)(),(0,s.iD)("button",{key:0,onClick:t[15]||(t[15]=(...e)=>o.odhlasitZiaka&&o.odhlasitZiaka(...e)),class:"red-btn"}," Odhlásiť žiaka "))]),(0,s._)("div",Ye,[(0,s._)("div",Be,[t[58]||(t[58]=(0,s._)("label",null,"Učiteľ",-1)),n.editing?(0,s.wy)(((0,s.wg)(),(0,s.iD)("select",{key:1,"onUpdate:modelValue":t[16]||(t[16]=e=>n.ui.teacher=e),class:"styled-select"},[t[57]||(t[57]=(0,s._)("option",{disabled:"",value:""},"Žiadny učiteľ",-1)),((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(n.teachers,(e=>((0,s.wg)(),(0,s.iD)("option",{key:e.id,value:e.id},(0,h.zw)(e.name),9,xe)))),128))],512)),[[F.bM,n.ui.teacher]]):((0,s.wg)(),(0,s.iD)("span",Ne,(0,h.zw)(o.teacherName),1))]),(0,s._)("div",Fe,[t[59]||(t[59]=(0,s._)("label",null,"Účet žiaka",-1)),n.editing?((0,s.wg)(),(0,s.iD)(s.HY,{key:1},[(0,s.wy)((0,s._)("input",{type:"text","onUpdate:modelValue":t[17]||(t[17]=e=>n.ui.studentQuery=e),onFocus:t[18]||(t[18]=e=>n.showAccountSuggestions=!0),onBlur:t[19]||(t[19]=(...e)=>o.hideSuggestionsLater&&o.hideSuggestionsLater(...e)),placeholder:"Žiadny žiak"},null,544),[[F.nr,n.ui.studentQuery]]),n.showAccountSuggestions?((0,s.wg)(),(0,s.iD)("ul",Ee,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(o.filteredAccounts,(e=>((0,s.wg)(),(0,s.iD)("li",{key:e.id,onMousedown:(0,F.iM)((t=>o.selectStudent(e)),["prevent"])},(0,h.zw)(e.email),41,Te)))),128))])):(0,s.kq)("",!0)],64)):((0,s.wg)(),(0,s.iD)("span",Ve,(0,h.zw)(o.accountEmail),1))]),"parent"===n.itemData.registerer?((0,s.wg)(),(0,s.iD)("div",Je,[t[60]||(t[60]=(0,s._)("label",null,"Rodič",-1)),n.editing?((0,s.wg)(),(0,s.iD)(s.HY,{key:1},[(0,s.wy)((0,s._)("input",{type:"text","onUpdate:modelValue":t[20]||(t[20]=e=>n.ui.parentQuery=e),onInput:t[21]||(t[21]=e=>n.showParentSuggestions=!0),onFocus:t[22]||(t[22]=e=>n.showParentSuggestions=!0),onBlur:t[23]||(t[23]=(...e)=>o.hideSuggestionsLater&&o.hideSuggestionsLater(...e)),placeholder:"Žiadny rodič"},null,544),[[F.nr,n.ui.parentQuery]]),n.showParentSuggestions?((0,s.wg)(),(0,s.iD)("ul",Re,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(o.filteredParents,(e=>((0,s.wg)(),(0,s.iD)("li",{key:e.id,onMousedown:(0,F.iM)((t=>o.selectParent(e)),["prevent"])},(0,h.zw)(e.email),41,We)))),128))])):(0,s.kq)("",!0)],64)):((0,s.wg)(),(0,s.iD)("span",Le,(0,h.zw)(o.parentEmail),1))])):(0,s.kq)("",!0),(0,s._)("div",Ze,[o.isConfirmed?((0,s.wg)(),(0,s.iD)(s.HY,{key:0},[(0,s._)("div",Ke,[t[61]||(t[61]=(0,s._)("b",null,"Dňa:",-1)),(0,s._)("p",null,(0,h.zw)(o.processedDate),1)]),t[62]||(t[62]=(0,s._)("button",{class:"button",disabled:""},"Potvrdené",-1))],64)):o.isCancelled?((0,s.wg)(),(0,s.iD)("button",{key:1,class:"button",onClick:t[24]||(t[24]=(...e)=>o.znovaPrihlasit&&o.znovaPrihlasit(...e))}," Znova prihlásiť ")):((0,s.wg)(),(0,s.iD)("button",{key:2,class:"button",onClick:t[25]||(t[25]=(...e)=>o.potvrditObjednavku&&o.potvrditObjednavku(...e))}," Potvrdiť "))])])])])):(0,s.kq)("",!0),t[63]||(t[63]=(0,s._)("div",{class:"line horizontal w-90"},null,-1))]),n.showDeleteModal?((0,s.wg)(),(0,s.iD)("div",{key:0,class:"modal-overlay",onClick:t[28]||(t[28]=(0,F.iM)(((...e)=>o.closeDeleteModal&&o.closeDeleteModal(...e)),["self"]))},[(0,s._)("div",qe,[t[64]||(t[64]=(0,s._)("h3",null,"Vymazať prihlášku?",-1)),t[65]||(t[65]=(0,s._)("p",null,"Naozaj chceš vymazať túto prihlášku? Táto akcia je nezvratná.",-1)),(0,s._)("div",Ge,[(0,s._)("button",{onClick:t[26]||(t[26]=(...e)=>o.deleteOrder&&o.deleteOrder(...e)),class:"red-btn"},"Vymazať"),(0,s._)("button",{onClick:t[27]||(t[27]=(...e)=>o.closeDeleteModal&&o.closeDeleteModal(...e)),class:"gray-btn"},"Zrušiť")])])])):(0,s.kq)("",!0)],64)}var $e={props:{item:{type:Object,default:()=>({})},users:{type:Array,default:()=>[]},userMap:{type:Object,default:()=>({})}},data(){return{itemData:{},showInfo:!1,editing:!1,teachers:[{id:59,name:"Juraj"},{id:54,name:"Andrej"},{id:607,name:"Matej"}],ui:{teacher:null,studentId:null,studentQuery:"",parentId:null,parentQuery:""},showAccountSuggestions:!1,showParentSuggestions:!1,showDeleteModal:!1}},computed:{slovenskyExperience(){return{beginner:"Začiatočník",intermediate:"Stredne pokročilý",advanced:"Pokročilý"}},slovenskyRegisterer(){return{parent:"Rodič",self:"Dospelý"}},formattedId(){if(!this.itemData.timestamp_created||!this.itemData.id)return"";const e=new Date(1e3*this.itemData.timestamp_created).getFullYear(),t=String(this.itemData.id).padStart(3,"0");return`${t}-${e}`},dateStr(){if(!this.itemData.timestamp_created)return"";const e=new Date(1e3*this.itemData.timestamp_created);return`${String(e.getDate()).padStart(2,"0")}-${String(e.getMonth()+1).padStart(2,"0")}-${e.getFullYear()}`},processedDate(){if(!this.itemData.timestamp_included)return"";const e=new Date(1e3*this.itemData.timestamp_included);return`${String(e.getDate()).padStart(2,"0")}-${String(e.getMonth()+1).padStart(2,"0")}-${e.getFullYear()}`},cancelledDate(){if(!this.itemData.timestamp_excluded)return"";const e=new Date(1e3*this.itemData.timestamp_excluded);return`${String(e.getDate()).padStart(2,"0")}-${String(e.getMonth()+1).padStart(2,"0")}-${e.getFullYear()}`},isConfirmed(){return"zaradený"===this.itemData.status},isCancelled(){return"odhlásený"===this.itemData.status},isCreated(){return"čaká sa"===this.itemData.status},isEditable(){return"čaká sa"===this.itemData.status},statusLabel(){return this.isConfirmed?"Zaradený":this.isCancelled?"Odhlásený":"Čaká sa…"},teacherName(){const e=this.teachers.find((e=>e.id==this.itemData.teacher_id));return e?e.name:"Nepriradený"},typeLabel(){return"duo"===this.itemData.formOfStudy?"Duo":"solo"===this.itemData.formOfStudy?"Solo":""},accountEmail(){return this.userMap[this.itemData.student_id]?.email||"—"},parentEmail(){return this.userMap[this.itemData.parent_id]?.email||"—"},filteredAccounts(){const e=this.ui.studentQuery.toLowerCase().trim();return e?this.users.filter((t=>t.email&&t.email.toLowerCase().includes(e))):[]},filteredParents(){const e=this.ui.parentQuery.toLowerCase().trim();return e?this.users.filter((t=>t.email&&t.email.toLowerCase().includes(e))):[]}},methods:{hydrateUIFromItem(){const e=this.itemData.teacher_id||null,t=this.itemData.student_id||null,a=this.itemData.parent_id||null;this.ui.teacher=e,this.ui.studentId=t,this.ui.parentId=a;const s=e=>e&&(this.userMap[e]?.email||this.users.find((t=>String(t.id)===String(e)))?.email)||"";this.ui.studentQuery=s(t),this.ui.parentQuery=s(a)},showInfoToggle(){this.showInfo=!this.showInfo},cancelEdit(){this.editing=!1,this.showInfoToggle()},toggleFormOfStudy(){this.itemData.formOfStudy="solo"===this.itemData.formOfStudy?"duo":"solo"},openDeleteModal(){this.showDeleteModal=!0},closeDeleteModal(){this.showDeleteModal=!1},async deleteOrder(){try{const e=await c["default"].get(`https://heligonkovaakademia.sk/api/edupage/delete.php?id=${this.itemData.id}`);"Request succesfull"===e.data.status&&(this.$emit("deleted",this.itemData.id),this.showDeleteModal=!1)}catch(e){}},formatValue(e,t){return void 0===t||null===t||""===t||"NULL"===t?"":String(t)},async ulozitZmeny(){try{const e=new FormData;e.append("id",this.itemData.id),e.append("mode","all");for(const t in this.itemData)e.append(t,this.formatValue(t,this.itemData[t]));e.set("teacher_id",this.ui.teacher?String(this.ui.teacher):"0"),e.set("student_id",this.ui.studentId?String(this.ui.studentId):"0"),e.set("parent_id",this.ui.parentId?String(this.ui.parentId):"0"),await c["default"].post("https://heligonkovaakademia.sk/api/edupage/edit.php",e),this.itemData.teacher_id=this.ui.teacher||0,this.itemData.student_id=this.ui.studentId||0,this.itemData.parent_id=this.ui.parentId||0,this.editing=!1}catch(e){}},async potvrditObjednavku(){try{const e=Math.floor(Date.now()/1e3),t=new FormData;t.append("id",this.itemData.id),t.append("mode","all");for(const n in this.itemData)t.append(n,this.formatValue(n,this.itemData[n]));t.set("timestamp_included",String(e)),null!==this.ui.parentId?t.set("parent_id",String(this.ui.parentId)):t.set("parent_id","0"),t.set("teacher_id",this.ui.teacher?String(this.ui.teacher):"0"),t.set("student_id",this.ui.studentId?String(this.ui.studentId):"0"),await c["default"].post("https://heligonkovaakademia.sk/api/edupage/edit.php",t);const a=new FormData;a.append("id",this.itemData.id),a.append("mode","teacher"),a.append("teacher_id",String(this.ui.teacher)),await c["default"].post(`https://heligonkovaakademia.sk/api/edupage/edit.php?teacher_id=${encodeURIComponent(this.ui.teacher??0)}`,a);const s=new FormData;s.append("id",this.itemData.id),s.append("mode","status"),s.append("status","zaradený");const i="'zaradený'";await c["default"].post(`https://heligonkovaakademia.sk/api/edupage/edit.php?status=${encodeURIComponent(i)}`,s),this.itemData.status="zaradený",this.itemData.teacher_id=this.ui.teacher||0,this.itemData.parent_id=this.ui.parentId??0,this.itemData.student_id=this.ui.studentId||0,this.itemData.timestamp_included=e,this.editing=!1,this.$emit("updateOrder",{...this.itemData})}catch(e){}},async odhlasitZiaka(){try{const e=Math.floor(Date.now()/1e3),t=new FormData;t.append("id",this.itemData.id),t.append("mode","all");for(const s in this.itemData)t.append(s,this.formatValue(s,this.itemData[s]));t.set("timestamp_excluded",String(e)),t.set("status","odhlásený"),t.set("teacher_id","0"),t.set("student_id",this.ui.studentId?String(this.ui.studentId):"0"),t.set("parent_id",this.ui.parentId?String(this.ui.parentId):"0");const a="'odhlásený'";await c["default"].post(`https://heligonkovaakademia.sk/api/edupage/edit.php?status=${encodeURIComponent(a)}`,t),this.itemData.status="odhlásený",this.itemData.timestamp_excluded=e,this.itemData.teacher_id=0,this.ui.teacher=null,this.$emit("updateOrder",{...this.itemData})}catch(e){}},async znovaPrihlasit(){try{const e=new FormData;e.append("id",this.itemData.id),e.append("mode","all");for(const s in this.itemData)e.append(s,this.formatValue(s,this.itemData[s]));e.set("timestamp_included","0"),e.set("timestamp_excluded","0"),e.set("status","čaká sa"),e.set("teacher_id","0"),e.set("student_id",this.ui.studentId?String(this.ui.studentId):"0"),e.set("parent_id",this.ui.parentId?String(this.ui.parentId):"0"),await c["default"].post("https://heligonkovaakademia.sk/api/edupage/edit.php",e);const t=new FormData;t.append("id",this.itemData.id),t.append("mode","teacher"),await c["default"].post("https://heligonkovaakademia.sk/api/edupage/edit.php?teacher_id=10",t);const a=new FormData;a.append("id",this.itemData.id),a.append("mode","status"),await c["default"].post("https://heligonkovaakademia.sk/api/edupage/edit.php?status='čaká sa'",a),this.itemData.status="čaká sa",this.itemData.teacher_id=0,this.itemData.student_id=this.ui.studentId||0,this.itemData.parent_id=this.ui.parentId||0,this.ui.teacher=null,this.itemData.timestamp_included=null,this.itemData.timestamp_excluded=null,this.editing=!0,this.$emit("updateOrder",{...this.itemData})}catch(e){}},selectStudent(e){this.ui.studentId=e.id,this.ui.studentQuery=e.email,this.showAccountSuggestions=!1},selectParent(e){this.ui.parentId=e.id,this.ui.parentQuery=e.email,this.showParentSuggestions=!1},hideSuggestionsLater(){setTimeout((()=>{this.showAccountSuggestions=!1,this.showParentSuggestions=!1}),200)}},mounted(){this.itemData={...this.item},"čaká sa"===this.itemData.status&&(this.editing=!0),this.hydrateUIFromItem()},watch:{item:{deep:!0,handler(){this.itemData={...this.item},this.hydrateUIFromItem()}}}};const et=(0,O.Z)($e,[["render",Xe],["__scopeId","data-v-a50df43e"]]);var tt=et,at={components:{JednaObjednanaPrihlaska:tt},props:{orders:{type:Array,default:()=>[]},users:{type:Array,default:()=>[]},userMap:{type:Object,default:()=>({})}},data(){return{mesiace:[]}},watch:{orders:{immediate:!0,handler(e){this.mesiace=this.rozdelObjednavkyDoMesiacov(e)}}},computed:{rozdeleneObjednavky(){return this.mesiace},confirmedCount(){const e={};return this.orders.forEach((t=>{if("zaradený"!==t.status)return;const a=Number(t.timestamp_created);if(!a)return;const s=new Date(1e3*a),i=s.getFullYear(),n=s.getMonth();e[i]||(e[i]={}),e[i][n]||(e[i][n]=0),e[i][n]++})),e}},methods:{onDeletedOrder(e){this.mesiace.forEach((t=>{t.data=t.data.filter((t=>t.id!==e))}))},rozdelObjednavkyDoMesiacov(e){let t=[];return e.forEach((e=>{const a=Number(e.timestamp_created);if(!a)return;const s=new Date(1e3*a),i=s.getFullYear(),n=s.getMonth();let o=t.find((e=>e.month===n&&e.year===i));o||(o={data:[],isToggled:!1,month:n,year:i},t.push(o)),o.data.push({...e})})),t.sort(((e,t)=>e.year!==t.year?t.year-e.year:t.month-e.month)),t},toggleMonth(e){e.isToggled=!e.isToggled},getMonthName(e){const t=["Január","Február","Marec","Apríl","Máj","Jún","Júl","August","September","Október","November","December"];return t[e]}}};const st=(0,O.Z)(at,[["render",x],["__scopeId","data-v-57820867"]]);var it=st;function nt(e,t){return`${e}-${String(t).padStart(2,"0")}`}function ot(e,t,a=1){let s=12*e+(t-1)-a;const i=Math.floor(s/12),n=s%12+1;return[i,n]}var dt={name:"AdminOnlinePrihlaskyView",components:{HeadlineSection:z,ObjednavkyPrihlaskyMesiac:it},data(){const e=new Date;return{orders:[],teachers:[{id:59,name:"Juraj Kvočka",count:0,duo:0,solo:0},{id:54,name:"Andrej Trnka",count:0,duo:0,solo:0},{id:607,name:"Matej Kondela",count:0,duo:0,solo:0}],stats:{total:0,active:0,resigned:0},users:[],userMap:{},isMobile:"undefined"!==typeof window&&window.innerWidth<=768,selectedYear:Number(new URLSearchParams(location.search).get("year"))||e.getFullYear(),selectedMonth:Number(new URLSearchParams(location.search).get("month"))||e.getMonth()+1,ordersByPeriod:{},teachersByPeriod:{},statsByPeriod:{},loading:!1,error:null,chunkSize:5,maxMonthsBack:60,nextCursorYear:e.getFullYear(),nextCursorMonth:e.getMonth()+1,fetchedKeys:new Set,hasMore:!0,includeAllMonths:!0,teacherCountsGlobal:null}},async mounted(){await this.loadUsers(),await this.loadTeacherCountsOnce(),await this.loadNextMonthsChunk(),this.applyData(),window.addEventListener("popstate",this.onPopstate)},beforeUnmount(){window.removeEventListener("popstate",this.onPopstate)},methods:{key(e,t){return nt(e,t)},pushQuery(e,t){const a=new URL(location.href);a.searchParams.set("year",e),a.searchParams.set("month",t),history.replaceState({},"",a.toString())},onPopstate(){const e=Number(new URLSearchParams(location.search).get("year")),t=Number(new URLSearchParams(location.search).get("month"));e&&t&&(this.selectedYear=e,this.selectedMonth=t,this.applyData())},async setPeriod(e,t){this.selectedYear=Number(e),this.selectedMonth=Number(t);const a=this.key(e,t);this.ordersByPeriod[a]||await this.refreshPeriodData(e,t),this.applyData(),this.pushQuery(this.selectedYear,this.selectedMonth)},async loadNextMonthsChunk(){if(this.loading||!this.hasMore)return;this.loading=!0,this.error=null;const e=[];let t=this.nextCursorYear,a=this.nextCursorMonth,s=0,i=0;while(s<this.chunkSize&&i<this.maxMonthsBack){const n=nt(t,a);this.fetchedKeys.has(n)||(e.push({y:t,m:a,k:n}),this.fetchedKeys.add(n),s++),[t,a]=ot(t,a,1),i++}if(!e.length)return this.hasMore=!1,void(this.loading=!1);try{const t=await this.fetchStats(),a=5;for(let n=0;n<e.length;n+=a){const s=e.slice(n,n+a);await Promise.all(s.map((async({y:e,m:a,k:s})=>{const i=await this.fetchOrders(e,a);this.ordersByPeriod[s]=i,this.statsByPeriod[s]=t,this.recalculateTeachersForPeriod(e,a)})))}const s=e[e.length-1];[this.nextCursorYear,this.nextCursorMonth]=ot(s.y,s.m,1);const i=this.fetchedKeys.size;i>=this.maxMonthsBack&&(this.hasMore=!1)}catch(n){this.error=n}finally{this.loading=!1}},async fetchOrders(e,t){const a=await c["default"].get(`${this.$store.state.api}/edupage/loadAll.php?year=${e}&month=${t}`);return"Request succesfull"===a?.data?.status&&Array.isArray(a?.data?.data)?a.data.data:[]},async fetchStats(){const e=await c["default"].get(`${this.$store.state.api}/edupage/countRegistrations.php`);if("Request succesfull"===e?.data?.status&&e.data.data){const t=e.data.data;return{total:t.count_all??0,active:t["count_zaradený"]??t["count_zaradeny"]??0,resigned:t["count_odhlásený"]??t["count_odhlaseny"]??0}}return{total:0,active:0,resigned:0}},async loadUsers(){try{const e=await c["default"].get(`${this.$store.state.api}/user/stats/getUsers.php`);"Request succesfull"===e.data?.status&&Array.isArray(e.data.data?.users)?(this.users=e.data.data.users,this.userMap=Object.fromEntries(this.users.map((e=>[e.id,e])))):(this.users=[],this.userMap={})}catch{this.users=[],this.userMap={}}},async loadTeacherCountsOnce(){if(this.teacherCountsGlobal)return;const e=[59,54,607],t={};await Promise.allSettled(e.map((async e=>{try{const a=await c["default"].get(`${this.$store.state.api}/edupage/countTeacherStudents.php?id=${e}`);if("Request succesfull"===a?.data?.status){const s=a?.data?.data;if(s&&"object"===typeof s){const a=Number(s.solo)||0,i=Number(s.duo)||0;t[e]={total:a+i,solo:a,duo:i}}else{const a=Number(s)||0;t[e]={total:a,solo:null,duo:null}}}else t[e]={total:0,solo:0,duo:0}}catch{t[e]={total:0,solo:0,duo:0}}}))),this.teacherCountsGlobal=t},recalculateTeachersForPeriod(e,t){const a=this.key(e,t),s=this.teacherCountsGlobal||{},i=[{id:59,name:"Juraj Kvočka"},{id:54,name:"Andrej Trnka"},{id:607,name:"Matej Kondela"}];this.teachersByPeriod[a]=i.map((e=>({id:e.id,name:e.name,count:s[e.id]&&"object"===typeof s[e.id]?s[e.id].total??0:Number(s[e.id])||0,solo:s[e.id].solo,duo:s[e.id].duo})))},applyData(){if(this.includeAllMonths)this.orders=Object.values(this.ordersByPeriod).flat();else{const e=this.key(this.selectedYear,this.selectedMonth);this.orders=this.ordersByPeriod[e]||[]}const e=this.key(this.selectedYear,this.selectedMonth);this.teachers=this.teachersByPeriod[e]||this.teachers,this.stats=this.statsByPeriod[e]||{total:0,active:0,resigned:0}},async onDeletedOrder(e){for(const t of Object.keys(this.ordersByPeriod))this.ordersByPeriod[t]=(this.ordersByPeriod[t]||[]).filter((t=>t.id!==e));this.recalculateTeachersForPeriod(this.selectedYear,this.selectedMonth),this.applyData()}}};const rt=(0,O.Z)(dt,[["render",u],["__scopeId","data-v-376e9440"]]);var lt=rt},2218:function(e,t,a){e.exports=a.p+"img/kos.502232bb.svg"},2786:function(e){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACcAAAAnCAYAAACMo1E1AAAACXBIWXMAABCcAAAQnAEmzTo0AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAANpSURBVHgBzVjNbtNAEP7WIRGQlqYthQoulhAHTg1PQP0G7QFQT30EeIO2bwBvACckQGq5I6V9ggaJC4cKc6A0pA2tSErUEIcZ22uv3diJ82c+yYpnd539NDM7OzMCA6C0jQJaWIHAUqeDZRoq0KMrS0yaMwVQhoU95FA2VmksIUSSxaV3WO4AG3AIJQJ9t6N18Np4ip1+v+mL3DCkuoA1umo8Ia32QCw523x/sUGmex6ey+eBqevAtavOk8v6cxctei6A+rnzNBpdNhZ4gSvYInOfIik5IqZ3WihB8aWMBtycBxbmnfd+wWSPqsCvyzRMkYUR5Y+iX2I3poG7i0ENJUUEyUiCohcx1tDtW6StOYwM1RpweISeBEWIWIGI7avE7umOT40af5rAgQm0LagEH6o+GPQccn4ophwXMQb/L/+/4ru6u78HT3OltyhSuNiX8p3F0ZoyCmET0yk2jMfY5XePNxHblu+zhckQY/A+M9O+bMdTFza5j+/pKlLMubiAiYKt5JmXAj0HfUhyGWBdLmStDRMuBgHvx/ETHj9He8INHV/lxIP7kyfHaLeBz198mU7urEaDRTnAV1IaxBgZMt9U3pctyno0YfmXOd+VaSIf3L+o0dFdklLa5NSYSjHukUbep8uBXA6pIhTwC3xadSml5W8R++sJEp/J478nZ0qB8600Edrf1OhYeCkKpzFpglN7D1S9aVQf7Ek5bXJcb0gQr09sVq8KapwjVaj7Uxm5q2lZv46sN5w7Lg2wv9XVKs1CWbPTYuEkdwxO/tJA5WdA/GCs8YGAfVVsydHj2uRPLe9XO/Nl0cEr/rXJ2Wmxqz02a6gyGjtCWjNly8ILwqr2zn5PzrzHJyGtUatCvnvkWHuUgb6UcqU6/tDC//+94su8v9pDCVxfdHI34d4YbN6Db+MjKOtWBaa7v4fLFf8bStszwVbEqMtENiW3JQIFdZtKwrWYij+O4NyM05YYtldy+IN8uh4Y7kosklwUwUFJsoZYW9WTgLZiicWSswlS74QKjU1a9Cw8x8UI5/yc2nMGHe7PsU81m26Prkt/jp2ffWyg/lyApNOq4I6AjmFB8ZTDlmw5xC9NgBJ1BiwL6/TRCpIiASn/kwHA/ogsikR02a7enCJJV5ZwN/2U0zGNsx5KLuLMF4V/9MJBQJo3mxgAAAAASUVORK5CYII="},5575:function(e){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABoAAAAaCAMAAACelLz8AAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAJcEhZcwAACxMAAAsTAQCanBgAAACQUExURUdwTMJXHcdYIL9YIMNYIMNYHMJYHcJXHb9QIMFXHMNWHMFWHsFWHMFXHsJXHs9QIMJXHcFYHMVaIMFXHsVVIMNWHsJYHcFXHcJXHsFYHsJXHb9aIMFYHcFXHvJtJMJXHchaHuxqI+xrI8VZHtpiIdpiINdhIO9sI8VYHdRfIOZoIuNnIuNmIuZoI9RgIO9sJIbZAl4AAAAedFJOUwCPICBAQL+/EJDPz8/PjxDvgDCQMH/f3++A3zDf744ZZckAAADiSURBVBgZbcEHloJAFEXBpwINhjFMTv92N4rZ2f/uRj0mlCqdJa/uHUauNVFd4rhwia6GT1BW62gWV0sPrVwn7S7lbG5nM+i3dTTs4oPdCJ5+roMnfLCa4GlpL4Vgd0JJIskxtQcznPSCt0d/JYmeWVqDik85ttZgjdMHwRoEvgTWCATWCPRGsAaBkRwba7Ai05jKGuwolLKY2yPPt+SY2oMZmaSURbQ7ERLtFfhoNdFT6CAf4KPdiJ5erqPOAKZ2Np+W9Do6yQvwu200i5uqhCLXVZpxkaWqmxTZL/xk41Qn//CgPsKsDi39AAAAAElFTkSuQmCC"},3073:function(e){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACcAAAAnCAMAAAC7faEHAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAJcEhZcwAAEJwAABCcASbNOjQAAACKUExURUdwTHCfQHSjQHOhQHCfQHOjQICvQHOiQHinQHSjQHOjQHSkQHOjQHSjQHWiQHCfQHKiQHWlQHOjQHKhQHOiQJDKUHOiQIzFTnWkQX6xRoG2SI3FTnqsRIrCTYO5SYK2SInATHyuRXWlQXusRIe9S4vDTYvCTYS5SYO4SY/IT3yvRY7IT47HT4e+SxNkcpEAAAAVdFJOUwAQv5AgUBDfIEC/j5DPYDCPMK+wr6IKWSkAAAFQSURBVDjLrdTZdptAEIThYm2EFjt2+h9AshZb8Zbk/V8vF8jHxojlInX9ne6BOVPS1+Sb5doAK5dZoaEsSr7mLpujAOxHT+W3AOwO5+Du4dg8AbDMu6wwoDr89s+EGsCKHjsF7ybU32BhUL14P/sOzA2qB7+Whwrs44y3wHXWwmXLboAXH8oeWEiSDGofzglKScqAMOJC1Q68Gx/nfoBSKibGuf8BcmWw8/E8wUYJNBPuACvFcJxwZ1jLpo7nHsAE+FSA/+7mnm8N5wl3hHLO/2tgpc2s+8gUAW+jbAukUjy1uIZ7SQt43E6MyyQphvfxcdYWBrAfZK/ApT4SePw1wJ6B1eVdRjYInyuw6OOhpzaw+rUCSz+LIzWg/v7V2xNddoFd+dZUPSZFSdt/zTG4e/jb7ABYRb2mvLFen8aLq82b/ZyjJCnNktgAWyeb7sZ/6i1kz6f1KPoAAAAASUVORK5CYII="}}]);