"use strict";(self["webpackChunkheligonkova_akademia"]=self["webpackChunkheligonkova_akademia"]||[]).push([[3285],{3285:function(e,i,a){a.r(i),a.d(i,{default:function(){return $}});var t=a(3396),s=a(9242),l=a(7139),n=a(4970),o=a(6789);const p=["id"],d={class:"column"},r={class:"row-form"},c={class:"row-form"},u={class:"row-form"},h={class:"stupnice"},v={class:"stupnica"},y={class:"row-form"},f={class:"zvukova-stopa"},z={class:"column"},m={class:"row-form"},k={class:"row-form"},g={type:"submit",class:"button"},_={key:0},F={key:1},D={key:1,class:"zrusit click"},S={class:"column"},x={class:"column"};function b(e,i,a,b,w,V){return(0,t.wg)(),(0,t.iD)("section",{id:e.$route.name},[(0,t._)("form",{class:"scroll",onSubmit:i[14]||(i[14]=(0,s.iM)(((...e)=>V.zapisanieZapisu&&V.zapisanieZapisu(...e)),["prevent"]))},[(0,t._)("div",d,[(0,t._)("div",r,[i[17]||(i[17]=(0,t._)("label",{for:"nazov-piesne"},"Názov videa:",-1)),(0,t.wy)((0,t._)("input",{ref:"nazov",type:"text",name:"nazov-piesne",placeholder:"Ako hrať na heligonke?","onUpdate:modelValue":i[0]||(i[0]=e=>w.zapisyData.nazov=e),class:(0,l.C_)({"block-click block-cursor":w.upravovanieZapisu})},null,2),[[s.nr,w.zapisyData.nazov]]),(0,t._)("div",c,[i[16]||(i[16]=(0,t._)("label",{for:"obtiaznost-piesne"},"Zaradenie do sekcie:",-1)),(0,t.wy)((0,t._)("select",{ref:"obtiaznost","onUpdate:modelValue":i[1]||(i[1]=e=>w.zapisyData.obtiaznost=e),name:"obtiaznost-piesne"},i[15]||(i[15]=[(0,t._)("option",{value:"1"},"Začiatočník",-1),(0,t._)("option",{value:"2"},"Stredne pokročilý",-1),(0,t._)("option",{value:"3"},"Pokročilý",-1)]),512),[[s.bM,w.zapisyData.obtiaznost]])]),i[18]||(i[18]=(0,t._)("label",{for:"dlzka-piesne"},"Dĺžka videa:",-1)),(0,t.wy)((0,t._)("input",{ref:"dlzka",type:"text",name:"dlzka-piesne",placeholder:"13:30","onUpdate:modelValue":i[2]||(i[2]=e=>w.zapisyDetaily.dlzkaVidea=e)},null,512),[[s.nr,w.zapisyDetaily.dlzkaVidea]])]),(0,t._)("div",u,[i[19]||(i[19]=(0,t._)("label",{for:"stupnica-piesne"},"Video:",-1)),(0,t._)("div",h,[(0,t._)("div",v,[(0,t._)("label",{for:"video",class:"button Adumu",onClick:i[3]||(i[3]=e=>V.openFileInput("V"))}," Pridať "),(0,t._)("input",{type:"file",id:"video",class:"custom-file-input",ref:"fileInputV",onChange:i[4]||(i[4]=e=>V.handleFileChange("V",e)),accept:".mp4"},null,544),w.selectedFileNames.V?((0,t.wg)(),(0,t.iD)("div",{key:0,onClick:i[5]||(i[5]=e=>V.clearSelectedFile("V")),class:"selected-file-info"},(0,l.zw)(w.selectedFileNames.V),1)):(0,t.kq)("",!0)])])]),(0,t._)("div",y,[i[20]||(i[20]=(0,t._)("label",{for:"zvuk-piesne"},"Tit. obrázok:",-1)),(0,t._)("div",f,[(0,t._)("label",{for:"customFileT",class:"button Adumu",onClick:i[6]||(i[6]=e=>V.openFileInput("T"))}," Pridať "),(0,t._)("input",{type:"file",id:"customFileT",class:"custom-file-input",ref:"fileInputT",onChange:i[7]||(i[7]=e=>V.handleFileChange("T",e)),accept:".png"},null,544),w.selectedFileNames.T?((0,t.wg)(),(0,t.iD)("div",{key:0,onClick:i[8]||(i[8]=e=>V.clearSelectedFile("T")),class:"selected-file-info"},(0,l.zw)(w.selectedFileNames.T),1)):(0,t.kq)("",!0)])])]),i[27]||(i[27]=(0,t._)("div",{class:"line"},null,-1)),(0,t._)("div",z,[(0,t._)("div",m,[i[21]||(i[21]=(0,t._)("label",{for:"text-piesne"},"Text piesne",-1)),(0,t.wy)((0,t._)("textarea",{name:"text-piesne",ref:"text","onUpdate:modelValue":i[9]||(i[9]=e=>w.zapisyDetaily.text=e),cols:"30",rows:"15"},null,512),[[s.nr,w.zapisyDetaily.text]])]),(0,t._)("div",k,[i[22]||(i[22]=(0,t._)("label",{for:"info-piesne"},"Informácie k piesni",-1)),(0,t.wy)((0,t._)("textarea",{name:"info-piesne",ref:"info","onUpdate:modelValue":i[10]||(i[10]=e=>w.zapisyDetaily.info=e),cols:"30",rows:"10"},null,512),[[s.nr,w.zapisyDetaily.info]])]),(0,t._)("button",g,[w.odosielanie?(0,t.kq)("",!0):((0,t.wg)(),(0,t.iD)("p",_,(0,l.zw)(w.upravovanieZapisu?"Upraviť video":"Pridať video"),1)),w.odosielanie?((0,t.wg)(),(0,t.iD)("p",F,"Nahrávanie")):(0,t.kq)("",!0)]),w.odosielanie?(0,t.kq)("",!0):((0,t.wg)(),(0,t.iD)("div",{key:0,onClick:i[11]||(i[11]=i=>e.$router.go(-1)),class:"zrusit click"},i[23]||(i[23]=[(0,t._)("img",{src:n,alt:"Zrušiť"},null,-1),(0,t._)("p",null,"Zrušiť",-1)]))),w.odosielanie?((0,t.wg)(),(0,t.iD)("div",D,i[24]||(i[24]=[(0,t._)("p",null,"Prosím neopúšťajte stránku ...",-1)]))):(0,t.kq)("",!0)]),i[28]||(i[28]=(0,t._)("div",{class:"line"},null,-1)),(0,t._)("div",S,[w.upravovanieZapisu?((0,t.wg)(),(0,t.iD)("div",{key:0,class:(0,l.C_)([{"not-have-permission":!this.$store.state.userRoles?.roles?.includes("video_delete")},"zrusit click"]),onClick:i[12]||(i[12]=e=>V.vymazZapis(0))},i[25]||(i[25]=[(0,t._)("p",null,"Skry video",-1),(0,t._)("img",{src:n,alt:"Vymazať video"},null,-1)]),2)):(0,t.kq)("",!0)]),(0,t._)("div",x,[w.upravovanieZapisu?((0,t.wg)(),(0,t.iD)("div",{key:0,class:(0,l.C_)([{"not-have-permission":!this.$store.state.userRoles?.roles?.includes("video_delete")},"zrusit click"]),onClick:i[13]||(i[13]=e=>V.vymazZapis(1))},i[26]||(i[26]=[(0,t._)("p",null,"Vymaž video",-1),(0,t._)("img",{src:o,alt:"Vymazať video"},null,-1)]),2)):(0,t.kq)("",!0)])],32)],8,p)}a(560);var w={mounted(){window.scrollTo(0,0),"undefined"!==typeof this.$route.query.id&&(this.upravovanieZapisu=!0,this.nacitajDataZapisu())},data(){return{selectedFileNames:{V:"",T:""},zapisyData:{nazov:"",obtiaznost:"",cena:1},zapisyDetaily:{typ:"Video",text:"",info:"",dlzkaVidea:""},selectedFiles:[],selectedFilesStupnica:[],selectedFilesSong:[],selectedFilesSongStupnica:[],odosielanie:!1,upravovanieZapisu:!1}},methods:{zapisanieZapisu(){this.upravovanieZapisu?this.upravenieZapisu():this.vytvorenieZapisu()},openFileInput(e){"T"==e?-1!=this.selectedFilesSongStupnica.indexOf(e)&&this.clearSelectedFile(e):-1!=this.selectedFilesStupnica.indexOf(e)&&this.clearSelectedFile(e),this.$refs[`fileInput${e}`].value=""},handleFileChange(e,i){"T"==e?(this.selectedFilesSong.push(i.target.files[0]),this.selectedFilesSongStupnica.push(e),this.selectedFileNames[e]=i.target.files[0].name):(this.selectedFiles.push(i.target.files[0]),this.selectedFilesStupnica.push(e),this.selectedFileNames[e]=i.target.files[0].name)},clearSelectedFile(e){this.selectedFileNames[e]="","T"==e?(this.selectedFilesSong.pop(),this.selectedFilesSongStupnica.pop()):(this.selectedFiles.splice(this.selectedFilesStupnica.indexOf(e),1),this.selectedFilesStupnica.splice(this.selectedFilesStupnica.indexOf(e),1))},vytvorenieZapisu(){if(this.podmienkyPreOdoslanie()){this.odosielanie=!0;const i=a(7218),t=a(6237);let s=new t;if(0==this.selectedFiles.length||0==this.selectedFilesSong.length)return this.$store.state.SnackBarText="Pre pridanie videa je potrebné pridať video a titulný obrázok",void(this.odosielanie=!1);this.zapisyDetaily.text=this.zapisyDetaily.text.replaceAll("\n","//n"),this.zapisyDetaily.info=this.zapisyDetaily.info.replaceAll("\n","//n");const l=JSON.stringify(this.zapisyDetaily);var e=this.zapisyData.nazov.normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/\s/g,"_").toLowerCase();s.append("virtuality",!0),s.append("free",!1),s.append("name",this.zapisyData.nazov),s.append("price",1),s.append("difficulty",this.zapisyData.obtiaznost),s.append("expiration","never"),s.append("details",l),s.append("data","videos/"+e);for(let a=0;a<this.selectedFiles.length;a++)s.append("data_files[]",this.selectedFiles[a],e+"-"+this.selectedFilesStupnica[a]+".mp4");s.append("details_files[]",this.selectedFilesSong[0],e+"-T.png");let n={method:"post",maxBodyLength:1/0,url:this.$store.state.api+"/product/create.php/",headers:{"Content-Type":"multipart/form-data"},data:s};i.request(n).then((e=>{"Request fullfiled"==e.data.status?(this.$store.state.SnackBarText="Video bolo úspešne pridané",this.$router.push("/admin")):(this.$store.state.SnackBarText="Video sa nepodarilo pridať",this.odosielanie=!1)})).catch((e=>{this.$store.state.SnackBarText="Video sa nepodarilo pridať",this.odosielanie=!1}))}},upravenieZapisu(){if(this.podmienkyPreOdoslanie()){this.odosielanie=!0;const i=a(7218),t=a(6237);if(""==this.selectedFileNames.V||""==this.selectedFileNames.T)return this.$store.state.SnackBarText="Pre pridanie videa je potrebné pridať video a titulný obrázok",void(this.odosielanie=!1);this.zapisyDetaily.text=this.zapisyDetaily.text.replaceAll("\n","//n"),this.zapisyDetaily.info=this.zapisyDetaily.info.replaceAll("\n","//n");const s=JSON.stringify(this.zapisyDetaily);var e=this.zapisyData.nazov.normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/\s/g,"_").toLowerCase();let l=new t;if(l.append("id",this.$route.query.id),l.append("virtuality",!0),l.append("name",this.zapisyData.nazov),l.append("price",1),l.append("free",!1),l.append("difficulty",this.zapisyData.obtiaznost),l.append("expiration","never"),l.append("details",s),l.append("data","videos/"+e),0!=this.selectedFiles.length)for(let a=0;a<this.selectedFiles.length;a++)l.append("data_files[]",this.selectedFiles[a],e+"-V.mp4");0!=this.selectedFilesSong.length&&l.append("details_files[]",this.selectedFilesSong[0],e+"-T.png");let n={method:"post",maxBodyLength:1/0,url:this.$store.state.api+"/product/update.php/",headers:{"Content-Type":"multipart/form-data"},data:l};i.request(n).then((e=>{this.$store.state.SnackBarText="Video bolo úspešne upravené",this.$router.push("/admin")})).catch((e=>{this.$store.state.SnackBarText="Video sa nepodarilo upraviť",this.odosielanie=!1}))}},nacitajDataZapisu(){const e=a(7218);let i={method:"get",maxBodyLength:1/0,url:this.$store.state.api+"/product/loadLimited.php/?id="+this.$route.query.id};e.request(i).then((e=>{if("Request succesfull"==e.data.status){var i=e.data.data.details;let a=i.replace(/[\n\t]/g,""),t=JSON.parse(a);i=t,this.zapisyData.nazov=e.data.data.name,this.zapisyData.obtiaznost=e.data.data.difficulty,this.zapisyDetaily.dlzkaVidea=i.dlzkaVidea,this.zapisyDetaily.text=i.text.replaceAll("//n","\n"),this.zapisyDetaily.info=i.info.replaceAll("//n","\n"),this.selectedFileNames.V=this.zapisyData.nazov.normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/\s/g,"_").toLowerCase()+"-V.mp4",this.selectedFileNames.T=this.zapisyData.nazov.normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/\s/g,"_").toLowerCase()+"-T.png"}})).catch((e=>{}))},vymazZapis(e){if(confirm("Ste si istý že chcete vymazať video?")){const i=a(7218),t=a(6237);let s=new t,l="";1==e&&(l="&permanent=true");let n={method:"get",maxBodyLength:1/0,url:this.$store.state.api+"/product/delete.php/?id="+this.$route.query.id+l,data:s};i.request(n).then((e=>{"Request fullfiled"==e.data.status?(this.$store.state.SnackBarText="Video s názvom "+this.zapisyData.nazov+" bolo naždy vymazané",this.$router.go(-1)):this.$store.state.SnackBarText="Video: "+this.zapisyData.nazov+" sa nepodarilo vymazať"})).catch((e=>{}))}},podmienkyPreOdoslanie(){return""!==this.zapisyData.nazov.trim()&&""!==this.zapisyData.obtiaznost.trim()||(this.$store.state.SnackBarText="Nepodarilo sa vytvoriť video, pre odoslanie vyplňťe všetky polia",!1)}}},V=a(89);const T=(0,V.Z)(w,[["render",b],["__scopeId","data-v-79989678"]]);var $=T},6789:function(e,i,a){e.exports=a.p+"img/nespravne.f7865d38.svg"},4970:function(e,i,a){e.exports=a.p+"img/zrusit.31ce29f1.svg"}}]);