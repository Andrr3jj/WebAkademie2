"use strict";(self["webpackChunkheligonkova_akademia"]=self["webpackChunkheligonkova_akademia"]||[]).push([[7299],{7299:function(e,a,t){t.r(a),t.d(a,{default:function(){return H}});var i=t(3396),s=t(9242),n=t(7139),l=t(4970),p=t(6789);const o=["id"],r={class:"column"},d={class:"row-form"},c={class:"row-form"},u={class:"row-form"},h={key:0,class:"row-form vyber"},y={class:"checkbox"},v={class:"checkbox"},f={key:1,class:"row-form"},z={class:"stupnice"},m={class:"stupnica"},k={class:"stupnica"},D={class:"stupnica"},b={class:"stupnica"},g={class:"stupnica"},_={class:"stupnica"},F={key:2,class:"row-form"},w=["onUpdate:modelValue","onChange"],Z=["value"],S={class:"row-form"},x={class:"zvukova-stopa"},C={class:"column"},P={class:"row-form"},N={class:"row-form"},j={type:"submit",class:"button"},$={key:0},q={key:1},B={key:1,class:"zrusit click"},T={class:"column"},V={class:"row-form"},A={class:"row-form"},I={class:"row-form"},U={class:"row-form"},G={class:"row-form"},O={class:"row-form"},R={class:"row-form checkbox"};function L(e,a,t,L,M,E){return(0,i.wg)(),(0,i.iD)("section",{id:e.$route.name},[(0,i._)("form",{class:"scroll",onSubmit:a[39]||(a[39]=(0,s.iM)(((...e)=>E.zapisanieZapisu&&E.zapisanieZapisu(...e)),["prevent"]))},[(0,i._)("div",r,[(0,i._)("div",{class:(0,n.C_)([{"block-cursor":M.upravovanieZapisu},"row-form"])},[a[40]||(a[40]=(0,i._)("label",{for:"nazov-piesne"},"Názov piesne:",-1)),(0,i.wy)((0,i._)("input",{ref:"nazov",type:"text",name:"nazov-piesne",placeholder:"Na orave dobre...","onUpdate:modelValue":a[0]||(a[0]=e=>M.zapisyData.nazov=e),class:(0,n.C_)({"block-click":M.upravovanieZapisu})},null,2),[[s.nr,M.zapisyData.nazov]])],2),(0,i._)("div",d,[a[41]||(a[41]=(0,i._)("label",{for:"autor"},"Číselný zápis napísal:",-1)),(0,i.wy)((0,i._)("input",{ref:"autor","onUpdate:modelValue":a[1]||(a[1]=e=>M.zapisyDetaily.autor=e),type:"text",name:"autor",placeholder:"Andrej Trnka"},null,512),[[s.nr,M.zapisyDetaily.autor]])]),(0,i._)("div",c,[a[42]||(a[42]=(0,i._)("label",{for:"tempo-piesne"},"Tempo piesne:",-1)),(0,i.wy)((0,i._)("input",{ref:"tempo","onUpdate:modelValue":a[2]||(a[2]=e=>M.zapisyDetaily.tempo=e),type:"text",name:"tempo-piesne",placeholder:"Pomalé"},null,512),[[s.nr,M.zapisyDetaily.tempo]])]),(0,i._)("div",u,[a[43]||(a[43]=(0,i._)("label",{for:"zaner-piesne"},"Žáner piesne:",-1)),(0,i.wy)((0,i._)("input",{ref:"zaner","onUpdate:modelValue":a[3]||(a[3]=e=>M.zapisyDetaily.zaner=e),type:"text",name:"zaner-piesne",placeholder:"Ľudová - Valčík"},null,512),[[s.nr,M.zapisyDetaily.zaner]])]),null!=M.vyber||"pdf"==M.vyber||"prepojenie"==M.vyber?((0,i.wg)(),(0,i.iD)("div",h,[a[46]||(a[46]=(0,i._)("label",null,"Vyber prepojenie alebo PDF",-1)),(0,i._)("div",y,[(0,i._)("div",v,[(0,i.wy)((0,i._)("input",{"onUpdate:modelValue":a[4]||(a[4]=e=>M.vyber=e),type:"radio",name:"vyberMoznost",value:"pdf"},null,512),[[s.G2,M.vyber]]),a[44]||(a[44]=(0,i._)("label",{for:"vyberPdf"},"PDF",-1))]),(0,i.wy)((0,i._)("input",{"onUpdate:modelValue":a[5]||(a[5]=e=>M.vyber=e),type:"radio",name:"vyberMoznost",value:"prepojenie"},null,512),[[s.G2,M.vyber]]),a[45]||(a[45]=(0,i._)("label",{for:"vyberPrepojenie"},"Prepojenie",-1))])])):(0,i.kq)("",!0),"pdf"==M.vyber||null==M.vyber?((0,i.wg)(),(0,i.iD)("div",f,[a[53]||(a[53]=(0,i._)("label",{for:"stupnica-piesne"},"Stupnica:",-1)),(0,i._)("div",z,[(0,i._)("div",m,[a[47]||(a[47]=(0,i._)("p",{class:"nazov-stupnice"},"F - Dur",-1)),(0,i._)("label",{for:"customFileF",class:"button Adumu",onClick:a[6]||(a[6]=e=>E.openFileInput("F"))}," Pridať "),(0,i._)("input",{type:"file",id:"customFileF",class:"custom-file-input",ref:"fileInputF",onChange:a[7]||(a[7]=e=>E.handleFileChange("F",e)),accept:".pdf"},null,544),M.selectedFileNames.F?((0,i.wg)(),(0,i.iD)("div",{key:0,onClick:a[8]||(a[8]=e=>E.clearSelectedFile("F")),class:"selected-file-info"},(0,n.zw)(M.selectedFileNames.F),1)):(0,i.kq)("",!0)]),(0,i._)("div",k,[a[48]||(a[48]=(0,i._)("p",{class:"nazov-stupnice"},"C - Dur",-1)),(0,i._)("label",{for:"customFileC",class:"button Adumu",onClick:a[9]||(a[9]=e=>E.openFileInput("C"))}," Pridať "),(0,i._)("input",{type:"file",id:"customFileC",class:"custom-file-input",ref:"fileInputC",onChange:a[10]||(a[10]=e=>E.handleFileChange("C",e)),accept:".pdf"},null,544),M.selectedFileNames.C?((0,i.wg)(),(0,i.iD)("div",{key:0,onClick:a[11]||(a[11]=e=>E.clearSelectedFile("C")),class:"selected-file-info"},(0,n.zw)(M.selectedFileNames.C),1)):(0,i.kq)("",!0)]),(0,i._)("div",D,[a[49]||(a[49]=(0,i._)("p",{class:"nazov-stupnice"},"G - Dur",-1)),(0,i._)("label",{for:"customFileG",class:"button Adumu",onClick:a[12]||(a[12]=e=>E.openFileInput("G"))}," Pridať "),(0,i._)("input",{type:"file",id:"customFileG",class:"custom-file-input",ref:"fileInputG",onChange:a[13]||(a[13]=e=>E.handleFileChange("G",e)),accept:".pdf"},null,544),M.selectedFileNames.G?((0,i.wg)(),(0,i.iD)("div",{key:0,onClick:a[14]||(a[14]=e=>E.clearSelectedFile("G")),class:"selected-file-info"},(0,n.zw)(M.selectedFileNames.G),1)):(0,i.kq)("",!0)]),(0,i._)("div",b,[a[50]||(a[50]=(0,i._)("p",{class:"nazov-stupnice"},"D - Mol",-1)),(0,i._)("label",{for:"customFileD",class:"button Adumu",onClick:a[15]||(a[15]=e=>E.openFileInput("D"))}," Pridať "),(0,i._)("input",{type:"file",id:"customFileD",class:"custom-file-input",ref:"fileInputD",onChange:a[16]||(a[16]=e=>E.handleFileChange("D",e)),accept:".pdf"},null,544),M.selectedFileNames.D?((0,i.wg)(),(0,i.iD)("div",{key:0,onClick:a[17]||(a[17]=e=>E.clearSelectedFile("D")),class:"selected-file-info"},(0,n.zw)(M.selectedFileNames.D),1)):(0,i.kq)("",!0)]),(0,i._)("div",g,[a[51]||(a[51]=(0,i._)("p",{class:"nazov-stupnice"},"A - Mol",-1)),(0,i._)("label",{for:"customFileA",class:"button Adumu",onClick:a[18]||(a[18]=e=>E.openFileInput("A"))}," Pridať "),(0,i._)("input",{type:"file",id:"customFileA",class:"custom-file-input",ref:"fileInputA",onChange:a[19]||(a[19]=e=>E.handleFileChange("A",e)),accept:".pdf"},null,544),M.selectedFileNames.A?((0,i.wg)(),(0,i.iD)("div",{key:0,onClick:a[20]||(a[20]=e=>E.clearSelectedFile("A")),class:"selected-file-info"},(0,n.zw)(M.selectedFileNames.A),1)):(0,i.kq)("",!0)]),(0,i._)("div",_,[a[52]||(a[52]=(0,i._)("p",{class:"nazov-stupnice"},"B - Dur",-1)),(0,i._)("label",{for:"customFileB",class:"button Adumu",onClick:a[21]||(a[21]=e=>E.openFileInput("B"))}," Pridať "),(0,i._)("input",{type:"file",id:"customFileB",class:"custom-file-input",ref:"fileInputB",onChange:a[22]||(a[22]=e=>E.handleFileChange("B",e)),accept:".pdf"},null,544),M.selectedFileNames.B?((0,i.wg)(),(0,i.iD)("div",{key:0,onClick:a[23]||(a[23]=e=>E.clearSelectedFile("B")),class:"selected-file-info"},(0,n.zw)(M.selectedFileNames.B),1)):(0,i.kq)("",!0)])])])):(0,i.kq)("",!0),"prepojenie"==M.vyber?((0,i.wg)(),(0,i.iD)("div",F,[a[55]||(a[55]=(0,i._)("label",{for:"prepojenie"},"Prepojenie:",-1)),((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(M.vybraneZapisy,((e,t)=>((0,i.wg)(),(0,i.iD)("div",{key:t,class:"row-form"},[(0,i.wy)((0,i._)("select",{"onUpdate:modelValue":e=>M.vybraneZapisy[t]=e,onChange:e=>E.pridajSelect(t)},[a[54]||(a[54]=(0,i._)("option",{value:""},"-- Číselný zápis --",-1)),((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(E.zoradenyEditorZoznam,(e=>((0,i.wg)(),(0,i.iD)("option",{key:e.id,value:e.id},(0,n.zw)(e.nazov)+" | "+(0,n.zw)(e.autor)+" ("+(0,n.zw)(e?.stupnica)+") ",9,Z)))),128))],40,w),[[s.bM,M.vybraneZapisy[t]]])])))),128))])):(0,i.kq)("",!0),(0,i._)("div",S,[a[56]||(a[56]=(0,i._)("label",{for:"zvuk-piesne"},"Zvuková stopa:",-1)),(0,i._)("div",x,[(0,i._)("label",{for:"customFileZ",class:"button Adumu",onClick:a[24]||(a[24]=e=>E.openFileInput("Z"))}," Pridať "),(0,i._)("input",{type:"file",id:"customFileZ",class:"custom-file-input",ref:"fileInputZ",onChange:a[25]||(a[25]=e=>E.handleFileChange("Z",e)),accept:".mp3"},null,544),M.selectedFileNames.Z?((0,i.wg)(),(0,i.iD)("div",{key:0,onClick:a[26]||(a[26]=e=>E.clearSelectedFile("Z")),class:"selected-file-info"},(0,n.zw)(M.selectedFileNames.Z),1)):(0,i.kq)("",!0)])])]),a[74]||(a[74]=(0,i._)("div",{class:"line"},null,-1)),(0,i._)("div",C,[(0,i._)("div",P,[a[57]||(a[57]=(0,i._)("label",{for:"text-piesne"},"Text piesne",-1)),(0,i.wy)((0,i._)("textarea",{name:"text-piesne",ref:"text","onUpdate:modelValue":a[27]||(a[27]=e=>M.zapisyDetaily.text=e),cols:"30",rows:"15"},null,512),[[s.nr,M.zapisyDetaily.text]])]),(0,i._)("div",N,[a[58]||(a[58]=(0,i._)("label",{for:"info-piesne"},"Informácie k piesni",-1)),(0,i.wy)((0,i._)("textarea",{name:"info-piesne",ref:"info","onUpdate:modelValue":a[28]||(a[28]=e=>M.zapisyDetaily.info=e),cols:"30",rows:"10"},null,512),[[s.nr,M.zapisyDetaily.info]])]),(0,i._)("button",j,[M.odosielanie?(0,i.kq)("",!0):((0,i.wg)(),(0,i.iD)("p",$,(0,n.zw)(M.upravovanieZapisu?"Upraviť pieseň":"Pridať pieseň"),1)),M.odosielanie?((0,i.wg)(),(0,i.iD)("p",q,"Nahrávanie")):(0,i.kq)("",!0)]),M.odosielanie?(0,i.kq)("",!0):((0,i.wg)(),(0,i.iD)("div",{key:0,onClick:a[29]||(a[29]=a=>e.$router.go(-1)),class:"zrusit click"},a[59]||(a[59]=[(0,i._)("img",{src:l,alt:"Zrušiť"},null,-1),(0,i._)("p",null,"Zrušiť",-1)]))),M.odosielanie?((0,i.wg)(),(0,i.iD)("div",B,a[60]||(a[60]=[(0,i._)("p",null,"Prosím neopúšťajte stránku ...",-1)]))):(0,i.kq)("",!0)]),a[75]||(a[75]=(0,i._)("div",{class:"line"},null,-1)),(0,i._)("div",T,[M.upravovanieZapisu?((0,i.wg)(),(0,i.iD)("div",{key:0,class:(0,n.C_)([{"not-have-permission":!this.$store.state.userRoles?.roles?.includes("numericRecord_delete")},"zrusit click"]),onClick:a[30]||(a[30]=e=>E.vymazZapis(0))},a[61]||(a[61]=[(0,i._)("p",null,"Skry zápis",-1),(0,i._)("img",{src:l,alt:"Skry zapis"},null,-1)]),2)):(0,i.kq)("",!0),M.upravovanieZapisu?((0,i.wg)(),(0,i.iD)("div",{key:1,class:(0,n.C_)([{"not-have-permission":!this.$store.state.userRoles?.roles?.includes("numericRecord_delete")},"zrusit click"]),onClick:a[31]||(a[31]=e=>E.vymazZapis(1))},a[62]||(a[62]=[(0,i._)("p",null,"Vymaž zápis",-1),(0,i._)("img",{src:p,alt:"Skry zapis"},null,-1)]),2)):(0,i.kq)("",!0),(0,i._)("div",V,[a[64]||(a[64]=(0,i._)("label",{for:"obtiaznost-piesne"},"Obtiažnosť piesne:",-1)),(0,i.wy)((0,i._)("select",{ref:"obtiaznost","onUpdate:modelValue":a[32]||(a[32]=e=>M.zapisyData.obtiaznost=e),name:"obtiaznost-piesne"},a[63]||(a[63]=[(0,i.uE)('<option value="1" data-v-3502f5a4>Veľmi ľahká</option><option value="2" data-v-3502f5a4>Ľahká</option><option value="3" data-v-3502f5a4>Stredne ťažká</option><option value="4" data-v-3502f5a4>Ťažká</option><option value="5" data-v-3502f5a4>Veľmi ťažká</option><option value="6" data-v-3502f5a4>Expert</option>',6)]),512),[[s.bM,M.zapisyData.obtiaznost]])]),(0,i._)("div",A,[a[66]||(a[66]=(0,i._)("label",{for:"urcene-pre"},"Určené pre:",-1)),(0,i.wy)((0,i._)("select",{ref:"urcenePre","onUpdate:modelValue":a[33]||(a[33]=e=>M.zapisyDetaily.urcenePre=e),name:"urcene-pre"},a[65]||(a[65]=[(0,i._)("option",{value:"dvojradova-heligonka"},"Dvojradovú heligónku",-1),(0,i._)("option",{value:"trojradova-heligonka"},"Trojradovú heligónku",-1)]),512),[[s.bM,M.zapisyDetaily.urcenePre]])]),(0,i._)("div",I,[a[68]||(a[68]=(0,i._)("label",{for:"zaradenie"},"Zaradenie:",-1)),(0,i.wy)((0,i._)("select",{ref:"zaradenie","onUpdate:modelValue":a[34]||(a[34]=e=>M.zapisyData.zaradenie=e),name:"zaradenie"},a[67]||(a[67]=[(0,i.uE)('<option value="polka" data-v-3502f5a4>Polka</option><option value="valcik" data-v-3502f5a4>Valčík</option><option value="ceska" data-v-3502f5a4>Česká</option><option value="terchovska" data-v-3502f5a4>Terchovská</option><option value="moderna" data-v-3502f5a4>Moderná</option><option value="vianocna" data-v-3502f5a4>Vianočná</option>',6)]),512),[[s.bM,M.zapisyData.zaradenie]])]),(0,i._)("div",U,[a[70]||(a[70]=(0,i._)("label",{for:"statistikakategoria"},"Typ:",-1)),(0,i.wy)((0,i._)("select",{ref:"statistikakategoria","onUpdate:modelValue":a[35]||(a[35]=e=>M.zapisyDetaily.statistikakategoria=e),name:"statistikakategoria"},a[69]||(a[69]=[(0,i._)("option",{value:"polka"},"Polka",-1),(0,i._)("option",{value:"valcik"},"Valčík",-1)]),512),[[s.bM,M.zapisyDetaily.statistikakategoria]])]),(0,i._)("div",G,[a[71]||(a[71]=(0,i._)("label",{for:"cena-piesne"},"Cena piesne EUR:",-1)),(0,i.wy)((0,i._)("input",{ref:"cena","onUpdate:modelValue":a[36]||(a[36]=e=>M.zapisyData.cena=e),type:"text",name:"cena-piesne",placeholder:"2.00"},null,512),[[s.nr,M.zapisyData.cena]])]),(0,i._)("div",O,[a[72]||(a[72]=(0,i._)("label",{for:"novinka-piesne"},"Novinka (deň):",-1)),(0,i.wy)((0,i._)("input",{ref:"novinka","onUpdate:modelValue":a[37]||(a[37]=e=>M.zapisyData.novinka=e),type:"text",name:"novinka-piesne",placeholder:"10"},null,512),[[s.nr,M.zapisyData.novinka]])]),(0,i._)("div",R,[(0,i.wy)((0,i._)("input",{ref:"registracnaPesnickaCheckbox","onUpdate:modelValue":a[38]||(a[38]=e=>M.zapisyData.registracnaPesnicka=e),type:"checkbox",name:"registracna-pesnicka"},null,512),[[s.e8,M.zapisyData.registracnaPesnicka]]),a[73]||(a[73]=(0,i._)("label",{for:"registracna-pesnicka"},"Registračná pesnička:",-1))])])],32)],8,o)}t(560);var M={mounted(){window.scrollTo(0,0),"undefined"!==typeof this.$route.query.id&&(this.upravovanieZapisu=!0,this.nacitajDataZapisu(),this.productID=this.$route.query.id),this.nacitajInfoEditorZapisy()},data(){return{selectedFileNames:{F:"",C:"",G:"",D:"",A:"",B:"",Z:""},zapisyData:{nazov:"",obtiaznost:"",zaradenie:"",cena:"",novinka:"10",registracnaPesnicka:!1},zapisyDetaily:{typ:"Zapis",autor:"",tempo:"",zaner:"",text:"",info:"",urcenePre:"",statistikakategoria:"",stupnice:[]},selectedFiles:[],selectedFilesStupnica:[],stupnicePrepojenie:[],selectedFilesSong:[],selectedFilesSongStupnica:[],odosielanie:!1,upravovanieZapisu:!1,vyber:null,vybraneZapisy:[""],vybraneZapisyPred:[""],editorZoznam:[],productID:0}},computed:{zoradenyEditorZoznam(){return[...this.editorZoznam].sort(((e,a)=>e.nazov.localeCompare(a.nazov)))}},methods:{nacitajInfoEditorZapisy(){const e=t(7218);let a={method:"get",maxBodyLength:1/0,url:this.$store.state.api+"/noty/list.php"};e.request(a).then((e=>{"Request succesfull"==e.data.status&&(this.editorZoznam=e.data.data)})).catch((e=>{this.$store.state.SnackBarText="Nepodarilo sa načítať editor"}))},pridajSelect(e){""!==this.vybraneZapisy[e]&&e===this.vybraneZapisy.length-1&&this.vybraneZapisy.push("");while(""===this.vybraneZapisy[this.vybraneZapisy.length-1]&&""===this.vybraneZapisy[this.vybraneZapisy.length-2])this.vybraneZapisy.pop();const a=this.editorZoznam.filter((e=>this.vybraneZapisy.includes(e.id))).map((e=>e.stupnica?e.stupnica.charAt(0):""));this.stupnicePrepojenie=a},zapisanieZapisu(){this.upravovanieZapisu?this.upravenieZapisu():this.vytvorenieZapisu()},openFileInput(e){"Z"==e?-1!=this.selectedFilesSongStupnica.indexOf(e)&&this.clearSelectedFile(e):-1!=this.selectedFilesStupnica.indexOf(e)&&this.clearSelectedFile(e),this.$refs[`fileInput${e}`].value="",this.zapisyDetaily.stupnice.push(e)},handleFileChange(e,a){"Z"==e?(this.selectedFilesSong.push(a.target.files[0]),this.selectedFilesSongStupnica.push(e),this.selectedFileNames[e]=a.target.files[0].name):(this.selectedFiles.push(a.target.files[0]),this.selectedFilesStupnica.push(e),this.selectedFileNames[e]=a.target.files[0].name)},clearSelectedFile(e){this.selectedFileNames[e]="",this.upravovanieZapisu&&(this.zapisyDetaily.stupnice=this.zapisyDetaily.stupnice.filter((a=>a!==e))),"Z"==e?(this.selectedFilesSong.pop(),this.selectedFilesSongStupnica.pop()):(this.selectedFiles.splice(this.selectedFilesStupnica.indexOf(e),1),this.selectedFilesStupnica.splice(this.selectedFilesStupnica.indexOf(e),1))},vytvorenieZapisu(){if(this.podmienkyPreOdoslanie()){this.odosielanie=!0;const a=t(7218),i=t(6237);if(0==this.selectedFiles.length&&"pdf"==this.vyber)return this.$store.state.SnackBarText="Pre pridanie číselného zápisu je potrebné pridať aspoň jeden zápis",void(this.odosielanie=!1);if(0==this.selectedFilesSong.length)return this.$store.state.SnackBarText="Pre pridanie číselného zápisu je potrebné pridať zvukovú ukážku",void(this.odosielanie=!1);this.zapisyDetaily.stupnice=this.selectedFilesStupnica,this.zapisyDetaily.text=this.zapisyDetaily.text.replaceAll("\n","//n"),this.zapisyDetaily.info=this.zapisyDetaily.info.replaceAll("\n","//n");let s=JSON.stringify(this.zapisyDetaily);var e=this.zapisyData.nazov.normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/\s/g,"_").toLowerCase();this.zapisyData.cena.includes(",")&&(this.zapisyData.cena=this.zapisyData.cena.replace(",","."));let n=new i;if(n.append("virtuality",!0),n.append("free",this.zapisyData.registracnaPesnicka),n.append("new",86400*this.zapisyData.novinka),n.append("category",this.zapisyData.zaradenie),n.append("name",this.zapisyData.nazov),n.append("difficulty",this.zapisyData.obtiaznost),n.append("expiration","never"),n.append("price",this.zapisyData.cena),n.append("details",s),n.append("data","notes/"),"pdf"==this.vyber)for(let t=0;t<this.selectedFiles.length;t++)n.append("data_files[]",this.selectedFiles[t],e+"-"+this.selectedFilesStupnica[t]+".pdf");0!=this.selectedFilesSong.length&&n.append("details_files[]",this.selectedFilesSong[0],e+"-Z.mp3");let l={method:"post",maxBodyLength:1/0,url:this.$store.state.api+"/product/create.php/",headers:{"Content-Type":"multipart/form-data"},data:n};a.request(l).then((e=>{if("Request fullfiled"==e.data.status){if(this.$store.state.SnackBarText="Číselný zápis bol úspešne pridaný","prepojenie"==this.vyber)for(let e=0;e<this.vybraneZapisy.length;e++)this.stiahnutieNot(this.vybraneZapisy[e]);this.nacitanieUpravyPoVytvoreni()}else this.$store.state.SnackBarTex="Číselný zápis sa nepodarilo pridať",this.odosielanie=!1})).catch((e=>{this.$store.state.SnackBarText="Číselný zápis sa nepodarilo pridať",this.odosielanie=!1}))}},nacitanieUpravyPoVytvoreni(){const e=t(7218),a=t(6237);let i=new a,s={method:"get",maxBodyLength:1/0,url:this.$store.state.api+"/product/stats/listZapis.php",data:i};e.request(s).then((e=>{const a=e.data.data[e.data.data.length-1];this.$router.push({path:"/admin/pridanie-zapisu",query:{id:a.id}})})).catch((e=>{this.$store.state.SnackBarTex="Nepodarilo sa presmerovať na úpravu zápisu"}))},stiahnutieNot(e){const a=t(7218),i=t(6237);let s=new i,n={method:"get",maxBodyLength:1/0,url:this.$store.state.api+"/noty/load.php?id="+e,data:s};a.request(n).then((e=>{if("Request succesfull"==e.data.status){const a={id:e.data.data.id,data:JSON.parse(e.data.data.data),nazov:e.data.data.nazov,autor:e.data.data.autor,stupnica:e.data.data.stupnica,pocet_casti:e.data.data.pocet_casti,doby:e.data.data.pocet_dob,riadky:e.data.data.pocet_riadkov,text:e.data.data.text_piesne,pata:e.data.data.pata};this.upravitPrepojenieNot(a)}else this.$store.state.SnackBarTex="Pokazilo sa sťahovanie dát číselných zápisov pre prepojenie"})).catch((e=>{this.$store.state.SnackBarTex="Pokazilo sa sťahovanie dát číselných zápisov pre prepojenie"}))},upravitPrepojenieNot(e){const a=t(7218),i=t(6237);let s=new i;s.append("id",Number(e.id)),s.append("data",JSON.stringify(e.data)),s.append("nazov",e.nazov||"Číselný zápis"),s.append("autor",e.autor||"Neznámy autor"),s.append("stupnica",e.stupnica||"C dur"),s.append("pocet_casti",e.pocet_casti),s.append("pocet_dob",e.doby),s.append("pocet_riadkov",e.riadky),s.append("text_piesne",e.text||""),s.append("pata",e.pata||"Heligónková akadémia"),s.append("product_id",this.productID),(this.vybraneZapisyPred.includes(e.id)&&!this.vybraneZapisy.includes(e.id)||"pdf"==this.vyber&&this.vybraneZapisy.length>0)&&s.append("product_id",0);let n={method:"post",maxBodyLength:1/0,url:this.$store.state.api+"/noty/update.php",data:s};a.request(n).then((e=>{"Request fullfiled"==e.data.status||(this.$store.state.SnackBarText="Nepodarilo sa prepojiť číslený zápis")})).catch((e=>{this.$store.state.SnackBarText="Nepodarilo sa prepojiť číslený zápis"}))},upravenieZapisu(){if(this.podmienkyPreOdoslanie()){this.odosielanie=!0;const a=t(7218),i=t(6237);if((0==this.selectedFileNames.length||0==this.zapisyDetaily.stupnice.length)&&("pdf"==this.vyber||null==this.vyber))return this.$store.state.SnackBarText="Pre upravenie číselného zápisu je potrebné pridať aspoň jeden zápis",void(this.odosielanie=!1);this.zapisyDetaily.text=this.zapisyDetaily.text.replaceAll("\n","//n"),this.zapisyDetaily.info=this.zapisyDetaily.info.replaceAll("\n","//n");var e=this.zapisyData.nazov.normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/\s/g,"_").toLowerCase();this.zapisyData.cena.includes(",")&&(this.zapisyData.cena=this.zapisyData.cena.replace(",","."));let s=new i;if(s.append("id",this.$route.query.id),s.append("virtuality",!0),s.append("free",this.zapisyData.registracnaPesnicka),s.append("new",Math.floor((Date.now()+3456e5)/1e3)),s.append("category",this.zapisyData.zaradenie),s.append("name",this.zapisyData.nazov),s.append("difficulty",this.zapisyData.obtiaznost),s.append("expiration","never"),s.append("price",this.zapisyData.cena),s.append("deleted",!1),s.append("data",this.zapisyData.data),"pdf"==this.vyber)for(let t=0;t<this.selectedFiles.length;t++)s.append("data_files[]",this.selectedFiles[t],e+"-"+this.selectedFilesStupnica[t]+".pdf");0!=this.selectedFilesSong.length&&s.append("details_files[]",this.selectedFilesSong[0],e+"-Z.mp3"),this.zapisyDetaily.stupnice=[...new Set(this.zapisyDetaily.stupnice)];let n=null;"pdf"==this.vyber?n=[...this.zapisyDetaily.stupnice,...this.selectedFilesStupnica]:"prepojenie"==this.vyber&&(n=this.stupnicePrepojenie.slice()),this.zapisyDetaily.stupnice=[...new Set(n)];let l=JSON.stringify(this.zapisyDetaily);s.append("details",l);let p={method:"post",maxBodyLength:1/0,url:this.$store.state.api+"/product/update.php/",headers:{"Content-Type":"multipart/form-data"},data:s};a.request(p).then((e=>{if("Request fullfiled"==e.data.status){if(this.$store.state.SnackBarText="Číselný zápis bol úspešne upravený","prepojenie"==this.vyber){var a=[...new Set(this.vybraneZapisy.filter((e=>!this.vybraneZapisyPred.includes(e))))],t=[...new Set(this.vybraneZapisyPred.filter((e=>!this.vybraneZapisy.includes(e))))];for(let e=0;e<a.length;e++)this.stiahnutieNot(a[e]);for(let e=0;e<t.length;e++)this.stiahnutieNot(t[e])}else if("pdf"==this.vyber&&this.vybraneZapisy.length>0)for(let e=0;e<this.vybraneZapisy.length;e++)this.stiahnutieNot(this.vybraneZapisy[e]);this.odosielanie=!1}else this.$store.state.SnackBarTex="Číselný zápis sa nepodarilo upraviť",this.odosielanie=!1})).catch((e=>{this.$store.state.SnackBarText="Číselný zápis sa nepodarilo upraviť",this.odosielanie=!1}))}},podmienkyPreOdoslanie(){return""!==this.zapisyData.nazov.trim()&&""!==this.zapisyData.obtiaznost.trim()&&""!==this.zapisyData.cena.trim()&&""!==this.zapisyData.zaradenie.trim()&&""!==this.zapisyDetaily.autor.trim()&&""!==this.zapisyDetaily.tempo.trim()&&""!==this.zapisyDetaily.zaner.trim()&&""!==this.zapisyDetaily.urcenePre.trim()&&""!==this.zapisyDetaily.typ.trim()||(this.$store.state.SnackBarText="Nepodarilo sa vytvoriť zápis, pre odoslanie vyplňťe všetky polia",!1)},nacitajDataZapisu(){const e=t(7218);let a={method:"get",maxBodyLength:1/0,url:this.$store.state.api+"/product/load.php/?id="+this.$route.query.id};e.request(a).then((e=>{if("Request succesfull"==e.data.status){var a=e.data.data.details;let i=a.replace(/[\n\t]/g,""),s=JSON.parse(i);a=s,this.zapisyDetaily.autor=a.autor,this.zapisyData.nazov=e.data.data.name,this.zapisyData.obtiaznost=e.data.data.difficulty,this.zapisyData.cena=e.data.data.price,this.zapisyData.zaradenie=e.data.data.category,this.zapisyData.novinka=0,this.zapisyData.registracnaPesnicka=e.data.data.free,this.zapisyData.data=e.data.data.data,this.zapisyDetaily.autor=a.autor,this.zapisyDetaily.tempo=a.tempo,this.zapisyDetaily.zaner=a.zaner,this.zapisyDetaily.urcenePre=a.urcenePre,this.zapisyDetaily.typ=a.typ,this.zapisyDetaily.text=a.text.replaceAll("//n","\n"),this.zapisyDetaily.info=a.info.replaceAll("//n","\n"),this.zapisyDetaily.statistikakategoria=a.statistikakategoria,this.zapisyDetaily.stupnice=a.stupnice;var t=["F","C","G","D","A","B"];for(let e=0;e<t.length;e++)this.zapisyDetaily.stupnice.includes(t[e])&&(this.selectedFileNames[t[e]]=this.zapisyData.nazov.normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/\s/g,"_").toLowerCase()+"-"+t[e]+".pdf");this.selectedFileNames.Z=this.zapisyData.nazov.normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/\s/g,"_").toLowerCase()+".mp3",0==e.data.data.ciselne_zapisy.length?this.vyber="pdf":(this.vyber="prepojenie",this.vybraneZapisy=e.data.data.ciselne_zapisy,this.vybraneZapisyPred=this.vybraneZapisy.slice(),this.vybraneZapisy.push(""))}})).catch((e=>{}))},vymazZapis(e){if(confirm("Ste si istý že chcete stiahnuť s predaja číselný zápis?")){const a=t(7218),i=t(6237);let s=new i,n="";1==e&&(n="&permanent=true");let l={method:"get",maxBodyLength:1/0,url:this.$store.state.api+"/product/delete.php/?id="+this.$route.query.id+n,data:s};a.request(l).then((e=>{"Request fullfiled"==e.data.status?(this.$store.state.SnackBarText="Číselný zápis s názvom "+this.zapisyData.nazov+" bol stiahnutý z predaja",this.$router.go(-1)):this.$store.state.SnackBarText="Zápis: "+this.zapisyData.nazov+" sa nepodarilo osdtrániť z predaja"})).catch((e=>{}))}},resetujStupnice(e){this.stupnicePrepojenie=[],this.selectedFileNames=[],this.selectedFiles=[],this.vybraneZapisy=[""]}},watch:{vyber(e,a){null!==a&&this.resetujStupnice(e)}}},E=t(89);const J=(0,E.Z)(M,[["render",L],["__scopeId","data-v-3502f5a4"]]);var H=J},6789:function(e,a,t){e.exports=t.p+"img/nespravne.f7865d38.svg"},4970:function(e,a,t){e.exports=t.p+"img/zrusit.31ce29f1.svg"}}]);