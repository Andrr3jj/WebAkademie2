"use strict";(self["webpackChunkheligonkova_akademia"]=self["webpackChunkheligonkova_akademia"]||[]).push([[8550],{2954:function(t,a,e){e.r(a),e.d(a,{default:function(){return Nt}});var s=e(3396),i=e(7139);const o=["id"],n=["id"],l={class:"scroll",ref:"scrollContainer"},r=["id"],d={class:"scroll"},c=["id"],h={class:"scroll"};function u(t,a,e,u,p,m){const y=(0,s.up)("HeliHeader"),v=(0,s.up)("LeaderboardView"),k=(0,s.up)("LeaderboardMobile"),w=(0,s.up)("ModalSkeleton");return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s._)("section",{class:(0,i.C_)(["computer vyber",{hidden:p.isHidden,"display-none":p.isFullyHidden}]),id:t.$route.name,ref:"vyber"},[(0,s.Wm)(y,{userId:m.userId,cas:p.mojCas,umiestnenie:p.mojaPozicia,splnene:p.splneneUlohy,celkovoUloh:p.celkovyPocetUloh,onShowModal:m.openModal},null,8,["userId","cas","umiestnenie","splnene","celkovoUloh","onShowModal"])],10,o),(0,s._)("section",{class:"computer zapisy",id:t.$route.name+"1"},[(0,s._)("div",l,[(0,s.Wm)(v)],512)],8,n),(0,s._)("div",{id:t.$route.name,class:"mobile"},[(0,s._)("section",null,[(0,s._)("div",d,[(0,s.Wm)(y,{userId:m.userId,cas:p.mojCas,umiestnenie:p.mojaPozicia,splnene:p.splneneUlohy,celkovoUloh:p.celkovyPocetUloh,onShowModal:m.openModal},null,8,["userId","cas","umiestnenie","splnene","celkovoUloh","onShowModal"])])]),(0,s._)("section",{class:"zapisy",id:t.$route.name+"zapisimobil"},[(0,s._)("div",h,[(0,s.Wm)(k)])],8,c)],8,r),p.modalOpen?((0,s.wg)(),(0,s.j4)(w,{key:0,"content-component":p.modalComponent,"content-props":p.modalProps,onClose:a[0]||(a[0]=t=>p.modalOpen=!1)},null,8,["content-component","content-props"])):(0,s.kq)("",!0)],64)}const p={class:"heli-header"},m={class:"control"},y={class:"stats"},v={class:"your-stats"},k={class:"podnadpis"},w={class:"time-cubes"},g={class:"cube yellow"},_={class:"cube lite-green"},b={class:"cube green"},f={class:"podnadpis"},j={class:"body"},z={class:"position"},U={class:"podnadpis"},M={class:"tasks"},A={class:"task-item"},C={class:"goal"},H={class:"task-item second-item"};function $(t,a,e,o,n,l){return(0,s.wg)(),(0,s.iD)("div",p,[a[10]||(a[10]=(0,s._)("h1",null,[(0,s.Uk)(" Heli "),(0,s._)("br",{class:"br"}),(0,s.Uk)(" Čas ")],-1)),(0,s._)("div",m,[a[6]||(a[6]=(0,s._)("h5",null,"Učte sa, zbierajte body a získavajte odmeny!",-1)),a[7]||(a[7]=(0,s._)("div",{class:"line horizontal w-90"},null,-1)),(0,s._)("div",y,[(0,s._)("div",v,[(0,s._)("p",k,[a[2]||(a[2]=(0,s.Uk)(" Tvoj celkový čas: ")),(0,s._)("span",w,[(0,s._)("span",g,[(0,s._)("p",null,(0,i.zw)(e.cas?.dni??0),1)]),(0,s._)("span",_,[(0,s._)("p",null,(0,i.zw)(e.cas?.hodiny??0),1)]),(0,s._)("span",b,[(0,s._)("p",null,(0,i.zw)(e.cas?.minuty??0),1)])])]),(0,s._)("p",f,[a[3]||(a[3]=(0,s.Uk)(" Tvoj aktuálny stav bodov: ")),(0,s._)("span",j,[t.creditsLoading?((0,s.wg)(),(0,s.iD)(s.HY,{key:0},[(0,s.Uk)("...")],64)):t.creditsError?((0,s.wg)(),(0,s.iD)(s.HY,{key:1},[(0,s.Uk)("0")],64)):((0,s.wg)(),(0,s.iD)(s.HY,{key:2},[(0,s.Uk)((0,i.zw)(t.credits),1)],64))])])]),a[5]||(a[5]=(0,s._)("div",{class:"line vertical"},null,-1)),(0,s._)("div",z,[(0,s._)("p",U,[a[4]||(a[4]=(0,s.Uk)(" Moje umiestnenie: ")),(0,s._)("span",null,(0,i.zw)(l.displayUmiestnenie),1)])])])]),(0,s._)("div",M,[(0,s._)("div",A,[a[8]||(a[8]=(0,s._)("p",{class:"task"},"Splň úlohy a ziskaj bonusové body!",-1)),(0,s._)("button",{class:"button Adumu",onClick:a[0]||(a[0]=(...t)=>l.presmerujNaUlohy&&l.presmerujNaUlohy(...t))},"Úlohy")]),(0,s._)("p",C,"Splnené "+(0,i.zw)(n.splneneUloh)+"/"+(0,i.zw)(n.totalUloh),1),(0,s._)("div",H,[a[9]||(a[9]=(0,s._)("p",{class:"task"},"Získané body",-1)),(0,s._)("button",{class:"button Adumu",onClick:a[1]||(a[1]=(...t)=>l.otvorModal&&l.otvorModal(...t))},"Prehľad")])])])}e(560);var S=e(65);const P={class:"prehlad"},D={key:0,class:"loading"},N={key:1,class:"error"},I={key:2,class:"body-flex-table"},q={class:"cell popis"},W={key:0},T={class:"cell datum"},L={key:0,class:"body-row"};function Z(t,a,e,o,n,l){return(0,s.wg)(),(0,s.iD)("div",P,[a[3]||(a[3]=(0,s._)("h2",{class:"Bahnschrift"},"Prehľad bodov",-1)),a[4]||(a[4]=(0,s._)("p",{class:"sub Bahnschrift"}," Ktoré ste získali za učenie, hranie a plnenie úloh ",-1)),a[5]||(a[5]=(0,s._)("div",{class:"line horizontal"},null,-1)),n.isLoading?((0,s.wg)(),(0,s.iD)("div",D,"Načítavam...")):n.errorMessage?((0,s.wg)(),(0,s.iD)("div",N,(0,i.zw)(n.errorMessage),1)):((0,s.wg)(),(0,s.iD)("div",I,[a[2]||(a[2]=(0,s._)("div",{class:"body-row head"},[(0,s._)("div",{class:"cell popis"},"Získane/ využité body:"),(0,s._)("div",{class:"cell datum"},"Dátum získania:"),(0,s._)("div",{class:"cell pocet Bahnschrift"},"Počet:")],-1)),((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(n.body,((t,e)=>((0,s.wg)(),(0,s.iD)("div",{class:"body-row",key:e},[(0,s._)("div",q,["buy"===t.akcia?((0,s.wg)(),(0,s.iD)(s.HY,{key:0},[a[0]||(a[0]=(0,s.Uk)(" Nákup: ")),t.produkt?((0,s.wg)(),(0,s.iD)("span",W,(0,i.zw)(n.produktyMapa[t.produkt]?.nazov||n.produktyMapa[t.produkt]?.name||"#"+t.produkt),1)):(0,s.kq)("",!0)],64)):"bonus"===t.akcia?((0,s.wg)(),(0,s.iD)(s.HY,{key:1},[(0,s.Uk)(" Bonus ")],64)):"manual"===t.akcia?((0,s.wg)(),(0,s.iD)(s.HY,{key:2},[(0,s.Uk)(" Manuálne ")],64)):((0,s.wg)(),(0,s.iD)(s.HY,{key:3},[(0,s.Uk)(" Úloha: "+(0,i.zw)(t.akcia?t.akcia.charAt(0).toUpperCase()+t.akcia.slice(1):"-"),1)],64))]),(0,s._)("div",T,(0,i.zw)(t.datum||"-"),1),(0,s._)("div",{class:(0,i.C_)(["cell pocet",{plus:t.pocet>0,minus:t.pocet<0}])},(0,i.zw)(t.pocet>0?"+":"")+(0,i.zw)(t.pocet),3)])))),128)),n.body.length?(0,s.kq)("",!0):((0,s.wg)(),(0,s.iD)("div",L,a[1]||(a[1]=[(0,s._)("div",{class:"cell no-data",colspan:"3"},"Žiadne záznamy.",-1)])))]))])}var R={name:"PrehladUloh",props:{userId:{type:[String,Number],required:!0}},data(){return{body:[],isLoading:!1,errorMessage:"",produktyMapa:{}}},watch:{userId:{immediate:!0,handler(){this.loadHistory()}}},methods:{async loadHistory(){if(this.userId){this.isLoading=!0,this.errorMessage="",this.body=[];try{const t=`https://heligonkovaakademia.sk/api/helitime/getHelitimeHistory.php?id=${encodeURIComponent(this.userId)}`,a=await fetch(t,{credentials:"include"}),e=await a.json();let s=[];if(Array.isArray(e.data))s=e.data;else if("string"===typeof e.data&&e.data.trim())s=e.data.split("|").map((t=>t.trim())).filter(Boolean);else if(Array.isArray(e.history))s=e.history;else if(Array.isArray(e))s=e;else{const t=Object.values(e).find((t=>Array.isArray(t)));Array.isArray(t)&&(s=t)}this.body=s.map((t=>{const a=t.match(/^([0-9. :]+) -> (\w+)(?: product_id:(\d+))? credit_before:(\d+) credit_after:(\d+)$/);if(!a)return null;const e=a[1],s=a[2],i=a[3]??null,o=+a[4],n=+a[5],l=n-o;return{datum:e,akcia:s,produkt:i,pocet:l}})).filter(Boolean)}catch(t){this.errorMessage="Nepodarilo sa načítať históriu bodov."}finally{this.isLoading=!1}}},async nacitajProduktyMapu(){try{const t=e(7218),a=await t.get(`${this.$store.state.api}/product/search.php?details_key=typ&details_value=Zapis&pagination_limit=1000`),s=a.data.data||[];this.produktyMapa=Object.fromEntries(s.map((t=>[String(t.id),t])))}catch(t){this.produktyMapa={}}}},mounted(){this.nacitajProduktyMapu(),this.loadHistory()}},x=e(89);const O=(0,x.Z)(R,[["render",Z],["__scopeId","data-v-3e190b64"]]);var Y=O,B={name:"HeliHeader",props:{userId:{type:[String,Number],required:!0},cas:{type:Object,required:!0},body:{type:Number,required:!1,default:0},umiestnenie:{type:[Number,String],required:!1,default:null},splnene:{type:Number,default:0},celkovoUloh:{type:Number,default:40}},data(){return{showModal:!1,totalUloh:0,splneneUloh:0}},computed:{...(0,S.rn)("credits",{credits:t=>t.credits,creditsLoading:t=>t.loading,creditsError:t=>!!t.error}),modalComponent(){return Y},displayUmiestnenie(){return null===this.umiestnenie||void 0===this.umiestnenie||""===this.umiestnenie||"A"===this.umiestnenie||"number"===typeof this.umiestnenie&&isNaN(this.umiestnenie)?"neumiestnený":isNaN(Number(this.umiestnenie))||""===this.umiestnenie?this.umiestnenie:Number(this.umiestnenie)}},mounted(){this.nacitajStats(),null===this.credits&&this.$store.state.user?.id&&this.$store.dispatch("credits/fetchCredits")},methods:{async nacitajStats(){this.loadingStats=!0,this.statsError=!1;try{const t=await fetch("https://heligonkovaakademia.sk/api/achievements/getAchievementsStats.php",{credentials:"include"}),a=await t.json();this.totalUloh=a.data?.total??0,this.splneneUloh=a.data?.finished??0}catch(t){this.statsError=!0,this.totalUloh=0,this.splneneUloh=0}finally{this.loadingStats=!1}},presmerujNaUlohy(){this.$router.push("/ucebna/ulohy")},otvorModal(){this.$emit("show-modal",{component:Y,props:{userId:this.userId}})},zatvorModal(){this.showModal=!1}}};const E=(0,x.Z)(B,[["render",$],["__scopeId","data-v-38515e30"]]);var F=E;const K={class:"leaderboard-wrapper"},V={class:"top-players"},G={class:"table-wrapper"},J={key:0,class:"player-table"},Q={class:"player-info"},X={class:"rank"},tt=["src"],at={class:"name"},et={class:"stars-cell"},st={class:"tasks-cell"},it={class:"how-it-works"};function ot(t,a,e,o,n,l){const r=(0,s.up)("LeaderboardPlayerCard"),d=(0,s.up)("TimeCubes"),c=(0,s.up)("StarRating"),h=(0,s.up)("TaskCount");return(0,s.wg)(),(0,s.iD)("div",K,[a[4]||(a[4]=(0,s._)("h2",{class:"title"},"Rebríček najvytrvalejších hráčov",-1)),a[5]||(a[5]=(0,s._)("p",{class:"podnadpis"},"Kto trávi najviac času učením?",-1)),(0,s._)("div",V,[n.top3[1]?((0,s.wg)(),(0,s.j4)(r,{key:0,poradie:2,avatar:n.top3[1].avatar,meno:n.top3[1].meno,cas:l.formatCas(n.top3[1]),stars:n.top3[1].stars},null,8,["avatar","meno","cas","stars"])):(0,s.kq)("",!0),n.top3[0]?((0,s.wg)(),(0,s.j4)(r,{key:1,poradie:1,avatar:n.top3[0].avatar,meno:n.top3[0].meno,cas:l.formatCas(n.top3[0]),stars:n.top3[0].stars},null,8,["avatar","meno","cas","stars"])):(0,s.kq)("",!0),n.top3[2]?((0,s.wg)(),(0,s.j4)(r,{key:2,poradie:3,avatar:n.top3[2].avatar,meno:n.top3[2].meno,cas:l.formatCas(n.top3[2]),stars:n.top3[2].stars},null,8,["avatar","meno","cas","stars"])):(0,s.kq)("",!0)]),(0,s._)("div",G,[n.zobrazovani.length?((0,s.wg)(),(0,s.iD)("table",J,[a[1]||(a[1]=(0,s._)("thead",null,[(0,s._)("tr",null,[(0,s._)("th",null,"Názov účtu:"),(0,s._)("th",null,"Čas výučby:"),(0,s._)("th",null,"Hviezdy:"),(0,s._)("th",null,"Úlohy:")])],-1)),(0,s._)("tbody",null,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(n.zobrazovani,((t,a)=>((0,s.wg)(),(0,s.iD)("tr",{key:a},[(0,s._)("td",null,[(0,s._)("div",Q,[(0,s._)("span",X,(0,i.zw)(a+4)+".",1),(0,s._)("img",{src:t.avatar,alt:"Avatar",class:"avatar"},null,8,tt),(0,s._)("span",at,(0,i.zw)(t.meno),1)])]),(0,s._)("td",null,[(0,s.Wm)(d,{dni:t.dni,hodiny:t.hodiny,minuty:t.minuty},null,8,["dni","hodiny","minuty"])]),(0,s._)("td",et,[(0,s.Wm)(c,{stars:t.stars,dni:t.dni,hodiny:t.hodiny},null,8,["stars","dni","hodiny"])]),(0,s._)("td",st,[(0,s.Wm)(h,{count:t.ulohy},null,8,["count"])])])))),128))])])):(0,s.kq)("",!0)]),a[6]||(a[6]=(0,s._)("div",{class:"line horizontal"},null,-1)),(0,s._)("div",it,[a[2]||(a[2]=(0,s._)("h3",{class:"how-title"},"Ako to celé funguje?",-1)),a[3]||(a[3]=(0,s._)("p",{class:"how-description"}," Nevieš, ako funguje zbieranie bodov, odmeny a úlohy? Zisti všetko o systéme Heličas a nauč sa, ako za učenie získaš čo najviac! ",-1)),(0,s._)("button",{class:"button",onClick:a[0]||(a[0]=a=>t.$router.push("/ucebna/ako-funguje-helicas"))}," Zistiť viac ")])])}e(8858),e(1318),e(3228);var nt=e(1076),lt=e(492),rt=e(2108),dt=e(9624),ct=e(3973),ht={name:"LeaderboardView",components:{LeaderboardPlayerCard:lt.Z,TimeCubes:rt.Z,StarRating:dt.Z,TaskCount:ct.Z},data(){return{top3:[],zobrazovani:[],totalAchievements:0}},mounted(){this.nacitajTotalAchievements().then((()=>{this.nacitajData()}))},methods:{stripWWW(t){if(!t)return null;try{const a=new URL(t);return a.hostname.startsWith("www.")&&(a.hostname=a.hostname.slice(4)),a.toString()}catch{return t.replace(/^https?:\/\/www\./,(t=>t.replace("www.","")))}},async nacitajData(){try{const t=await nt["default"].get("https://heligonkovaakademia.sk/api/achievements/getTabulka.php");if("Request succesfull"===t.data.status){const a=Object.values(t.data.data||{});a.sort(((t,a)=>t.rank-a.rank));const e=a.map((t=>{const{dni:a,hodiny:e,minuty:s}=this.rozdelitMinuty(+t.helitime),i=`${(t.name||"").trim()} ${(t.surname||"").trim()}`.trim(),o=t.profilePhotoUrl?this.stripWWW(t.profilePhotoUrl):null;return{meno:i,avatar:o,dni:a,hodiny:e,minuty:s,stars:this.vypocitajHviezdy(a,e),ulohy:t.finishedAchievements||0}}));this.top3=e.slice(0,3),this.zobrazovani=e.slice(3)}}catch(t){}},async nacitajTotalAchievements(){try{const t=await nt["default"].get("https://heligonkovaakademia.sk/api/achievements/getAchievementsStats.php");"Request succesfull"===t.data.status&&(this.totalAchievements=+(t.data.totalAchievements??t.data.data?.total??t.data.data?.totalAchievements??0)||0)}catch(t){}},rozdelitMinuty(t){const a=Math.floor(t/1440),e=t%1440,s=Math.floor(e/60),i=e%60;return{dni:a,hodiny:s,minuty:i}},vypocitajHviezdy(t,a){const e=24*t+a;return e<8?0:e<24?1:1===t?2:t>=2&&t<5?3:t>=5&&t<10?4:5},formatCas({dni:t,hodiny:a,minuty:e}){const s=[];return 1===t?s.push("1 deň"):t>=2&&t<=4?s.push(`${t} dni`):t>=5&&s.push(`${t} dní`),1===a?s.push("1 hodina"):a>=2&&a<=4?s.push(`${a} hodiny`):a>=5&&s.push(`${a} hodín`),1===e?s.push("1 minúta"):e>=2&&e<=4?s.push(`${e} minúty`):e>=5&&s.push(`${e} minút`),s.join(" ")}}};const ut=(0,x.Z)(ht,[["render",ot],["__scopeId","data-v-61712153"]]);var pt=ut;const mt={class:"leaderboard-wrapper"},yt={class:"top-players"},vt={class:"table-wrapper"},kt={key:0,class:"player-table"},wt={class:"player-info"},gt={class:"rank"},_t=["src"],bt={class:"name"},ft={class:"info-column"},jt={class:"right"},zt={class:"right"},Ut={class:"right"},Mt={class:"how-it-works"};function At(t,a,e,o,n,l){const r=(0,s.up)("LeaderboardPlayerCard"),d=(0,s.up)("TimeCubes"),c=(0,s.up)("StarRating"),h=(0,s.up)("TaskCount");return(0,s.wg)(),(0,s.iD)("div",mt,[a[4]||(a[4]=(0,s._)("h2",{class:"title"},"Rebríček najvytrvalejších hráčov",-1)),a[5]||(a[5]=(0,s._)("p",{class:"podnadpis"},"Kto trávi najviac času učením?",-1)),(0,s._)("div",yt,[n.top3[0]?((0,s.wg)(),(0,s.j4)(r,{key:0,poradie:1,avatar:n.top3[0].avatar,meno:n.top3[0].meno,cas:l.formatCas(n.top3[0]),stars:n.top3[0].stars},null,8,["avatar","meno","cas","stars"])):(0,s.kq)("",!0),n.top3[1]?((0,s.wg)(),(0,s.j4)(r,{key:1,poradie:2,avatar:n.top3[1].avatar,meno:n.top3[1].meno,cas:l.formatCas(n.top3[1]),stars:n.top3[1].stars},null,8,["avatar","meno","cas","stars"])):(0,s.kq)("",!0),n.top3[2]?((0,s.wg)(),(0,s.j4)(r,{key:2,poradie:3,avatar:n.top3[2].avatar,meno:n.top3[2].meno,cas:l.formatCas(n.top3[2]),stars:n.top3[2].stars},null,8,["avatar","meno","cas","stars"])):(0,s.kq)("",!0)]),(0,s._)("div",vt,[n.ostatni.length?((0,s.wg)(),(0,s.iD)("table",kt,[a[1]||(a[1]=(0,s._)("thead",null,[(0,s._)("tr",null,[(0,s._)("th",null,"Hráč"),(0,s._)("th",null,"Informácie")])],-1)),(0,s._)("tbody",null,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(n.ostatni,((t,a)=>((0,s.wg)(),(0,s.iD)("tr",{key:a},[(0,s._)("td",null,[(0,s._)("div",wt,[(0,s._)("span",gt,(0,i.zw)(a+4)+".",1),(0,s._)("img",{src:t.avatar,alt:"Avatar",class:"avatar",loading:"lazy"},null,8,_t),(0,s._)("span",bt,(0,i.zw)(t.meno),1)])]),(0,s._)("td",ft,[(0,s._)("div",jt,[(0,s.Wm)(d,{dni:t.dni,hodiny:t.hodiny,minuty:t.minuty},null,8,["dni","hodiny","minuty"])]),(0,s._)("div",zt,[(0,s.Wm)(c,{stars:t.stars,dni:t.dni,hodiny:t.hodiny},null,8,["stars","dni","hodiny"])]),(0,s._)("div",Ut,[(0,s.Wm)(h,{count:t.ulohy},null,8,["count"])])])])))),128))])])):(0,s.kq)("",!0)]),a[6]||(a[6]=(0,s._)("div",{class:"line horizontal"},null,-1)),(0,s._)("div",Mt,[a[2]||(a[2]=(0,s._)("h3",{class:"how-title"},"Ako to celé funguje?",-1)),a[3]||(a[3]=(0,s._)("p",{class:"how-description"}," Nevieš, ako funguje zbieranie bodov, odmeny a úlohy? Zisti všetko o systéme Heličas a nauč sa, ako za učenie získaš čo najviac! ",-1)),(0,s._)("button",{class:"button",onClick:a[0]||(a[0]=a=>t.$router.push("/ucebna/ako-funguje-helicas"))}," Zistiť viac ")])])}e(3429);var Ct={name:"LeaderboardMobile",components:{LeaderboardPlayerCard:lt.Z,TimeCubes:rt.Z,StarRating:dt.Z,TaskCount:ct.Z},data(){return{top3:[],ostatni:[],totalAchievements:0}},mounted(){this.nacitajTotalAchievements().then((()=>{this.nacitajData()}))},methods:{stripWWW(t){if(!t)return null;try{const a=new URL(t);return a.hostname.startsWith("www.")&&(a.hostname=a.hostname.slice(4)),a.toString()}catch{return t.replace(/^https?:\/\/www\./,(t=>t.replace("www.","")))}},initialsFromName(t){const a=t.trim().split(/\s+/);return 0===a.length?"":1===a.length?a[0].slice(0,2).toUpperCase():(a[0][0]+a[1][0]).toUpperCase()},makeInitialsAvatar(t){const a=`<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32">\n        <rect width="100%" height="100%" fill="#ddd"/>\n        <text x="50%" y="50%" dominant-baseline="middle" text-anchor="middle"\n          font-family="Bahnschrift, Arial, sans-serif" font-size="14" fill="#555">${t}</text>\n      </svg>`,e="undefined"!==typeof btoa?btoa(a):window.btoa(a);return`data:image/svg+xml;base64,${e}`},async nacitajData(){try{const t=await nt["default"].get("https://heligonkovaakademia.sk/api/achievements/getTabulka.php");if("Request succesfull"===t.data.status){const a=Object.values(t.data.data||{});a.sort(((t,a)=>t.rank-a.rank));const e=a.map((t=>{const{dni:a,hodiny:e,minuty:s}=this.rozdelitMinuty(+t.helitime),i=`${(t.name||"").trim()} ${(t.surname||"").trim()}`.trim();let o=null;if(t.profilePhotoUrl)o=this.stripWWW(t.profilePhotoUrl);else{const t=this.initialsFromName(i);o=this.makeInitialsAvatar(t)}return{meno:i,avatar:o,dni:a,hodiny:e,minuty:s,stars:this.vypocitajHviezdy(a,e),ulohy:Math.max(this.totalAchievements-(t.finishedAchievements||0),0)}}));this.top3=e.slice(0,3),this.ostatni=e.slice(3)}}catch(t){}},async nacitajTotalAchievements(){try{const t=await nt["default"].get("https://heligonkovaakademia.sk/api/achievements/getAchievementsStats.php");"Request succesfull"===t.data.status&&(this.totalAchievements=+(t.data.totalAchievements??t.data.data?.total??t.data.data?.totalAchievements??0)||0)}catch(t){}},rozdelitMinuty(t){const a=Math.floor(t/1440),e=t%1440,s=Math.floor(e/60),i=e%60;return{dni:a,hodiny:s,minuty:i}},vypocitajHviezdy(t,a){const e=24*t+a;return e<8?0:e<24?1:1===t?2:t>=2&&t<5?3:t>=5&&t<10?4:5},formatCas({dni:t,hodiny:a,minuty:e}){const s=[];return 1===t?s.push("1 deň"):t>=2&&t<=4?s.push(`${t} dni`):t>=5&&s.push(`${t} dní`),1===a?s.push("1 hodina"):a>=2&&a<=4?s.push(`${a} hodiny`):a>=5&&s.push(`${a} hodín`),1===e?s.push("1 minúta"):e>=2&&e<=4?s.push(`${e} minúty`):e>=5&&s.push(`${e} minút`),s.join(" ")}}};const Ht=(0,x.Z)(Ct,[["render",At],["__scopeId","data-v-0d6a408a"]]);var $t=Ht,St=e(4015),Pt={components:{HeliHeader:F,LeaderboardView:pt,LeaderboardMobile:$t,ModalSkeleton:St.Z},data(){return{data:{},mojaPozicia:0,mojCas:{dni:0,hodiny:0,minuty:0},splneneUlohy:10,celkovyPocetUloh:40,isHidden:!1,isFullyHidden:!1,hasScrolledPast:!1,scrollThreshold:300,showThreshold:10,modalOpen:!1,modalComponent:null,modalProps:{}}},computed:{userId(){return this.$store?.state?.user?.id||""}},mounted(){window.scrollTo(0,0),this.nacitajData(),this.celkoveHranie(),this.nacitajAchievementsStats(),this.nacitajSplneneAchievements(),this.nacitajMojuPoziciu(),this.$nextTick((()=>{const t=this.$refs.scrollContainer;t&&t.addEventListener("scroll",this.handleScroll)}))},beforeUnmount(){const t=this.$refs.scrollContainer;t&&t.removeEventListener("scroll",this.handleScroll)},methods:{handleScroll(t){const a=t.target.scrollTop;a>this.scrollThreshold&&!this.hasScrolledPast?(this.isHidden=!0,this.hasScrolledPast=!0,setTimeout((()=>{this.isHidden&&(this.isFullyHidden=!0)}),100)):a<this.showThreshold&&this.hasScrolledPast&&(this.isHidden=!1,this.hasScrolledPast=!1,this.isFullyHidden=!1)},openModal({component:t,props:a}){this.modalComponent=t,this.modalProps=a||{},this.modalOpen=!0},async nacitajData(){try{const t={method:"get",maxBodyLength:1/0,url:this.$store.state.api+"/user/stats/getUsersWatchtime.php/"},a=await nt["default"].request(t);if("Request succesfull"===a.data.status){this.data=a.data.data;const t=Object.entries(this.data).sort(((t,a)=>a[1]-t[1])),e={};t.forEach((([t,a])=>{e[t]=a})),this.data=e,this.zistiMojuPoziciu()}}catch(t){}},zistiMojuPoziciu(){const t=(this.$store.state.user.name+" "+this.$store.state.user.surname).trim(),a=Object.entries(this.data),e=a.findIndex((([a])=>a.trim()===t));this.mojaPozicia=-1===e?"neumiestnený":e+1},async nacitajAchievementsStats(){try{const t=await nt["default"].get("https://heligonkovaakademia.sk/api/achievements/getAchievementsStats.php");"Request succesfull"===t.data.status&&(this.celkovyPocetUloh=+t.data.data.total||0)}catch(t){}},async nacitajSplneneAchievements(){try{const t=await nt["default"].get("https://heligonkovaakademia.sk/api/achievements/getAchievements.php",{params:{userId:this.userId}});if("Request succesfull"===t.data.status){const a=t.data.data.finished,e=t.data.position;this.splneneUlohy="number"===typeof a?a:0,e&&(this.mojaPozicia=e)}}catch(t){}},async nacitajMojuPoziciu(){try{const t=await nt["default"].get("https://heligonkovaakademia.sk/api/achievements/getRank.php",{params:{userId:this.userId}});if("Request succesfull"===t.data.status){const a=t.data.data;this.mojaPozicia=isNaN(a)?a:Number(a)}}catch(t){}},async celkoveHranie(){try{const t={method:"get",maxBodyLength:1/0,url:this.$store.state.api+"/user/stats/getUserWatchtime.php"},a=await nt["default"].request(t);if("Request succesfull"===a.data.status&&a.data.data){const t=(this.$store.state.user.name+" "+this.$store.state.user.surname).trim(),e=Number(a.data.data[t]);isNaN(e)||(this.mojCas=this.rozdelitMinuty(e))}}catch(t){}},rozdelitMinuty(t){const a=Math.floor(t/1440),e=t%1440,s=Math.floor(e/60),i=e%60;return{dni:a,hodiny:s,minuty:i}}}};const Dt=(0,x.Z)(Pt,[["render",u],["__scopeId","data-v-09f642a8"]]);var Nt=Dt}}]);