"use strict";(self["webpackChunkheligonkova_akademia"]=self["webpackChunkheligonkova_akademia"]||[]).push([[9171],{1164:function(e,t,o){o.d(t,{Z:function(){return d}});var i=o(3396),n=o(7139);function a(e,t,o,a,s,r){return(0,i.wg)(),(0,i.iD)("span",{class:"sort-arrow",onClick:t[0]||(t[0]=(...e)=>r.toggleSort&&r.toggleSort(...e))},[((0,i.wg)(),(0,i.iD)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"0.7em",height:"0.7em",viewBox:"0 0 14 12",class:(0,n.C_)(["triangle-icon",r.rotationClass])},t[1]||(t[1]=[(0,i._)("path",{d:"M13.7814 2.28223C14.0658 1.81973 14.0752 1.23848 13.8095 0.766602C13.5439 0.294727 13.0439 0.000976574 12.5002 0.000976581L1.50015 0.000976612C0.956406 0.000976612 0.454801 0.294727 0.190776 0.766602C-0.0748491 1.23848 0.0623493 1.81973 0.218901 2.28223L5.7189 11.2822C5.99786 11.7917 6.47515 12.0015 7.00015 12.001C7.52515 12.001 8.0064 11.7291 8.2814 11.2822L13.7814 2.28223Z",fill:"black"},null,-1)]),2))])}var s={props:{column:String,sortKey:String,sortDirection:String},computed:{rotationClass(){return this.sortKey!==this.column?"neutral":"asc"===this.sortDirection?"rotate":""}},methods:{toggleSort(){let e="asc";this.sortKey===this.column&&"asc"===this.sortDirection?e="desc":this.sortKey===this.column&&"desc"===this.sortDirection&&(e=""),this.$emit("update:sort",{key:e?this.column:"",direction:e})}}},r=o(89);const l=(0,r.Z)(s,[["render",a],["__scopeId","data-v-93cbcb14"]]);var d=l},906:function(e,t,o){o.d(t,{Z:function(){return k}});var i=o(3396),n=o(9242),a=o(7139);const s={class:"modal-content base-modal"},r={class:"modal-scroll"},l={key:0,class:"no-folders"},d={key:1,class:"folders-list"},c=["onUpdate:modelValue","id"],h=["for"],u={class:"dialog-actions"},m=["disabled"],p={key:2,class:"error"},w={key:3,class:"success"};function v(e,t,o,v,f,y){const g=(0,i.up)("TheMenu");return(0,i.wg)(),(0,i.j4)(i.lR,{to:"body"},[(0,i._)("div",{class:"overlay",onClick:t[3]||(t[3]=(0,n.iM)((t=>e.$emit("close")),["self"]))},[(0,i._)("div",{class:"modal-overlay",onClick:t[2]||(t[2]=(0,n.iM)((t=>e.$emit("close")),["self"]))},[(0,i._)("div",s,[(0,i._)("div",r,[(0,i._)("h2",null,"Pridať „"+(0,a.zw)(o.item.nazov)+"“ do priečinka",1),0===f.localFolders.length?((0,i.wg)(),(0,i.iD)("div",l," Žiadne dostupné priečinky. ")):((0,i.wg)(),(0,i.iD)("div",d,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(f.localFolders,((e,t)=>((0,i.wg)(),(0,i.iD)("div",{class:"folder-row",key:e.name},[(0,i.wy)((0,i._)("input",{type:"checkbox","onUpdate:modelValue":e=>f.localFolders[t].checked=e,id:"folder-"+t},null,8,c),[[n.e8,f.localFolders[t].checked]]),(0,i._)("label",{for:"folder-"+t},(0,a.zw)(e.name),9,h)])))),128))])),(0,i._)("div",u,[(0,i._)("button",{onClick:t[0]||(t[0]=t=>e.$emit("close")),class:"cancel"},"Zrušiť"),(0,i._)("button",{onClick:t[1]||(t[1]=(...e)=>y.confirm&&y.confirm(...e)),disabled:!y.hasSelected||f.loading,class:"confirm"}," Pridať ",8,m)]),f.error?((0,i.wg)(),(0,i.iD)("div",p,(0,a.zw)(f.error),1)):(0,i.kq)("",!0),f.success?((0,i.wg)(),(0,i.iD)("div",w,(0,a.zw)(f.success),1)):(0,i.kq)("",!0)])])]),(0,i.Wm)(g,{class:"fake-menu",style:{margin:"0 1em",opacity:"0","z-index":"-1","pointer-events":"none"}})])])}var f=o(3239),y=o(1076),g={components:{TheMenu:f.Z},props:{item:{type:Object,required:!0},folders:{type:Array,required:!0}},data(){return{loading:!1,error:"",success:"",localFolders:[]}},computed:{hasSelected(){return this.localFolders.some((e=>e.checked))}},watch:{folders:{handler(e){this.localFolders=e.map((e=>({name:e.name,checked:e.checked||!1})))},immediate:!0,deep:!0}},methods:{async confirm(){this.loading=!0,this.error="";try{await Promise.all(this.localFolders.map((e=>{const t=`${this.$store.state.api}/folder/${e.checked?"add.php":"remove.php"}`,o=new FormData;return o.append("id",this.item.id),o.append("name",e.name),y["default"].post(t,o)}))),this.$emit("done"),this.$emit("close")}catch{this.error="Chyba pri aktualizácii priečinkov."}finally{this.loading=!1}}}},C=o(89);const F=(0,C.Z)(g,[["render",v],["__scopeId","data-v-3f609a70"]]);var k=F},9171:function(e,t,o){o.r(t),o.d(t,{default:function(){return ie}});var i=o(3396),n=o(9242),a=o(7139),s=o(3139);const r=["id"],l={class:"scroll"},d={style:{width:"30%"}},c={style:{width:"15%"}},h={style:{width:"20%","text-align":"center"}},u={style:{width:"15%"}},m={style:{width:"10%"}},p=["onContextmenu"],w={style:{"text-align":"center"}},v={style:{"text-align":"center"}},f=["src"],y={class:"button-container"},g=["onClick"],C=["onClick"],F={key:0},k={colspan:"6",style:{"text-align":"center","vertical-align":"middle",height:"200px"}},A={class:"search"};function x(e,t,x,D,M,S){const b=(0,i.up)("FolderList"),z=(0,i.up)("ConfirmDialog"),H=(0,i.up)("SortArrow"),T=(0,i.up)("AddToFolderDialog");return(0,i.wg)(),(0,i.iD)("section",{id:e.$route.name},[(0,i._)("div",l,[t[18]||(t[18]=(0,i._)("h1",null,"Administratívny systém",-1)),t[19]||(t[19]=(0,i._)("h5",null,"Zoznam vytvorených číselných zápisov",-1)),t[20]||(t[20]=(0,i._)("div",{class:"line horizontal w-80"},null,-1)),(0,i._)("div",{ref:"folderContext",onContextmenu:t[0]||(t[0]=(0,n.iM)(((...e)=>S.openGlobalContextMenu&&S.openGlobalContextMenu(...e)),["prevent"])),style:{position:"relative"}},[(0,i.Wm)(b,{folders:M.folders,selected:M.selectedFolder,authors:M.authors,selectedAuthor:M.selectedAuthor,creatingNewFolder:M.creatingNewFolder,renamingFolder:M.renamingFolder,onSelect:S.onSelectFolder,onSelectAuthor:S.selectAuthor,onConfirmNewFolder:S.finalizeNewFolder,onCancelNewFolder:S.cancelNewFolder,onRenameFolder:S.startRenameFolder,onDeleteFolder:S.deleteFolder,onCloseGlobalContext:S.closeGlobalContextMenu},null,8,["folders","selected","authors","selectedAuthor","creatingNewFolder","renamingFolder","onSelect","onSelectAuthor","onConfirmNewFolder","onCancelNewFolder","onRenameFolder","onDeleteFolder","onCloseGlobalContext"])],544),(0,i.Wm)(z,{visible:M.showDeleteDialog,title:"Vymazať priečinok?",message:M.folderToDelete?`Naozaj chcete vymazať priečinok „${M.folderToDelete.name}“?`:"",onCancel:t[1]||(t[1]=e=>M.showDeleteDialog=!1),onConfirm:S.confirmDeleteFolder},null,8,["visible","message","onConfirm"]),((0,i.wg)(),(0,i.j4)(i.lR,{to:"body"},[M.globalContextMenu.visible?((0,i.wg)(),(0,i.iD)("div",{key:0,class:"context-menu",style:(0,a.j5)({position:"fixed",top:M.globalContextMenu.y+"px",left:M.globalContextMenu.x+"px"})},[(0,i._)("div",{class:"menu-item",onClick:t[2]||(t[2]=(...e)=>S.addFolderInline&&S.addFolderInline(...e))}," Vytvoriť priečinok ")],4)):(0,i.kq)("",!0)])),t[21]||(t[21]=(0,i._)("div",{class:"line horizontal w-80"},null,-1)),(0,i._)("table",null,[(0,i._)("thead",null,[(0,i._)("tr",null,[(0,i._)("th",d,[t[9]||(t[9]=(0,i.Uk)(" Názov pesničky: ")),(0,i.Wm)(H,{column:"nazov",sortKey:M.sortKey,sortDirection:M.sortDirection,"onUpdate:sort":S.updateSort},null,8,["sortKey","sortDirection","onUpdate:sort"])]),(0,i._)("th",c,[t[10]||(t[10]=(0,i.Uk)(" Stupnica: ")),(0,i.Wm)(H,{column:"stupnica",sortKey:M.sortKey,sortDirection:M.sortDirection,"onUpdate:sort":S.updateSort},null,8,["sortKey","sortDirection","onUpdate:sort"])]),(0,i._)("th",h,[t[11]||(t[11]=(0,i.Uk)(" Autor: ")),(0,i.Wm)(H,{column:"autor",sortKey:M.sortKey,sortDirection:M.sortDirection,"onUpdate:sort":S.updateSort},null,8,["sortKey","sortDirection","onUpdate:sort"])]),(0,i._)("th",u,[t[12]||(t[12]=(0,i.Uk)(" Vytvorené: ")),(0,i.Wm)(H,{column:"datum_vytvorenia",sortKey:M.sortKey,sortDirection:M.sortDirection,"onUpdate:sort":S.updateSort},null,8,["sortKey","sortDirection","onUpdate:sort"])]),(0,i._)("th",m,[t[13]||(t[13]=(0,i.Uk)(" Aktívne: ")),(0,i.Wm)(H,{column:"stav_aktivne",sortKey:M.sortKey,sortDirection:M.sortDirection,"onUpdate:sort":S.updateSort},null,8,["sortKey","sortDirection","onUpdate:sort"])]),t[14]||(t[14]=(0,i._)("th",{style:{width:"10%"}},null,-1))])]),(0,i._)("tbody",null,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(S.sortedData,((e,s)=>((0,i.wg)(),(0,i.iD)("tr",{key:e.id||s,onContextmenu:(0,n.iM)((t=>S.openRowContextMenu(t,e)),["prevent"])},[(0,i._)("td",null,(0,a.zw)(e.nazov),1),(0,i._)("td",null,(0,a.zw)(e.stupnica),1),(0,i._)("td",w,(0,a.zw)(e.autor),1),(0,i._)("td",null,(0,a.zw)(S.formatDatum(e.timestamp)),1),(0,i._)("td",v,[(0,i._)("img",{src:e.stav_aktivne?o(3073):o(5575),alt:"stav",style:{width:"18px",height:"18px"}},null,8,f)]),(0,i._)("td",y,[(0,i._)("div",{onClick:t=>S.upravenieZapisu(e.id),class:"button"},t[15]||(t[15]=[(0,i._)("a",null,"Upraviť",-1)]),8,g),(0,i._)("div",{class:(0,a.C_)([{"not-have-permission":!this.$store.state.userRoles?.roles?.includes("record_delete")},"button red-button"]),onClick:t=>S.vymazanieZapisu(e.id),title:"Vymazať"},t[16]||(t[16]=[(0,i._)("a",null,"x",-1)]),10,C)])],40,p)))),128)),0===S.sortedData.length?((0,i.wg)(),(0,i.iD)("tr",F,[(0,i._)("td",k,(0,a.zw)(S.noResultsMessage),1)])):(0,i.kq)("",!0)])]),((0,i.wg)(),(0,i.j4)(i.lR,{to:"body"},[M.rowContextMenu.visible?((0,i.wg)(),(0,i.iD)("div",{key:0,class:"context-menu",style:(0,a.j5)({position:"fixed",top:M.rowContextMenu.y+"px",left:M.rowContextMenu.x+"px",zIndex:3e3}),onMousedown:t[5]||(t[5]=(0,n.iM)((()=>{}),["stop"]))},[(0,i._)("div",{class:"menu-item",onClick:t[3]||(t[3]=e=>S.addToFolder(M.rowContextMenu.item))}," Pridať do priečinka "),(0,i._)("div",{class:"menu-item",onClick:t[4]||(t[4]=e=>S.removeFromFolder(M.rowContextMenu.item))}," Odstrániť z priečinka ")],36)):(0,i.kq)("",!0)])),M.showAddToFolderModal?((0,i.wg)(),(0,i.j4)(T,{key:0,item:M.addToFolderItem,folders:M.addToFolderFolders,onClose:t[6]||(t[6]=e=>M.showAddToFolderModal=!1),onConfirm:S.handleAddToFolderConfirm,onDone:S.onAddToFolderDone},null,8,["item","folders","onConfirm","onDone"])):(0,i.kq)("",!0),(0,i._)("div",A,[t[17]||(t[17]=(0,i._)("img",{src:s,alt:"Vyhladanie"},null,-1)),(0,i.wy)((0,i._)("input",{onInput:t[7]||(t[7]=(...e)=>S.oneskoreneVyhladavanie&&S.oneskoreneVyhladavanie(...e)),type:"text",placeholder:"Vyhľadať pieseň","onUpdate:modelValue":t[8]||(t[8]=e=>M.search=e)},null,544),[[n.nr,M.search]])])])],8,r)}o(560);var D=o(1164),M=o(906);const S={class:"confirm-dialog"},b={class:"confirm-dialog-title"},z={class:"confirm-dialog-message"},H={class:"confirm-dialog-actions"};function T(e,t,o,s,r,l){return(0,i.wg)(),(0,i.j4)(i.lR,{to:"body"},[o.visible?((0,i.wg)(),(0,i.iD)("div",{key:0,class:"confirm-dialog-overlay",onClick:t[2]||(t[2]=(0,n.iM)(((...e)=>l.onCancel&&l.onCancel(...e)),["self"]))},[(0,i._)("div",S,[(0,i._)("div",b,(0,a.zw)(o.title),1),(0,i._)("div",z,(0,a.zw)(o.message),1),(0,i._)("div",H,[(0,i._)("button",{class:"button",onClick:t[0]||(t[0]=(...e)=>l.onCancel&&l.onCancel(...e))},"Zrušiť"),(0,i._)("button",{class:"button red",onClick:t[1]||(t[1]=(...e)=>l.onConfirm&&l.onConfirm(...e))},"Vymazať")])])])):(0,i.kq)("",!0)])}var _={name:"ConfirmDialog",props:{visible:Boolean,title:{type:String,default:"Potvrdenie"},message:String},emits:["confirm","cancel"],methods:{onCancel(){this.$emit("cancel")},onConfirm(){this.$emit("confirm")}}},N=o(89);const $=(0,N.Z)(_,[["render",T],["__scopeId","data-v-03b795bb"]]);var V=$;const I={class:"folder-wrapper"},R={key:0,class:"author-list"},E=["onClick"],Z=["onClick"],B=["onClick","onContextmenu"],K={key:0,xmlns:"http://www.w3.org/2000/svg",width:"80",height:"60",viewBox:"0 0 122 92",fill:"none",class:"folder-icon"},L={key:1,xmlns:"http://www.w3.org/2000/svg",width:"80",height:"60",viewBox:"0 0 122 92",fill:"none",class:"folder-icon"},U={key:2,class:"folder-count"},j={class:"folder-name"},O=["value","onKeyup","onBlur"],P=["onUpdate:modelValue","onKeyup","onBlur"],Q={key:1,class:"folder-item empty"},W={class:"add-button-wrapper"},Y={class:"button vytvorenie-zapisu"};function q(e,t,o,s,r,l){const d=(0,i.up)("router-link");return(0,i.wg)(),(0,i.iD)("div",I,[o.authors&&o.authors.length?((0,i.wg)(),(0,i.iD)("div",R,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(o.authors,(t=>((0,i.wg)(),(0,i.iD)("div",{key:t.name,class:"author-tile"},[(0,i._)("strong",{class:(0,a.C_)({active:o.selectedAuthor===t.name&&!e.showInactiveOnly,pressed:o.selectedAuthor===t.name&&!e.showInactiveOnly}),onClick:(0,n.iM)((o=>e.$emit("select-author",{name:t.name,inactiveOnly:!1})),["stop"]),style:{cursor:"pointer"}},(0,a.zw)(t.name)+": "+(0,a.zw)(t.total),11,E),(0,i._)("strong",{class:(0,a.C_)(["inactive",{active:o.selectedAuthor===t.name&&e.showInactiveOnly,pressed:o.selectedAuthor===t.name&&e.showInactiveOnly}]),onClick:(0,n.iM)((o=>e.$emit("select-author",{name:t.name,inactiveOnly:!0})),["stop"]),style:{"margin-left":"2px",cursor:"pointer"}}," (Neaktívnych: "+(0,a.zw)(t.inactive)+") ",11,Z)])))),128))])):(0,i.kq)("",!0),(0,i._)("div",{class:(0,a.C_)(["folder-list",{"grid-wrap":l.showHover&&r.showAllFolders,"disabled-hover":!l.showHover}]),onMouseenter:t[0]||(t[0]=(...e)=>l.onMouseEnter&&l.onMouseEnter(...e)),onMouseleave:t[1]||(t[1]=(...e)=>l.onMouseLeave&&l.onMouseLeave(...e))},[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(l.paddedFolders,((s,d)=>((0,i.wg)(),(0,i.iD)(i.HY,{key:s?s.isNew?"new-folder-"+d:s.name:"empty-"+d},[s?((0,i.wg)(),(0,i.iD)("div",{key:0,class:(0,a.C_)(["folder-item",{active:s.name===o.selected,highlight:"Všetko"===s.name,"new-folder":s.isNew}]),onClick:t=>e.$emit("select",s.name),onContextmenu:(0,n.iM)((e=>l.openContextMenu(e,s)),["prevent"])},[s.name===o.selected?((0,i.wg)(),(0,i.iD)("svg",K,t[5]||(t[5]=[(0,i.uE)('<path d="M114.618 92C118.72 92 122 88.5974 122 84.5302V3.86257C122 1.72946 120.256 0 118.105 0H70.9596C68.8085 0 67.0645 1.72946 67.0645 3.86257V5.09922H20.9872C18.8361 5.09922 17.0921 6.82868 17.0921 8.9618V17.7232C17.0921 17.7232 81.5596 92 114.618 92Z" fill="#00913F" data-v-191c1e76></path><path d="M107.121 84.6228H113.782C114.212 84.6228 114.561 84.277 114.561 83.8505V12.8136C114.561 12.3872 114.212 12.0413 113.782 12.0413H25.2575C24.8274 12.0413 24.4786 12.3872 24.4786 12.8136V17.7224L107.121 84.6228Z" fill="white" data-v-191c1e76></path><path d="M-0.000236511 21.585V84.6228C-0.000236511 88.6965 3.32957 91.9999 7.43899 91.9999H114.561C110.453 91.9999 107.121 88.6972 107.121 84.6228V21.585C107.121 19.4512 105.377 17.7224 103.226 17.7224H3.89413C1.74306 17.7224 -0.000236511 19.4512 -0.000236511 21.585Z" fill="#90CA50" data-v-191c1e76></path><path d="M0.000484467 21.585V84.6228C0.000484467 88.6965 3.3303 91.9999 7.4397 91.9999H53.2617C46.9746 91.3624 40.7141 90.4723 34.5004 89.3298C28.1507 88.1623 21.4688 86.5313 16.9595 81.9484C13.9483 78.8874 12.2165 74.7688 11.3643 70.5768C10.5113 66.3847 10.4747 62.0771 10.4416 57.8009C10.3373 44.4409 10.233 31.0824 10.128 17.7224H3.8963C1.74522 17.7224 0.00120544 19.4512 0.00120544 21.585H0.000484467Z" fill="#00913F" data-v-191c1e76></path><path d="M101.162 37.5987V26.3547C101.162 25.1402 100.169 24.1553 98.9442 24.1553H71.9043C71.3865 24.1553 71.3117 24.8963 71.8195 24.9982L78.5791 26.3533C86.6044 27.9622 93.8049 32.2185 99.0391 38.3739C99.7611 39.2233 101.161 38.7091 101.161 37.598Z" fill="#FFE45F" data-v-191c1e76></path>',5)]))):((0,i.wg)(),(0,i.iD)("svg",L,t[6]||(t[6]=[(0,i.uE)('<path d="M114.618 92C118.72 92 122 88.5974 122 84.5302V3.86257C122 1.72946 120.256 0 118.105 0H70.9596C68.8085 0 67.0645 1.72946 67.0645 3.86257V5.09922H20.9872C18.8361 5.09922 17.0921 6.82868 17.0921 8.9618V17.7232C17.0921 17.7232 81.5596 92 114.618 92Z" fill="#F4AB2A" data-v-191c1e76></path><path d="M107.121 84.6228H113.782C114.212 84.6228 114.561 84.2769 114.561 83.8505V12.8136C114.561 12.3872 114.212 12.0413 113.782 12.0413H25.2575C24.8274 12.0413 24.4786 12.3872 24.4786 12.8136V17.7224L107.121 84.6228Z" fill="white" data-v-191c1e76></path><path d="M-0.000221252 21.585V84.6228C-0.000221252 88.6965 3.32959 91.9999 7.439 91.9999H114.561C110.453 91.9999 107.121 88.6972 107.121 84.6228V21.585C107.121 19.4512 105.377 17.7224 103.226 17.7224H3.89415C1.74307 17.7224 -0.000938416 19.4512 -0.000938416 21.585H-0.000221252Z" fill="#F9C32D" data-v-191c1e76></path><path d="M0.000484467 21.585V84.6228C0.000484467 88.6965 3.3303 91.9999 7.4397 91.9999H53.2617C46.9746 91.3624 40.7141 90.4723 34.5004 89.3298C28.1507 88.1623 21.4688 86.5313 16.9595 81.9484C13.9483 78.8874 12.2165 74.7688 11.3643 70.5768C10.5113 66.3847 10.4747 62.0771 10.4416 57.8009C10.3373 44.4409 10.233 31.0824 10.128 17.7224H3.8963C1.74522 17.7224 0.00120544 19.4512 0.00120544 21.585H0.000484467Z" fill="#F4AB2A" data-v-191c1e76></path><path d="M101.162 37.5987V26.3547C101.162 25.1402 100.169 24.1553 98.9442 24.1553H71.9043C71.3865 24.1553 71.3117 24.8963 71.8195 24.9982L78.5791 26.3533C86.6044 27.9622 93.8049 32.2185 99.0391 38.3739C99.7611 39.2233 101.161 38.7091 101.161 37.598Z" fill="#FFE45F" data-v-191c1e76></path>',5)]))),s.isNew?(0,i.kq)("",!0):((0,i.wg)(),(0,i.iD)("div",U,(0,a.zw)(s.count),1)),(0,i._)("div",j,[r.renamingFolder===s?((0,i.wg)(),(0,i.iD)("input",{key:0,class:"folder-rename-input",value:s.name,onKeyup:[(0,n.D2)((e=>l.confirmRename(s,e)),["enter"]),(0,n.D2)((t=>e.cancelRename(s)),["esc"])],onBlur:e=>l.confirmRename(s,e),autofocus:"",style:{"font-size":"16px","text-align":"center"}},null,40,O)):s.isNew?(0,i.wy)(((0,i.wg)(),(0,i.iD)("input",{key:1,"onUpdate:modelValue":e=>s.name=e,onKeyup:[(0,n.D2)((e=>l.confirmFolder(s,e)),["enter"]),(0,n.D2)((t=>e.$emit("cancel-new-folder",s)),["esc"])],onBlur:e=>l.confirmFolder(s,e),placeholder:"Nový priečinok",ref_for:!0,ref:"newFolderInput",autofocus:"",style:{"font-size":"16px","text-align":"center"}},null,40,P)),[[n.nr,s.name]]):((0,i.wg)(),(0,i.iD)(i.HY,{key:2},[(0,i.Uk)((0,a.zw)(s.name),1)],64))])],42,B)):((0,i.wg)(),(0,i.iD)("div",Q))],64)))),128))],34),(0,i._)("div",W,[(0,i._)("div",Y,[(0,i.Wm)(d,{to:"/admin/vytvorenie-zapisu"},{default:(0,i.w5)((()=>t[7]||(t[7]=[(0,i.Uk)("Pridať zápis")]))),_:1,__:[7]})])]),((0,i.wg)(),(0,i.j4)(i.lR,{to:"body"},[r.contextMenu.visible?((0,i.wg)(),(0,i.iD)("div",{key:0,class:"context-menu",style:(0,a.j5)({position:"fixed",top:r.contextMenu.y+"px",left:r.contextMenu.x+"px",zIndex:9999}),onMousedown:t[4]||(t[4]=(0,n.iM)((()=>{}),["stop"]))},[(0,i._)("div",{class:"menu-item",onClick:t[2]||(t[2]=(...e)=>l.renameFolder&&l.renameFolder(...e))},"Premenovať"),(0,i._)("div",{class:"menu-item",onClick:t[3]||(t[3]=(...e)=>l.deleteFolder&&l.deleteFolder(...e))},"Vymazať")],36)):(0,i.kq)("",!0)]))])}var J=o(1076),G={name:"FolderList",props:{folders:{type:Array,required:!0},selected:{type:String,required:!0},authors:Array,selectedAuthor:String,creatingNewFolder:Boolean},emits:["select","context","select-author","confirm-new-folder","cancel-new-folder","rename-folder","delete-folder","confirm-rename-folder","cancel-rename-folder","close-global-context"],data(){return{newFolderName:"",isSaving:!1,showAllFolders:!1,contextMenu:{visible:!1,x:0,y:0,folder:null},renamingFolder:null,originalFolderName:"",hoverTimeout:null}},methods:{normalizeStringArray(e){let t=e;if("string"===typeof e)try{t=JSON.parse(e)}catch{const t=e.split(",").map((e=>e.trim())).filter(Boolean);return t.length?t.map(String):[]}if(Array.isArray(t))return t.map(String);if(t&&"object"===typeof t){const e=Object.keys(t).sort(((e,t)=>Number(e)-Number(t)));return e.map((e=>String(t[e])))}return[]},onMouseEnter(){this.hoverTimeout&&(clearTimeout(this.hoverTimeout),this.hoverTimeout=null),this.showAllFolders=!0},onMouseLeave(){this.hoverTimeout=setTimeout((()=>{this.showAllFolders=!1,this.hoverTimeout=null}),150)},async confirmFolder(e,t){if(this.isSaving)return;this.isSaving=!0,t&&"keyup"===t.type&&"Enter"===t.key&&t.target.blur();const o=e.name?.trim();if(!o)return this.$emit("cancel-new-folder",e),void(this.isSaving=!1);e.name=o,this.$emit("confirm-new-folder",e,t),this.isSaving=!1},cancelNewFolder(e){this.$emit("cancel-new-folder",e)},startRenameFolder(e){this.renamingFolder=e,this.originalFolderName=e.name,this.closeContextMenu(),this.$nextTick((()=>{const e=this.$el.querySelector(".folder-rename-input");e&&e.focus()}))},async confirmRename(e,t){if(this.isSaving)return;this.isSaving=!0;const o=t.target.value.trim();if(!o)return e.name=this.originalFolderName,this.renamingFolder=null,void(this.isSaving=!1);if(o.toLowerCase()===this.originalFolderName.toLowerCase())return this.renamingFolder=null,void(this.isSaving=!1);try{const t=await J["default"].get(this.$store.state.api+"/folder/list.php");if("Request succesfull"!==t.data.status)return this.$store.state.SnackBarText="Nepodarilo sa overiť existenciu priečinka. Skús znova neskôr.",e.name=this.originalFolderName,this.renamingFolder=null,void(this.isSaving=!1);{const i=this.normalizeStringArray(t.data.data),n=i.some((e=>e.trim().toLowerCase()===o.toLowerCase()));if(n)return this.$store.state.SnackBarText="Priečinok s týmto názvom už existuje.",e.name=this.originalFolderName,this.renamingFolder=null,void(this.isSaving=!1)}}catch(i){return this.$store.state.SnackBarText="Chyba pri overovaní priečinka. Skús znova neskôr.",e.name=this.originalFolderName,this.renamingFolder=null,void(this.isSaving=!1)}e.name=o,this.renamingFolder=null,this.$emit("confirm-rename-folder",e,o),this.isSaving=!1},handleMenuEsc(e){"Escape"===e.key&&this.closeContextMenu()},openContextMenu(e,t){e.preventDefault(),this.$emit("close-global-context");let o=e.clientX,i=e.clientY;const n=190,a=110;o+n>window.innerWidth&&(o=window.innerWidth-n-8),i+a>window.innerHeight&&(i=window.innerHeight-a-8),o<0&&(o=0),i<0&&(i=0),this.contextMenu={visible:!0,x:o,y:i,folder:t},document.removeEventListener("keydown",this.handleMenuEsc),document.removeEventListener("mousedown",this.closeContextMenu),document.addEventListener("keydown",this.handleMenuEsc),document.addEventListener("mousedown",this.closeContextMenu,{once:!0})},closeContextMenu(){this.contextMenu.visible=!1,document.removeEventListener("keydown",this.handleMenuEsc)},renameFolder(){this.startRenameFolder(this.contextMenu.folder),this.closeContextMenu()},deleteFolder(){this.$emit("delete-folder",this.contextMenu.folder),this.closeContextMenu()}},computed:{orderedFolders(){return this.folders},visibleFolders(){return this.orderedFolders.slice(0,8)},paddedFolders(){let e=this.showAllFolders?this.orderedFolders:this.visibleFolders;return e.length<8?[...e,...Array(8-e.length).fill(null)]:e},showHover(){return this.orderedFolders.length>8}}};const X=(0,N.Z)(G,[["render",q],["__scopeId","data-v-191c1e76"]]);var ee=X,te={components:{FolderList:ee,ConfirmDialog:V,AddToFolderDialog:M.Z,SortArrow:D.Z},mounted(){window.scrollTo(0,0),this.loadFolders(),this.nacitajZapisy(),this.ziskajPrihlasenehoPouzivatela()},data(){return{data:[],dataVyhladavanie:[],search:"",folders:[],creatingNewFolder:!1,editingFolder:null,selectedFolder:"Všetko",authors:[],selectedAuthor:"",menoPouzivatela:"",globalContextMenu:{visible:!1,x:0,y:0},allDataRaw:[],renamingFolder:null,originalFolderName:"",showDeleteDialog:!1,folderToDelete:null,rowContextMenu:{visible:!1,x:0,y:0,item:null},showAddToFolderModal:!1,addToFolderItem:null,addToFolderFolders:[],sortKey:"",sortDirection:"",showInactiveOnly:!1,timer:null}},computed:{displayedData(){const e=e=>String(e||"").normalize("NFD").replace(/[\u0300-\u036f]/g,"").trim().toLowerCase();let t=this.data.slice();this.selectedAuthor&&(t=t.filter((t=>e(t.autor)===e(this.selectedAuthor)&&(!this.showInactiveOnly||!1===t.stav_aktivne))));const o=e(this.search);return o&&(t=t.filter((t=>e(t.nazov).includes(o)))),t},sortedData(){const e=this.displayedData;if(!this.sortKey&&!this.sortDirection)return[...e].sort(((e,t)=>Number(t.id)-Number(e.id)));const t=e=>String(e||"").normalize("NFD").replace(/[\u0300-\u036f]/g,"").trim().toLowerCase();return[...e].sort(((e,o)=>{let i,n;if("datum_vytvorenia"===this.sortKey)return i=e.timestamp?new Date(e.timestamp):new Date(0),n=o.timestamp?new Date(o.timestamp):new Date(0),"asc"===this.sortDirection?i-n:n-i;if("stav_aktivne"===this.sortKey)return i=e.stav_aktivne?1:0,n=o.stav_aktivne?1:0,"asc"===this.sortDirection?i-n:n-i;i=e[this.sortKey],n=o[this.sortKey];const a=parseFloat(String(i).replace(",",".")),s=parseFloat(String(n).replace(",","."));if(!isNaN(a)&&!isNaN(s))return"asc"===this.sortDirection?a-s:s-a;i=t(i),n=t(n);const r=i.localeCompare(n,"sk",{sensitivity:"base",numeric:!0});return"asc"===this.sortDirection?r:-r}))},noResultsMessage(){const e=this.search.trim();return e?`Nebola nájdená žiadna pieseň pre “${e}”`:this.selectedAuthor?`Autor “${this.selectedAuthor}” nemá žiadne piesne v tomto priečinku`:"V tomto priečinku nie sú žiadne záznamy"}},methods:{normalizeIds(e){let t=e;if("string"===typeof e)try{t=JSON.parse(e)}catch{const t=e.split(",").map((e=>e.trim())).filter(Boolean);return t.length?t.map(String):[]}if(Array.isArray(t))return t.map((e=>String(e)));if(t&&"object"===typeof t){const e=Object.keys(t).sort(((e,t)=>Number(e)-Number(t)));return e.map((e=>String(t[e])))}return[]},formatDatum(e){if(!e)return"—";const t=new Date(String(e).replace(" ","T"));if(isNaN(t.getTime()))return e;const o=t.getDate(),i=t.getMonth()+1,n=t.getFullYear(),a=String(t.getHours()).padStart(2,"0"),s=String(t.getMinutes()).padStart(2,"0");return`${o}. ${i}. ${n}, ${a}:${s}`},updateSort({key:e,direction:t}){this.sortKey=e,this.sortDirection=t},async onAddToFolderDone(){await this.loadFolders(),"Všetko"===this.selectedFolder?this.data=this.allDataRaw.slice():await this.selectFolder(this.selectedFolder)},async ziskajPrihlasenehoPouzivatela(){try{const e=await J["default"].get("https://heligonkovaakademia.sk/api/user/info/getAdditionalInformation.php");if("Request succesfull"===e.data.status){const t=e.data.data;this.menoPouzivatela=`${t.name} ${t.surname}`.trim()}}catch(e){}},async handleAddToFolderConfirm(e){await Promise.all(e.map((e=>{const t=e.checked?"add.php":"remove.php",o=new FormData;return o.append("id",this.addToFolderItem.id),o.append("name",e.name),J["default"].post(`${this.$store.state.api}/folder/${t}`,o)}))),await this.loadFolders(),"Všetko"!==this.selectedFolder?await this.selectFolder(this.selectedFolder):this.data=this.allDataRaw.slice(),this.showAddToFolderModal=!1,this.$store.state.SnackBarText="Hotovo"},async removeFromFolder(e){const t=this.selectedFolder;if("Všetko"===t)return this.$store.state.SnackBarText="Vyber najprv konkrétny priečinok, z ktorého chceš odstrániť pieseň.",void this.closeRowContextMenu();try{const o=new FormData;o.append("id",e.id),o.append("name",t);const i=await fetch(`${this.$store.state.api}/folder/remove.php`,{method:"POST",body:o}),{status:n,message:a}=await i.json();if("Request succesfull"!==n)throw new Error(a||"Unknown error");await this.loadFolders(),await this.selectFolder(t)}catch(o){this.$store.state.SnackBarText="Nepodarilo sa odstrániť pieseň z priečinka.",this.closeRowContextMenu()}},onSelectFolder(e){this.closeGlobalContextMenu(),this.selectFolder(e)},async selectFolder(e){if(this.selectedFolder=e,this.selectedAuthor="",this.search="","Všetko"!==e)try{const t=await J["default"].get(`${this.$store.state.api}/folder/list.php`,{params:{name:e}});if("Request succesfull"===t.data?.status){const e=this.normalizeIds(t.data.data);this.data=this.allDataRaw.filter((t=>e.includes(String(t.id))))}else this.data=[]}catch(t){this.data=[]}else this.data=this.allDataRaw.slice()},openGlobalContextMenu(e){if(e.preventDefault(),e.target.closest(".folder-item"))return;let t=e.clientX,o=e.clientY;const i=270,n=54;t+i>window.innerWidth&&(t=window.innerWidth-i-6),o+n>window.innerHeight&&(o=window.innerHeight-n-6),this.globalContextMenu={visible:!0,x:t,y:o},document.addEventListener("keydown",this.handleContextMenuEsc),setTimeout((()=>{document.addEventListener("click",this.closeGlobalContextMenu,{once:!0})}),0)},closeGlobalContextMenu(){this.globalContextMenu.visible=!1,document.removeEventListener("keydown",this.handleContextMenuEsc)},handleContextMenuEsc(e){"Escape"===e.key&&this.closeGlobalContextMenu()},addFolderInline(){this.closeGlobalContextMenu();const e=this.folders.some((e=>e.isNew));if(e)return void this.$nextTick((()=>{const e=document.querySelector('input[placeholder="Nový priečinok"]');e&&e.focus()}));const t={name:"",count:0,isNew:!0};this.folders.unshift(t),this.$nextTick((()=>{const e=document.querySelector('input[placeholder="Nový priečinok"]');e&&e.focus()}))},async finalizeNewFolder(e){const t=e.name?.trim();if(t)try{const o=new FormData;o.append("name",t),o.append("type","noty");const i=await J["default"].post(this.$store.state.api+"/folder/create.php",o),n=(i.data.status||"").toLowerCase(),a=(i.data.message||"").toLowerCase();n.includes("succes")?(this.$store.state.SnackBarText=`Priečinok "${t}" bol vytvorený.`,this.creatingNewFolder=!1,this.editingFolder=null,await this.loadFolders(),this.selectedFolder=t,this.search="",this.selectedAuthor="",this.dataVyhladavanie=[],await this.selectFolder(t)):a.includes("existuje")||a.includes("already exists")?(this.$store.state.SnackBarText="Priečinok s týmto názvom už existuje.",this.cancelNewFolder(e)):(this.$store.state.SnackBarText="Nepodarilo sa vytvoriť priečinok: "+(i.data.message||"Neznáma chyba."),this.cancelNewFolder(e))}catch(o){this.$store.state.SnackBarText="Chyba pri vytváraní priečinka. Skús neskôr.",this.cancelNewFolder(e)}else this.cancelNewFolder(e)},cancelNewFolder(e){this.folders=this.folders.filter((t=>t!==e)),this.creatingNewFolder=!1,this.editingFolder=null},async loadFolders(){try{const e=await J["default"].get(this.$store.state.api+"/noty/list.php"),t=Array.isArray(e.data?.data)?e.data.data:[],o=t.length,i=await J["default"].get(this.$store.state.api+"/folder/list.php"),n=Array.isArray(i.data?.data)?i.data.data:[],a=n.map((async e=>{const t=await J["default"].get(this.$store.state.api+`/folder/list.php?name=${encodeURIComponent(e)}`),o=this.normalizeIds(t.data?.data);return{name:e,count:o.length}})),s=await Promise.all(a);this.folders=[{name:"Všetko",count:o},...s]}catch(e){this.folders=[{name:"Všetko",count:0}]}},async nacitajZapisy(){try{const e=await J["default"].get(this.$store.state.api+"/noty/list.php");if("Request succesfull"===e.data.status){const t=e.data.data;this.allDataRaw=t;const o={};t.forEach((e=>{const t=(e.autor||"").trim();o[t]||(o[t]={name:t,total:0,inactive:0}),o[t].total++,!1===e.stav_aktivne&&o[t].inactive++})),this.authors=Object.values(o),this.data=t,this.selectedAuthor=""}else this.data=[],this.authors=[]}catch(e){this.data=[],this.authors=[]}},upravenieZapisu(e){this.$router.push({path:"/admin/vytvorenie-zapisu",query:{id:e}})},vymazanieZapisu(e){const t=confirm("Ste si istý, že chcete vymazať tento zápis? \nPo vymazaní bude navždy stratený.");if(!t)return void(this.$store.state.SnackBarText="Vymazanie zápisu bolo zrušené");const i=o(6237);let n=new i,a={method:"get",maxBodyLength:1/0,url:this.$store.state.api+"/noty/delete.php?id="+e,data:n};J["default"].request(a).then((e=>{"Request fullfiled"==e.data.status?(this.$store.state.SnackBarText="Vymazanie zápisu bolo úspešné",setTimeout((()=>{this.data=[],this.nacitajZapisy()}),200)):this.$store.state.SnackBarText="Nepodarilo sa vymazať zápis"})).catch((e=>{}))},vyhladavanieZapisu(){const e=e=>e?.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").trim(),t=e(this.search);if(!t)return void this.applyFolderAndAuthorFilter();const o=this.getFolderAndAuthorFilteredData();this.dataVyhladavanie=o.filter((o=>e(o.nazov).includes(t)))},getFolderAndAuthorFilteredData(){let e=this.allDataRaw.slice();return"Všetko"!==this.selectedFolder&&(e=this.data.slice()),this.selectedAuthor&&(e=e.filter((e=>(e.autor||"").trim()===this.selectedAuthor))),e},applyFolderAndAuthorFilter(){const e=this.getFolderAndAuthorFilteredData();this.dataVyhladavanie=e},oneskoreneVyhladavanie(){clearTimeout(this.timer),this.timer=setTimeout((()=>{this.vyhladavanieZapisu()}),500)},selectAuthor({name:e,inactiveOnly:t}){this.selectedAuthor===e&&this.showInactiveOnly===t?(this.selectedAuthor="",this.showInactiveOnly=!1):(this.selectedAuthor=e,this.showInactiveOnly=t)},startRenameFolder(e){this.renamingFolder=e,this.originalFolderName=e.name,this.closeContextMenu(),this.$nextTick((()=>{const e=this.$el.querySelector(".folder-rename-input");e&&e.focus()}))},confirmRename(e,t){const o=t.target.value.trim();e.name=o||this.originalFolderName,this.renamingFolder=null},cancelRename(e){e.name=this.originalFolderName,this.renamingFolder=null},deleteFolder(e){e&&"Všetko"!==e.name&&(this.folderToDelete=e,this.showDeleteDialog=!0)},async confirmDeleteFolder(){const e=this.folderToDelete;if(this.showDeleteDialog=!1,e)try{const t=new FormData;t.append("name",e.name);const o=await J["default"].post(this.$store.state.api+"/folder/delete.php",t),i=(o.data.status||"").toLowerCase();i.includes("succes")?(this.$store.state.SnackBarText=`Priečinok "${e.name}" bol vymazaný.`,await this.loadFolders(),this.selectedFolder===e.name&&this.selectFolder("Všetko")):this.$store.state.SnackBarText="Nepodarilo sa vymazať priečinok: "+(o.data.message||"Neznáma chyba.")}catch(t){this.$store.state.SnackBarText="Chyba pri vymazávaní priečinka."}finally{this.folderToDelete=null}},openRowContextMenu(e,t){e.preventDefault();let o=e.clientX,i=e.clientY;const n=210,a=54;o+n>window.innerWidth&&(o=window.innerWidth-n-6),i+a>window.innerHeight&&(i=window.innerHeight-a-6),this.rowContextMenu={visible:!0,x:o,y:i,item:t},document.addEventListener("keydown",this.handleRowMenuEsc),setTimeout((()=>{document.addEventListener("click",this.closeRowContextMenu,{once:!0})}),0)},closeRowContextMenu(){this.rowContextMenu.visible=!1,document.removeEventListener("keydown",this.handleRowMenuEsc)},handleRowMenuEsc(e){"Escape"===e.key&&this.closeRowContextMenu()},async addToFolder(e){this.closeRowContextMenu();const t=this.folders.filter((e=>"Všetko"!==e.name)),o=await Promise.all(t.map((async t=>{const o=await J["default"].get(`${this.$store.state.api}/folder/list.php`,{params:{name:t.name}}),i=this.normalizeIds(o.data?.data);return{name:t.name,checked:i.includes(String(e.id))}})));this.addToFolderItem=e,this.addToFolderFolders=o,this.showAddToFolderModal=!0}},watch:{folders:{handler(e){this.localFolders=e.map((e=>({...e,checked:!!e.checked})))},immediate:!0,deep:!0}}};const oe=(0,N.Z)(te,[["render",x],["__scopeId","data-v-544a0503"]]);var ie=oe},3139:function(e,t,o){e.exports=o.p+"img/hladanie.697b6243.svg"},5575:function(e){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABoAAAAaCAMAAACelLz8AAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAJcEhZcwAACxMAAAsTAQCanBgAAACQUExURUdwTMJXHcdYIL9YIMNYIMNYHMJYHcJXHb9QIMFXHMNWHMFWHsFWHMFXHsJXHs9QIMJXHcFYHMVaIMFXHsVVIMNWHsJYHcFXHcJXHsFYHsJXHb9aIMFYHcFXHvJtJMJXHchaHuxqI+xrI8VZHtpiIdpiINdhIO9sI8VYHdRfIOZoIuNnIuNmIuZoI9RgIO9sJIbZAl4AAAAedFJOUwCPICBAQL+/EJDPz8/PjxDvgDCQMH/f3++A3zDf744ZZckAAADiSURBVBgZbcEHloJAFEXBpwINhjFMTv92N4rZ2f/uRj0mlCqdJa/uHUauNVFd4rhwia6GT1BW62gWV0sPrVwn7S7lbG5nM+i3dTTs4oPdCJ5+roMnfLCa4GlpL4Vgd0JJIskxtQcznPSCt0d/JYmeWVqDik85ttZgjdMHwRoEvgTWCATWCPRGsAaBkRwba7Ai05jKGuwolLKY2yPPt+SY2oMZmaSURbQ7ERLtFfhoNdFT6CAf4KPdiJ5erqPOAKZ2Np+W9Do6yQvwu200i5uqhCLXVZpxkaWqmxTZL/xk41Qn//CgPsKsDi39AAAAAElFTkSuQmCC"},3073:function(e){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACcAAAAnCAMAAAC7faEHAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAJcEhZcwAAEJwAABCcASbNOjQAAACKUExURUdwTHCfQHSjQHOhQHCfQHOjQICvQHOiQHinQHSjQHOjQHSkQHOjQHSjQHWiQHCfQHKiQHWlQHOjQHKhQHOiQJDKUHOiQIzFTnWkQX6xRoG2SI3FTnqsRIrCTYO5SYK2SInATHyuRXWlQXusRIe9S4vDTYvCTYS5SYO4SY/IT3yvRY7IT47HT4e+SxNkcpEAAAAVdFJOUwAQv5AgUBDfIEC/j5DPYDCPMK+wr6IKWSkAAAFQSURBVDjLrdTZdptAEIThYm2EFjt2+h9AshZb8Zbk/V8vF8jHxojlInX9ne6BOVPS1+Sb5doAK5dZoaEsSr7mLpujAOxHT+W3AOwO5+Du4dg8AbDMu6wwoDr89s+EGsCKHjsF7ybU32BhUL14P/sOzA2qB7+Whwrs44y3wHXWwmXLboAXH8oeWEiSDGofzglKScqAMOJC1Q68Gx/nfoBSKibGuf8BcmWw8/E8wUYJNBPuACvFcJxwZ1jLpo7nHsAE+FSA/+7mnm8N5wl3hHLO/2tgpc2s+8gUAW+jbAukUjy1uIZ7SQt43E6MyyQphvfxcdYWBrAfZK/ApT4SePw1wJ6B1eVdRjYInyuw6OOhpzaw+rUCSz+LIzWg/v7V2xNddoFd+dZUPSZFSdt/zTG4e/jb7ABYRb2mvLFen8aLq82b/ZyjJCnNktgAWyeb7sZ/6i1kz6f1KPoAAAAASUVORK5CYII="}}]);