"use strict";(self["webpackChunkheligonkova_akademia"]=self["webpackChunkheligonkova_akademia"]||[]).push([[6429],{9970:function(t,a,i){i.r(a),i.d(a,{default:function(){return nt}});var s=i(3396);const e=["id"],o={class:"scroll",ref:"scrollContainer"},n=["id"],l={class:"scroll",ref:"scrollContainerMobile"};function d(t,a,i,d,r,h){const c=(0,s.up)("HelibodyHeader"),u=(0,s.up)("HelibodyLeaderboard"),p=(0,s.up)("HelibodyLeaderboardMobile"),m=(0,s.up)("ModalSkeleton");return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s._)("section",{class:"computer zapisy",id:t.$route.name},[(0,s._)("div",o,[(0,s.Wm)(c),(0,s.Wm)(u,{items:r.starsList,disableFetch:!0,totalAchievementsProp:0,limit:30},null,8,["items"])],512)],8,e),(0,s._)("div",{id:`${t.$route.name}-m`,class:"mobile"},[(0,s._)("section",null,[(0,s._)("div",l,[(0,s.Wm)(c),(0,s.Wm)(p)],512)])],8,n),r.modalOpen?((0,s.wg)(),(0,s.j4)(m,{key:0,"content-component":r.modalComponent,"content-props":r.modalProps,onClose:a[0]||(a[0]=t=>r.modalOpen=!1)},null,8,["content-component","content-props"])):(0,s.kq)("",!0)],64)}const r={class:"header"};function h(t,a){return(0,s.wg)(),(0,s.iD)("div",r,a[0]||(a[0]=[(0,s._)("h1",null,"Hraj, uč sa a vyhraj!",-1),(0,s._)("h5",null,"Zbieraj hviezdičky, získavaj body a vyhraj super ceny!",-1),(0,s._)("div",{class:"line horizontal"},null,-1)]))}var c=i(89);const u={},p=(0,c.Z)(u,[["render",h],["__scopeId","data-v-ef55374e"]]);var m=p,v=i(7139),y=i(4281),f=i(4436);const k={class:"leaderboard-wrapper helibody"},b={class:"top-players"},w={class:"table-wrapper"},g={key:0,class:"player-table"},z={class:"player-info"},_={class:"rank"},A=["src"],j={class:"name"},S={class:"stars-cell"},H={class:"tasks-cell"},P={class:"points-cell"},C={class:"body"};function $(t,a,i,e,o,n){const l=(0,s.up)("LeaderboardPlayerCard"),d=(0,s.up)("TimeCubes"),r=(0,s.up)("StarRating"),h=(0,s.up)("TaskCount");return(0,s.wg)(),(0,s.iD)("div",k,[a[1]||(a[1]=(0,s._)("p",{class:"title"}," V Heligónkovej Akadémii nezbierame známky, ale hviezdičky za snahu, pokrok a chuť hrať. Za každú lekciu môžeš získať 1 až 5 hviezdičiek, podľa toho, ako si pripravený. Každá hviezdička sa premení na body, ktoré sa ti automaticky započítajú do rebríčka. ",-1)),a[2]||(a[2]=(0,s._)("h2",{class:"podnadpis"}," Na konci školského roka čakajú na najlepších z vás odmeny! ",-1)),(0,s._)("div",b,[o.top3[1]?((0,s.wg)(),(0,s.j4)(l,{key:0,poradie:2,avatar:o.top3[1].avatar,meno:o.top3[1].meno,stars:o.top3[1].stars,heliBody:!0,body:o.top3[1].points},null,8,["avatar","meno","stars","body"])):(0,s.kq)("",!0),o.top3[0]?((0,s.wg)(),(0,s.j4)(l,{key:1,poradie:1,avatar:o.top3[0].avatar,meno:o.top3[0].meno,stars:o.top3[0].stars,heliBody:!0,body:o.top3[0].points},null,8,["avatar","meno","stars","body"])):(0,s.kq)("",!0),o.top3[2]?((0,s.wg)(),(0,s.j4)(l,{key:2,poradie:3,avatar:o.top3[2].avatar,meno:o.top3[2].meno,stars:o.top3[2].stars,heliBody:!0,body:o.top3[2].points},null,8,["avatar","meno","stars","body"])):(0,s.kq)("",!0)]),(0,s._)("div",w,[o.rows.length?((0,s.wg)(),(0,s.iD)("table",g,[a[0]||(a[0]=(0,s._)("thead",null,[(0,s._)("tr",null,[(0,s._)("th",null,"Názov účtu:"),(0,s._)("th",null,"Čas výučby:"),(0,s._)("th",null,"Počet hviezd:"),(0,s._)("th",null,"Úlohy:"),(0,s._)("th",null,"Body:")])],-1)),(0,s._)("tbody",null,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(o.rows,((t,a)=>((0,s.wg)(),(0,s.iD)("tr",{key:a},[(0,s._)("td",null,[(0,s._)("div",z,[(0,s._)("span",_,(0,v.zw)(a+4)+".",1),(0,s._)("img",{src:t.avatar,alt:"Avatar",class:"avatar"},null,8,A),(0,s._)("span",j,(0,v.zw)(t.meno),1)])]),(0,s._)("td",null,[(0,s.Wm)(d,{dni:t.dni,hodiny:t.hodiny,minuty:t.minuty},null,8,["dni","hodiny","minuty"])]),(0,s._)("td",S,[(0,s.Wm)(r,{stars:t.stars,dni:t.dni,hodiny:t.hodiny},null,8,["stars","dni","hodiny"])]),(0,s._)("td",H,[(0,s.Wm)(h,{count:t.ulohy},null,8,["count"])]),(0,s._)("td",P,[(0,s._)("p",C,(0,v.zw)(t.points??0),1)])])))),128))])])):(0,s.kq)("",!0)]),a[3]||(a[3]=(0,s.uE)('<div class="line horizontal" data-v-5f467620></div><div class="how-it-works helibody-info" data-v-5f467620><div class="hiw-head" data-v-5f467620><h3 class="hiw-title" data-v-5f467620>Ako získavaš body?</h3></div><div class="hiw-row" data-v-5f467620><div class="hiw-left" data-v-5f467620><img class="hiw-icon" src="'+y+'" alt="Hviezdička" data-v-5f467620><div class="hiw-left-text" data-v-5f467620><div class="hiw-left-title" data-v-5f467620>Hviezdičky za lekcie:</div><div class="hiw-left-sub" data-v-5f467620>Jedna hviezdička = 1bod</div></div></div><div class="hiw-right" data-v-5f467620><p data-v-5f467620>Po každej hodine ti učiteľ udelí 1 až 5 hviezdičiek</p><p data-v-5f467620>Zohľadňuje sa: <b data-v-5f467620>pripravenosť, pokrok, aktivita a prístup</b></p></div></div><div class="hiw-row" data-v-5f467620><div class="hiw-left" data-v-5f467620><img class="hiw-icon" src="'+f+'" alt="Kalendár" data-v-5f467620><div class="hiw-left-text" data-v-5f467620><div class="hiw-left-title" data-v-5f467620>Body za dochádzku:</div><div class="hiw-left-sub" data-v-5f467620>100% dochádzka = 2body</div></div></div><div class="hiw-right" data-v-5f467620><p data-v-5f467620>Ak v danom mesiaci prídeš na všetky naplánované hodiny</p><p data-v-5f467620>získaš extra body navyše ako odmenu za zodpovednosť</p></div></div></div>',2))])}i(8858),i(1318),i(3228),i(560);var T=i(1076),W=i(492),M=i(2108),L=i(9624),N=i(3973),Z={props:{limit:{type:Number,default:50},items:{type:Array,default:null},disableFetch:{type:Boolean,default:!1},totalAchievementsProp:{type:Number,default:null}},name:"HelibodyLeaderboard",components:{LeaderboardPlayerCard:W.Z,TimeCubes:M.Z,StarRating:L.Z,TaskCount:N.Z},data(){return{top3:[],rows:[],totalAchievements:0}},mounted(){if(Array.isArray(this.items)&&this.items.length)return this.useProvidedItems(this.items),void("number"===typeof this.totalAchievementsProp&&(this.totalAchievements=this.totalAchievementsProp));this.disableFetch||this.loadTotals().then((()=>this.loadTable()))},watch:{items:{immediate:!1,deep:!0,handler(t){Array.isArray(t)&&t.length?this.useProvidedItems(t):this.disableFetch?(this.top3=[],this.rows=[]):this.loadTotals().then((()=>this.loadTable()))}},totalAchievementsProp(t){"number"===typeof t&&(this.totalAchievements=t)}},methods:{stripWWW(t){if(!t)return null;try{const a=new URL(t);return a.hostname.startsWith("www.")&&(a.hostname=a.hostname.slice(4)),a.toString()}catch{return t.replace(/^https?:\/\/www\./,(t=>t.replace("www.","")))}},async loadTable(){if(!(Array.isArray(this.items)&&this.items.length||this.disableFetch))try{const t=await T["default"].get("https://heligonkovaakademia.sk/api/achievements/getTabulka.php",{params:{limit:this.limit}});if("Request succesfull"===t.data.status){const a=Object.values(t.data.data||{}).sort(((t,a)=>t.rank-a.rank)),i=a.map((t=>{const{dni:a,hodiny:i,minuty:s}=this.splitMinutes(+t.helitime),e=`${(t.name||"").trim()} ${(t.surname||"").trim()}`.trim();return{meno:e,avatar:t.profilePhotoUrl?this.stripWWW(t.profilePhotoUrl):null,dni:a,hodiny:i,minuty:s,stars:this.computeStars(a,i),ulohy:t.finishedAchievements||0,points:Number(t.points??t.body??0)}}));this.top3=i.slice(0,3),this.rows=i.slice(3)}}catch(t){}},async loadTotals(){if(Array.isArray(this.items)&&this.items.length||this.disableFetch)"number"===typeof this.totalAchievementsProp&&(this.totalAchievements=this.totalAchievementsProp);else try{const t=await T["default"].get("https://heligonkovaakademia.sk/api/achievements/getAchievementsStats.php");"Request succesfull"===t.data.status&&(this.totalAchievements=+(t.data.totalAchievements??t.data.data?.total??t.data.data?.totalAchievements??0)||0)}catch(t){}},splitMinutes(t){const a=Math.floor(t/1440),i=t%1440,s=Math.floor(i/60),e=i%60;return{dni:a,hodiny:s,minuty:e}},computeStars(t,a){const i=24*t+a;return i<8?0:i<24?1:1===t?2:t>=2&&t<5?3:t>=5&&t<10?4:5},formatCas({dni:t,hodiny:a,minuty:i}){const s=[];return 1===t?s.push("1 deň"):t>=2&&t<=4?s.push(`${t} dni`):t>=5&&s.push(`${t} dní`),1===a?s.push("1 hodina"):a>=2&&a<=4?s.push(`${a} hodiny`):a>=5&&s.push(`${a} hodín`),1===i?s.push("1 minúta"):i>=2&&i<=4?s.push(`${i} minúty`):i>=5&&s.push(`${i} minút`),s.join(" ")},useProvidedItems(t){try{const a=Array.isArray(t)?t:[],i=a.map((t=>{const a=Number(t.helitime||0),{dni:i,hodiny:s,minuty:e}=this.splitMinutes(a),o=`${(t.name||"").trim()} ${(t.surname||"").trim()}`.trim();return{meno:o,avatar:t.profilePhotoUrl?this.stripWWW(t.profilePhotoUrl):null,dni:i,hodiny:s,minuty:e,stars:this.computeStars(i,s),ulohy:0,points:Number(t.stars??0)}}));this.top3=i.slice(0,3),this.rows=i.slice(3)}catch(a){this.top3=[],this.rows=[]}}}};const x=(0,c.Z)(Z,[["render",$],["__scopeId","data-v-5f467620"]]);var I=x;const q={class:"leaderboard-wrapper helibody"},D={class:"top-players"},F={class:"table-wrapper"},B={key:0,class:"player-table"},E={class:"player-info"},R={class:"rank"},U=["src"],K={class:"name"},O={class:"info-column"},Y={class:"right"},J={class:"right"},V={class:"right"},G={class:"right"},Q={class:"body"};function X(t,a,i,e,o,n){const l=(0,s.up)("LeaderboardPlayerCard"),d=(0,s.up)("TimeCubes"),r=(0,s.up)("StarRating"),h=(0,s.up)("TaskCount");return(0,s.wg)(),(0,s.iD)("div",q,[a[1]||(a[1]=(0,s._)("p",{class:"title"}," V Heligónkovej Akadémii nezbierame známky, ale hviezdičky za snahu, pokrok a chuť hrať. Za každú lekciu môžeš získať 1 až 5 hviezdičiek, podľa toho, ako si pripravený. Každá hviezdička sa premení na body, ktoré sa ti automaticky započítajú do rebríčka. ",-1)),a[2]||(a[2]=(0,s._)("h2",{class:"podnadpis"}," Na konci školského roka čakajú na najlepších z vás odmeny! ",-1)),(0,s._)("div",D,[o.top3[1]?((0,s.wg)(),(0,s.j4)(l,{key:0,poradie:2,avatar:o.top3[1].avatar,meno:o.top3[1].meno,stars:o.top3[1].stars,heliBody:!0,body:o.top3[1].body},null,8,["avatar","meno","stars","body"])):(0,s.kq)("",!0),o.top3[0]?((0,s.wg)(),(0,s.j4)(l,{key:1,poradie:1,avatar:o.top3[0].avatar,meno:o.top3[0].meno,stars:o.top3[0].stars,heliBody:!0,body:o.top3[0].body},null,8,["avatar","meno","stars","body"])):(0,s.kq)("",!0),o.top3[2]?((0,s.wg)(),(0,s.j4)(l,{key:2,poradie:3,avatar:o.top3[2].avatar,meno:o.top3[2].meno,stars:o.top3[2].stars,heliBody:!0,body:o.top3[2].body},null,8,["avatar","meno","stars","body"])):(0,s.kq)("",!0)]),(0,s._)("div",F,[o.ostatni.length?((0,s.wg)(),(0,s.iD)("table",B,[a[0]||(a[0]=(0,s._)("thead",null,[(0,s._)("tr",null,[(0,s._)("th",null,"Hráč"),(0,s._)("th",null,"Informácie")])],-1)),(0,s._)("tbody",null,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(o.ostatni,((t,a)=>((0,s.wg)(),(0,s.iD)("tr",{key:a},[(0,s._)("td",null,[(0,s._)("div",E,[(0,s._)("span",R,(0,v.zw)(a+4)+".",1),(0,s._)("img",{src:t.avatar,alt:"Avatar",class:"avatar",loading:"lazy"},null,8,U),(0,s._)("span",K,(0,v.zw)(t.meno),1)])]),(0,s._)("td",O,[(0,s._)("div",Y,[(0,s.Wm)(d,{dni:t.dni,hodiny:t.hodiny,minuty:t.minuty},null,8,["dni","hodiny","minuty"])]),(0,s._)("div",J,[(0,s.Wm)(r,{stars:t.stars,dni:t.dni,hodiny:t.hodiny},null,8,["stars","dni","hodiny"])]),(0,s._)("div",V,[(0,s.Wm)(h,{count:t.ulohy},null,8,["count"])]),(0,s._)("div",G,[(0,s._)("p",Q,(0,v.zw)(t.body??0),1)])])])))),128))])])):(0,s.kq)("",!0)]),a[3]||(a[3]=(0,s.uE)('<div class="line horizontal" data-v-f8166572></div><div class="how-it-works helibody-info" data-v-f8166572><div class="hiw-head" data-v-f8166572><h3 class="hiw-title" data-v-f8166572>Ako získavaš body?</h3></div><div class="hiw-row" data-v-f8166572><div class="hiw-left" data-v-f8166572><img class="hiw-icon" src="'+y+'" alt="Hviezdička" data-v-f8166572><div class="hiw-left-text" data-v-f8166572><div class="hiw-left-title" data-v-f8166572>Hviezdičky za lekcie:</div><div class="hiw-left-sub" data-v-f8166572>Jedna hviezdička = 1bod</div></div></div><div class="hiw-right" data-v-f8166572><p data-v-f8166572>Po každej hodine ti učiteľ udelí 1 až 5 hviezdičiek</p><p data-v-f8166572>Zohľadňuje sa: <b data-v-f8166572>pripravenosť, pokrok, aktivita a prístup</b></p></div></div><div class="hiw-row" data-v-f8166572><div class="hiw-left" data-v-f8166572><img class="hiw-icon" src="'+f+'" alt="Kalendár" data-v-f8166572><div class="hiw-left-text" data-v-f8166572><div class="hiw-left-title" data-v-f8166572>Body za dochádzku:</div><div class="hiw-left-sub" data-v-f8166572>100% dochádzka = 2body</div></div></div><div class="hiw-right" data-v-f8166572><p data-v-f8166572>Ak v danom mesiaci prídeš na všetky naplánované hodiny</p><p data-v-f8166572>získaš extra body navyše ako odmenu za zodpovednosť</p></div></div></div>',2))])}i(3429);var tt={name:"HelibodyLeaderboardMobile",components:{LeaderboardPlayerCard:W.Z,TimeCubes:M.Z,StarRating:L.Z,TaskCount:N.Z},data(){return{top3:[],ostatni:[],totalAchievements:0}},mounted(){this.nacitajTotalAchievements().then((()=>this.nacitajData()))},methods:{stripWWW(t){if(!t)return null;try{const a=new URL(t);return a.hostname.startsWith("www.")&&(a.hostname=a.hostname.slice(4)),a.toString()}catch{return t.replace(/^https?:\/\/www\./,(t=>t.replace("www.","")))}},initialsFromName(t){const a=t.trim().split(/\s+/);return 0===a.length?"":1===a.length?a[0].slice(0,2).toUpperCase():(a[0][0]+a[1][0]).toUpperCase()},makeInitialsAvatar(t){const a=`<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32"><rect width="100%" height="100%" fill="#ddd"/><text x="50%" y="50%" dominant-baseline="middle" text-anchor="middle" font-family="Bahnschrift, Arial, sans-serif" font-size="14" fill="#555">${t}</text></svg>`,i="undefined"!==typeof btoa?btoa(a):window.btoa(a);return`data:image/svg+xml;base64,${i}`},async nacitajData(){try{const t=await T["default"].get("https://heligonkovaakademia.sk/api/achievements/getTabulka.php");if("Request succesfull"===t.data.status){const a=Object.values(t.data.data||{});a.sort(((t,a)=>t.rank-a.rank));const i=a.map((t=>{const{dni:a,hodiny:i,minuty:s}=this.rozdelitMinuty(+t.helitime||0),e=`${(t.name||"").trim()} ${(t.surname||"").trim()}`.trim(),o=t.profilePhotoUrl?this.stripWWW(t.profilePhotoUrl):this.makeInitialsAvatar(this.initialsFromName(e));return{meno:e,avatar:o,dni:a,hodiny:i,minuty:s,stars:this.vypocitajHviezdy(a,i),ulohy:Math.max((this.totalAchievements||0)-(Number(t.finishedAchievements)||0),0),body:Number(t.points??t.body??0)}}));this.top3=i.slice(0,3),this.ostatni=i.slice(3)}}catch{this.top3=[],this.ostatni=[]}},async nacitajTotalAchievements(){try{const t=await T["default"].get("https://heligonkovaakademia.sk/api/achievements/getAchievementsStats.php");"Request succesfull"===t.data.status&&(this.totalAchievements=+(t.data.totalAchievements??t.data.data?.total??t.data.data?.totalAchievements??0)||0)}catch{this.totalAchievements=0}},rozdelitMinuty(t){const a=Math.floor(t/1440),i=t%1440,s=Math.floor(i/60),e=i%60;return{dni:a,hodiny:s,minuty:e}},vypocitajHviezdy(t,a){const i=24*t+a;return i<8?0:i<24?1:1===t?2:t>=2&&t<5?3:t>=5&&t<10?4:5},formatCas({dni:t,hodiny:a,minuty:i}){const s=[];return 1===t?s.push("1 deň"):t>=2&&t<=4?s.push(`${t} dni`):t>=5&&s.push(`${t} dní`),1===a?s.push("1 hodina"):a>=2&&a<=4?s.push(`${a} hodiny`):a>=5&&s.push(`${a} hodín`),1===i?s.push("1 minúta"):i>=2&&i<=4?s.push(`${i} minúty`):i>=5&&s.push(`${i} minút`),s.join(" ")}}};const at=(0,c.Z)(tt,[["render",X],["__scopeId","data-v-f8166572"]]);var it=at,st=i(4015),et={components:{HelibodyHeader:m,HelibodyLeaderboard:I,HelibodyLeaderboardMobile:it,ModalSkeleton:st.Z},data(){return{starsList:[],loading:!1,loadError:null,mojaPozicia:0,mojCas:{dni:0,hodiny:0,minuty:0},isHidden:!1,isFullyHidden:!1,hasScrolledPast:!1,scrollThreshold:300,showThreshold:10,modalOpen:!1,modalComponent:null,modalProps:{}}},computed:{apiBase(){return this.$store?.state?.api||""},userId(){return this.$store?.state?.user?.id||""},meEntry(){return this.userId&&Array.isArray(this.starsList)&&this.starsList.find((t=>String(t.id)===String(this.userId)))||null}},mounted(){window.scrollTo(0,0),this.fetchStars(),this.$nextTick((()=>{const t=this.$refs.scrollContainer;t&&t.addEventListener("scroll",this.handleScroll);const a=this.$refs.scrollContainerMobile;a&&a.addEventListener("scroll",this.handleScroll)}))},beforeUnmount(){const t=this.$refs.scrollContainer;t&&t.removeEventListener("scroll",this.handleScroll);const a=this.$refs.scrollContainerMobile;a&&a.removeEventListener("scroll",this.handleScroll)},methods:{async fetchStars(){this.loading=!0,this.loadError=null;try{const t=`${this.apiBase}/edupage/listStars.php`,{data:a}=await T["default"].get(t);"Request succesfull"===a?.status&&Array.isArray(a?.data)?(this.starsList=(a.data||[]).map((t=>({...t,calculatedStars:this.calculateStarsFromHelitime(this.asNum(t.helitime,0))}))),this.computeMyStats()):this.loadError="Neočakávaná štruktúra odpovede."}catch(t){this.loadError=t?.message||String(t)}finally{this.loading=!1}},computeMyStats(){const t=this.meEntry;if(!t)return this.mojaPozicia="neumiestnený",void(this.mojCas={dni:0,hodiny:0,minuty:0});const a=this.starsList.findIndex((t=>String(t.id)===String(this.userId)));this.mojaPozicia=a>=0?a+1:"neumiestnený";const i=this.asNum(t.helitime,0);this.mojCas=this.minutesToDHM(i)},asNum(t,a=0){if(null===t||void 0===t||""===t)return a;const i=Number(t);return Number.isFinite(i)?i:a},minutesToDHM(t){const a=Math.floor(t/1440),i=t%1440,s=Math.floor(i/60),e=i%60;return{dni:a,hodiny:s,minuty:e}},calculateStarsFromHelitime(t){return t>=14400?5:t>=7200?4:t>=2880?3:t>=1440?2:t>=480?1:0},handleScroll(t){const a=t.target.scrollTop||0;a>this.scrollThreshold&&!this.hasScrolledPast?(this.isHidden=!0,this.hasScrolledPast=!0,setTimeout((()=>{this.isHidden&&(this.isFullyHidden=!0)}),100)):a<this.showThreshold&&this.hasScrolledPast&&(this.isHidden=!1,this.hasScrolledPast=!1,this.isFullyHidden=!1)},openModal({component:t,props:a}){this.modalComponent=t,this.modalProps=a||{},this.modalOpen=!0}}};const ot=(0,c.Z)(et,[["render",d],["__scopeId","data-v-747674d0"]]);var nt=ot},4436:function(t,a,i){t.exports=i.p+"img/calendar_body.ea826b01.svg"},4281:function(t,a,i){t.exports=i.p+"img/star.a719e940.svg"}}]);